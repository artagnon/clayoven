#!/usr/bin/env ruby

$:.unshift File.join(__dir__, *%w[.. lib])

# The main module, which requires everything else, and starts up clayoven
module Clayoven
  require 'clayoven/init'
  require 'clayoven/httpd'
  require 'clayoven/toplevel'

  case ARGV[0]
  when 'httpd'
    Httpd.start
  when 'aggressive'
    Toplevel.main(is_aggressive: true)
  when 'init'
    destdir = ARGV.length > 1 ? ARGV[1] : '.'
    Init.init destdir
  else
    Toplevel.main
  end
end
