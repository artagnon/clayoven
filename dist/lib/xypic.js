!function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=11)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isObject=MathJax._.components.global.isObject,t.combineConfig=MathJax._.components.global.combineConfig,t.combineDefaults=MathJax._.components.global.combineDefaults,t.combineWithMathJax=MathJax._.components.global.combineWithMathJax,t.MathJax=MathJax._.components.global.MathJax},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=MathJax._.input.tex.TexError.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TEXCLASS=MathJax._.core.MmlTree.MmlNode.TEXCLASS,t.TEXCLASSNAMES=MathJax._.core.MmlTree.MmlNode.TEXCLASSNAMES,t.indentAttributes=MathJax._.core.MmlTree.MmlNode.indentAttributes,t.AbstractMmlNode=MathJax._.core.MmlTree.MmlNode.AbstractMmlNode,t.AbstractMmlTokenNode=MathJax._.core.MmlTree.MmlNode.AbstractMmlTokenNode,t.AbstractMmlLayoutNode=MathJax._.core.MmlTree.MmlNode.AbstractMmlLayoutNode,t.AbstractMmlBaseNode=MathJax._.core.MmlTree.MmlNode.AbstractMmlBaseNode,t.AbstractMmlEmptyNode=MathJax._.core.MmlTree.MmlNode.AbstractMmlEmptyNode,t.TextNode=MathJax._.core.MmlTree.MmlNode.TextNode,t.XMLNode=MathJax._.core.MmlTree.MmlNode.XMLNode},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractSymbolMap=MathJax._.input.tex.SymbolMap.AbstractSymbolMap,t.RegExpMap=MathJax._.input.tex.SymbolMap.RegExpMap,t.AbstractParseMap=MathJax._.input.tex.SymbolMap.AbstractParseMap,t.CharacterMap=MathJax._.input.tex.SymbolMap.CharacterMap,t.DelimiterMap=MathJax._.input.tex.SymbolMap.DelimiterMap,t.MacroMap=MathJax._.input.tex.SymbolMap.MacroMap,t.CommandMap=MathJax._.input.tex.SymbolMap.CommandMap,t.EnvironmentMap=MathJax._.input.tex.SymbolMap.EnvironmentMap},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.protoItem=MathJax._.core.MathItem.protoItem,t.AbstractMathItem=MathJax._.core.MathItem.AbstractMathItem,t.STATE=MathJax._.core.MathItem.STATE,t.newState=MathJax._.core.MathItem.newState},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Configuration=MathJax._.input.tex.Configuration.Configuration,t.ConfigurationHandler=MathJax._.input.tex.Configuration.ConfigurationHandler,t.ParserConfiguration=MathJax._.input.tex.Configuration.ParserConfiguration},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=MathJax._.input.tex.base.BaseMethods.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=MathJax._.input.tex.ParseMethods.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=MathJax._.input.tex.TexParser.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FONTSIZE=MathJax._.output.chtml.Wrapper.FONTSIZE,t.SPACE=MathJax._.output.chtml.Wrapper.SPACE,t.CHTMLWrapper=MathJax._.output.chtml.Wrapper.CHTMLWrapper},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BBoxStyleAdjust=MathJax._.util.BBox.BBoxStyleAdjust,t.BBox=MathJax._.util.BBox.BBox},function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(4),i=n(5),o=n(3),u=n(6),c=n.n(u),s=n(7),h=n.n(s),p=n(8),l=n.n(p),x=n(1),m=n.n(x),f={whiteSpaceRegex:/^(\s+|%[^\r\n]*(\r\n|\r|\n)?)+/,lengthResolution:128,interpolationResolution:5,machinePrecision:1e-12};function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e,t,n){return t&&y(e.prototype,t),n&&y(e,n),e}function g(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&M(e,t)}function M(e,t){return(M=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=b(e);if(t){var a=b(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return S(this,n)}}function S(e,t){return!t||"object"!==d(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function C(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var k=function e(){C(this,e)},J=function(e){g(n,e);var t=w(n);function n(e){var r;return C(this,n),(r=t.call(this)).get=e,r}return v(n,[{key:"getOrElse",value:function(e){return this.get}},{key:"flatMap",value:function(e){return e(this.get)}},{key:"map",value:function(e){return new n(e(this.get))}},{key:"foreach",value:function(e){e(this.get)}},{key:"toString",value:function(){return"Some("+this.get+")"}},{key:"isEmpty",get:function(){return!1}},{key:"isDefined",get:function(){return!0}}],[{key:"unapply",value:function(e){return new n(e.get)}}]),n}(k),P=function(e){g(n,e);var t=w(n);function n(){return C(this,n),t.call(this)}return v(n,[{key:"getOrElse",value:function(e){return e}},{key:"flatMap",value:function(e){return this}},{key:"foreach",value:function(e){}},{key:"map",value:function(e){return this}},{key:"toString",value:function(){return"None"}},{key:"isEmpty",get:function(){return!0}},{key:"isDefined",get:function(){return!1}}],[{key:"unapply",value:function(e){return new J(e)}}]),n}(k);function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function B(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function E(e,t,n){return t&&B(e.prototype,t),n&&B(e,n),e}function A(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&L(e,t)}function L(e,t){return(L=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T(e);if(t){var a=T(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return D(this,n)}}function D(e,t){return!t||"object"!==O(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function T(e){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function R(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}k.Some=J,k.None=P,k.empty=new P;var F=function e(){R(this,e)},G=function(e){A(n,e);var t=j(n);function n(e,r){var a;return R(this,n),(a=t.call(this)).head=e,a.tail=r,a}return E(n,[{key:"at",value:function(e){if(e<0||e>=this.length())throw Error("no such element at "+e+". index must be lower than "+this.length()+".");for(var t=this,n=0;n<e;n++)t=t.tail;return t.head}},{key:"length",value:function(){for(var e=this,t=0;!e.isEmpty;)t++,e=e.tail;return t}},{key:"prepend",value:function(e){return new n(e,this)}},{key:"append",value:function(e){var t=new n(e,F.empty);return this.reverse().foreach((function(e){t=new n(e,t)})),t}},{key:"concat",value:function(e){var t=e;return this.reverse().foreach((function(e){t=new n(e,t)})),t}},{key:"foldLeft",value:function(e,t){var n,r;for(n=t(e,this.head),r=this.tail;!r.isEmpty;)n=t(n,r.head),r=r.tail;return n}},{key:"foldRight",value:function(e,t){return this.tail.isEmpty?t(this.head,e):t(this.head,this.tail.foldRight(e,t))}},{key:"map",value:function(e){return new n(e(this.head),this.tail.map(e))}},{key:"flatMap",value:function(e){return e(this.head).concat(this.tail.flatMap(e))}},{key:"foreach",value:function(e){for(var t=this;!t.isEmpty;)e(t.head),t=t.tail}},{key:"reverse",value:function(){var e=F.empty;return this.foreach((function(t){e=new n(t,e)})),e}},{key:"mkString",value:function(){var e,t,r,a,i;switch(arguments.length){case 0:e=t=r="";break;case 1:t=arguments[0],e=r="";break;case 2:e=arguments[0],t=arguments[1],r="";break;default:e=arguments[0],t=arguments[1],r=arguments[2]}for(a=e+this.head.toString(),i=this.tail;i instanceof n;)a+=t+i.head.toString(),i=i.tail;return a+=r}},{key:"toString",value:function(){return this.mkString("[",", ","]")}},{key:"isEmpty",get:function(){return!1}}],[{key:"unapply",value:function(e){return new k.Some([e.head,e.tail])}}]),n}(F);F.Cons=G;var V=function(e){A(n,e);var t=j(n);function n(){return R(this,n),t.call(this)}return E(n,[{key:"at",value:function(e){throw new Error("cannot get element from an empty list.")}},{key:"length",value:function(){return 0}},{key:"prepend",value:function(e){return new G(e,F.empty)}},{key:"append",value:function(e){return new G(e,F.empty)}},{key:"concat",value:function(e){return e}},{key:"foldLeft",value:function(e,t){return e}},{key:"foldRight",value:function(e,t){return e}},{key:"flatMap",value:function(e){return this}},{key:"map",value:function(e){return this}},{key:"foreach",value:function(e){}},{key:"reverse",value:function(){return this}},{key:"mkString",value:function(){switch(arguments.length){case 0:case 1:return"";case 2:return arguments[0];default:return arguments[0]+arguments[2]}}},{key:"toString",value:function(){return"[]"}},{key:"isEmpty",get:function(){return!0}}],[{key:"unapply",value:function(e){return new k.Some(e)}}]),n}(F);function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}F.Nil=V,F.empty=new V,F.fromArray=function(e){var t,n;for(t=F.empty,n=e.length-1;n>=0;)t=new G(e[n],t),n-=1;return t};var I=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=t,this.tail=n}var t,n,r;return t=e,r=[{key:"unapply",value:function(e){return new Option.Some([e.head,e.tail])}}],(n=[{key:"toString",value:function(){return"("+this.head+"~"+this.tail+")"}}])&&_(t.prototype,n),r&&_(t,r),e}();function z(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function N(e,t,n){return t&&Q(e.prototype,t),n&&Q(e,n),e}var X=function(){function e(){z(this,e),this.cases=[]}return N(e,[{key:"Case",value:function(e,t){return this.cases.push([e,t]),this}},{key:"match",value:function(e){var t,n,r,a;for(t=0,n=this.cases.length;t<n;){if(e instanceof(r=this.cases[t][0])&&(a=r.unapply(e)).isDefined)return this.cases[t][1](a.get);t+=1}throw new U(e)}}]),e}(),U=function(){function e(t){z(this,e),this.obj=t}return N(e,[{key:"toString",value:function(){return"MatchError("+this.obj+")"}}]),e}();function W(e){return(W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function H(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&q(e,t)}function q(e,t){return(q=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=$(e);if(t){var a=$(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Y(this,n)}}function Y(e,t){return!t||"object"!==W(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $(e){return($=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function K(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ee(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function te(e,t,n){return t&&ee(e.prototype,t),n&&ee(e,n),e}var ne=function(){function e(t,n){K(this,e),this.source=t,this.offset=void 0===n?0:n,this._index=null,this._line=null}return te(e,[{key:"index",value:function(){if(null!==this._index)return this._index;this._index=[],this._index.push(0);for(var e=0;e<this.source.length;)"\n"===this.source.charAt(e)&&this._index.push(e+1),e+=1;return this._index.push(this.source.length),this._index}},{key:"line",value:function(){var e,t,n;if(null!==this._line)return this._line;for(e=0,t=this.index().length-1;e+1<t;)n=t+e>>1,this.offset<this.index()[n]?t=n:e=n;return this._line=e+1,this._line}},{key:"column",value:function(){return this.offset-this.index()[this.line()-1]+1}},{key:"lineContents",value:function(){var e,t;return e=this.index(),t=this.line(),this.source.substring(e[t-1],e[t])}},{key:"toString",value:function(){return this.line().toString()+"."+this.column()}},{key:"longString",value:function(){var e,t;for(e=this.lineContents()+"\n",t=0;t<this.column();)"\t"===this.lineContents().charAt(t)?e+="\t":e+=" ",t+=1;return e+="^"}},{key:"isLessThan",value:function(t){return t instanceof e?this.offset<t.offset:this.line()<t.line()||this.line()===t.line()&&this.column()<t.column()}}]),e}(),re=function(){function e(t,n,r){K(this,e),this.source=t,this.offset=n,this.context=r}return te(e,[{key:"first",value:function(){return this.offset<this.source.length?this.source.charAt(this.offset):e.EofCh}},{key:"rest",value:function(){return this.offset<this.source.length?new e(this.source,this.offset+1,this.context):this}},{key:"pos",value:function(){return new ne(this.source,this.offset)}},{key:"atEnd",value:function(){return this.offset>=this.source.length}},{key:"drop",value:function(e){var t,n;for(t=this,n=e;n>0;)t=t.rest(),n-=1;return t}}]),e}();re.EofCh="\x03";var ae=function(){function e(){K(this,e)}return te(e,null,[{key:"parse",value:function(e,t){return e.apply(t)}},{key:"parseAll",value:function(t,n){return t.andl((function(){return e.eos()})).apply(n)}},{key:"parseString",value:function(t,n){var r=new re(n,0,{lastNoSuccess:void 0});return e.parse(t,r)}},{key:"parseAllString",value:function(t,n){var r=new re(n,0,{lastNoSuccess:void 0});return e.parseAll(t,r)}},{key:"_handleWhiteSpace",value:function(e){var t=e.context.whiteSpaceRegex,n=e.source,r=e.offset,a=t.exec(n.substring(r,n.length));return null!==a?r+a[0].length:r}},{key:"literal",value:function(t){return new he((function(n){var r,a,i,o,u,c;for(r=n.source,a=n.offset,o=0,u=i=e._handleWhiteSpace(n);o<t.length&&u<r.length&&t.charAt(o)===r.charAt(u);)o+=1,u+=1;return o===t.length?new oe(t,n.drop(u-a)):(c=i===r.length?"end of source":"`"+r.charAt(i)+"'",new ce("`"+t+"' expected but "+c+" found",n.drop(i-a)))}))}},{key:"regex",value:function(e){if("/^"!==e.toString().substring(0,2))throw"regex must start with `^' but "+e;return new he((function(t){var n,r,a,i;return n=t.source,r=t.offset,null!==(a=e.exec(n.substring(r,n.length)))?new oe(a[0],t.drop(a[0].length)):(i=r===n.length?"end of source":"`"+n.charAt(r)+"'",new ce("string matching regex "+e+" expected but "+i+" found",t))}))}},{key:"regexLiteral",value:function(t){if("/^"!==t.toString().substring(0,2))throw"regex must start with `^' but "+t;return new he((function(n){var r,a,i,o,u;return r=n.source,a=n.offset,i=e._handleWhiteSpace(n),null!==(o=t.exec(r.substring(i,r.length)))?new oe(o[0],n.drop(i+o[0].length-a)):(u=i===r.length?"end of source":"`"+r.charAt(i)+"'",new ce("string matching regex "+t+" expected but "+u+" found",n.drop(i-a)))}))}},{key:"eos",value:function(){return new he((function(t){var n,r;return n=t.source,t.offset,r=e._handleWhiteSpace(t),n.length===r?new oe("",t):new ce("end of source expected but `"+n.charAt(r)+"' found",t)}))}},{key:"commit",value:function(e){return new he((function(t){var n=e()(t);return(new X).Case(oe,(function(e){return n})).Case(se,(function(e){return n})).Case(ce,(function(e){return new se(e[0],e[1])})).match(n)}))}},{key:"elem",value:function(t){return e.accept(t).named('"'+t+'"')}},{key:"accept",value:function(t){return e.acceptIf((function(e){return e===t}),(function(e){return"`"+t+"' expected but `"+e+"' found"}))}},{key:"acceptIf",value:function(e,t){return new he((function(n){return e(n.first())?new oe(n.first(),n.rest()):new ce(t(n.first()),n)}))}},{key:"failure",value:function(e){return new he((function(t){return new ce(e,t)}))}},{key:"err",value:function(e){return new he((function(t){return new se(e,t)}))}},{key:"success",value:function(e){return new he((function(t){return new oe(e,t)}))}},{key:"log",value:function(e,t){return new he((function(n){console.log("trying "+t+" at "+n);var r=e().apply(n);return console.log(t+" --\x3e "+r),r}))}},{key:"rep",value:function(t){var n=e.success(F.empty);return e.rep1(t).or((function(){return n}))}},{key:"rep1",value:function(e){return new he((function(t){var n,r,a,i;if(n=[],r=t,(i=(a=e()).apply(t))instanceof oe){for(;i instanceof oe;)n.push(i.result),r=i.next,i=a.apply(r);return new oe(F.fromArray(n),r)}return i}))}},{key:"repN",value:function(t,n){return 0===t?e.success(FP.List.empty):new he((function(e){var r,a,i,o;for(r=[],a=e,o=(i=n()).apply(a);o instanceof oe;){if(r.push(o.result),a=o.next,t===r.length)return new oe(F.fromArray(r),a);o=i.apply(a)}return o}))}},{key:"repsep",value:function(t,n){var r=e.success(F.empty);return e.rep1sep(t,n).or((function(){return r}))}},{key:"rep1sep",value:function(t,n){return t().and(e.rep(n().andr(t))).to((function(e){return new F.Cons(e.head,e.tail)}))}},{key:"chainl1",value:function(t,n,r){return t().and(e.rep(r().and(n))).to((function(e){return e.tail.foldLeft(e.head,(function(e,t){return t.head(e,t.tail)}))}))}},{key:"chainr1",value:function(e,t,n,r){return e().and(this.rep(t().and(e))).to((function(e){return new F.Cons(new I(n,e.head),e.tail).foldRight(r,(function(e,t){return e.head(e.tail,t)}))}))}},{key:"opt",value:function(t){return t().to((function(e){return new k.Some(e)})).or((function(){return e.success(k.empty)}))}},{key:"not",value:function(e){return new he((function(t){return e().apply(t).successful?new ce("Expected failure",t):new oe(k.empty,t)}))}},{key:"guard",value:function(e){return new he((function(t){var n=e().apply(t);return n.successful?new oe(n.result,t):n}))}},{key:"mkList",value:function(e){return new F.Cons(e.head,e.tail)}},{key:"fun",value:function(e){return function(){return e}}},{key:"lazyParser",value:function(t){var n,r;return t instanceof String||"string"==typeof t?(n=e.literal(t),function(){return n}):t instanceof Function?t:t instanceof Object?t instanceof he?function(){return t}:t instanceof RegExp?(r=e.regexLiteral(t),function(){return r}):e.err("unhandlable type"):e.err("unhandlable type")}},{key:"seq",value:function(){var t,n,r;if(0===(t=arguments.length))return e.err("at least one element must be specified");for(n=e.lazyParser(arguments[0])(),r=1;r<t;)n=n.and(e.lazyParser(arguments[r])),r+=1;return n}},{key:"or",value:function(){var t,n,r;if(0===(t=arguments.length))return e.err("at least one element must be specified");for(n=e.lazyParser(arguments[0])(),r=1;r<t;)n=n.or(e.lazyParser(arguments[r])),r+=1;return n}}]),e}(),ie=function(){function e(){K(this,e)}return te(e,[{key:"isEmpty",value:function(){return!this.successful}},{key:"getOrElse",value:function(e){return this.isEmpty?e():this.get()}}]),e}();ae.ParseResult=ie;var oe=function(e){H(n,e);var t=Z(n);function n(e,r){var a;return K(this,n),(a=t.call(this)).result=e,a.next=r,a}return te(n,[{key:"map",value:function(e){return new n(e(this.result),this.next)}},{key:"mapPartial",value:function(e,t){try{return new n(e(this.result),this.next)}catch(e){if(e instanceof U)return new ce(t(this.result),this.next);throw e}}},{key:"flatMapWithNext",value:function(e){return e(this.result).apply(this.next)}},{key:"append",value:function(e){return this}},{key:"get",value:function(){return this.result}},{key:"toString",value:function(){return"["+this.next.pos()+"] parsed: "+this.result}},{key:"successful",get:function(){return!0}}],[{key:"unapply",value:function(e){return new k.Some([e.result,e.next])}}]),n}(ie);ae.Success=oe;var ue=function(e){H(n,e);var t=Z(n);function n(){return K(this,n),t.call(this)}return te(n,[{key:"_setLastNoSuccess",value:function(){var e=this.next.context;void 0!==e.lastNoSuccess&&this.next.pos().isLessThan(e.lastNoSuccess.next.pos())||(e.lastNoSuccess=this)}},{key:"map",value:function(e){return this}},{key:"mapPartial",value:function(e,t){return this}},{key:"flatMapWithNext",value:function(e){return this}},{key:"get",value:function(){return ae.error("No result when parsing failed")}},{key:"successful",get:function(){return!1}}]),n}(ie);ae.NoSuccess=ue;var ce=function(e){H(n,e);var t=Z(n);function n(e,r){var a;return K(this,n),(a=t.call(this)).msg=e,a.next=r,a._setLastNoSuccess(),a}return te(n,[{key:"append",value:function(e){var t=e();if(t instanceof oe)return t;if(t instanceof ue)return t.next.pos().isLessThan(this.next.pos())?this:t;throw new U(t)}},{key:"toString",value:function(){return"["+this.next.pos()+"] failure: "+this.msg+"\n\n"+this.next.pos().longString()}}],[{key:"unapply",value:function(e){return new k.Some([e.msg,e.next])}}]),n}(ue);ae.Failure=ce;var se=function(e){H(n,e);var t=Z(n);function n(e,r){var a;return K(this,n),(a=t.call(this)).msg=e,a.next=r,a._setLastNoSuccess(),a}return te(n,[{key:"append",value:function(e){return this}},{key:"toString",value:function(){return"["+this.next.pos()+"] error: "+this.msg+"\n\n"+this.next.pos().longString()}}],[{key:"unapply",value:function(e){return new k.Some([e.msg,e.next])}}]),n}(ue);ae.ParseError=se;var he=function(){function e(t){K(this,e),this.apply=t,this.name=""}return te(e,[{key:"named",value:function(e){return this.name=e,this}},{key:"toString",value:function(){return"Parser ("+this.name+")"}},{key:"flatMap",value:function(t){var n=this;return new e((function(e){return n.apply(e).flatMapWithNext(t)}))}},{key:"map",value:function(t){var n=this;return new e((function(e){return n.apply(e).map(t)}))}},{key:"append",value:function(t){var n=this;return new e((function(e){return n.apply(e).append((function(){return t().apply(e)}))}))}},{key:"and",value:function(e){return this.flatMap((function(t){return e().map((function(e){return new I(t,e)}))})).named("~")}},{key:"andr",value:function(e){return this.flatMap((function(t){return e().map((function(e){return e}))})).named("~>")}},{key:"andl",value:function(e){return this.flatMap((function(t){return e().map((function(e){return t}))})).named("<~")}},{key:"or",value:function(e){return this.append(e).named("|")}},{key:"andOnce",value:function(e){var t=this;return new pe((function(){return t.flatMap((function(t){return ae.commit(e).map((function(e){return new I(t,e)}))})).named("~!")}))}},{key:"longestOr",value:function(t){var n=this;return new e((function(e){var r,a;return r=n.apply(e),a=t()(e),r.successful?a.successful?a.next.pos().isLessThan(r.next.pos())?r:a:r:a.successful?a:r instanceof se||a.next.pos().isLessThan(r.next.pos())?r:a})).named("|||")}},{key:"to",value:function(e){return this.map(e).named(this.toString()+"^^")}},{key:"ret",value:function(t){var n=this;return new e((function(e){return n.apply(e).map((function(e){return t()}))})).named(this.toString()+"^^^")}},{key:"toIfPossible",value:function(t,n){void 0===n&&(n=function(e){return"Constructor function not defined at "+e});var r=this;return new e((function(e){return r.apply(e).mapPartial(t,n)})).named(this.toString()+"^?")}},{key:"into",value:function(e){return this.flatMap(e)}},{key:"rep",value:function(){var e=this;return ae.rep((function(){return e}))}},{key:"chain",value:function(e){var t,n;return t=this,n=function(){return t},ae.chainl1(n,n,e)}},{key:"rep1",value:function(){var e=this;return ae.rep1((function(){return e}))}},{key:"opt",value:function(){var e=this;return ae.opt((function(){return e}))}}]),e}();ae.Parser=he;var pe=function(e){H(n,e);var t=Z(n);function n(e){return K(this,n),t.call(this,e)}return te(n,[{key:"and",value:function(e){var t=this;return new n((function(){return t.flatMap((function(t){return ae.commit(e).map((function(e){return I(t,e)}))}))})).named("~")}}]),n}(he);ae.OnceParser=pe;var le=n(2);function xe(e){return(xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function me(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fe(e,t,n){return t&&me(e.prototype,t),n&&me(e,n),e}function de(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ye(e,t)}function ye(e,t){return(ye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ve(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Me(e);if(t){var a=Me(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return ge(this,n)}}function ge(e,t){return!t||"object"!==xe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Me(e){return(Me=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function we(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Se=function e(){we(this,e)},be=function(e){de(n,e);var t=ve(n);function n(e,r){var a;return we(this,n),(a=t.call(this,e,{},r)).textMmls=r,a.texClass=le.TEXCLASS.ORD,a}return n}(le.AbstractMmlNode);be.defaults=le.AbstractMmlNode.defaults,(Se.xypic=function(e){de(n,e);var t=ve(n);function n(e,r,a){var i;return we(this,n),(i=t.call(this,e,a)).cmd=r,i}return fe(n,[{key:"toString",value:function(){return this.kind+"("+this.cmd+")"}},{key:"kind",get:function(){return"xypic"}}]),n}(be)).defaults=be.defaults,Se.xypic.newdir=function(e){de(n,e);var t=ve(n);function n(e,r,a){var i;return we(this,n),(i=t.call(this,e,a)).cmd=r,i}return fe(n,[{key:"toString",value:function(){return this.kind+"("+this.cmd+")"}},{key:"kind",get:function(){return"xypic-newdir"}}]),n}(be),Se.xypic.newdir.defaults=be.defaults,Se.xypic.includegraphics=function(e){de(n,e);var t=ve(n);function n(e,r,a){var i;return we(this,n),(i=t.call(this,e,a)).cmd=r,i}return fe(n,[{key:"toString",value:function(){return this.kind+"("+this.cmd+")"}},{key:"kind",get:function(){return"xypic-includegraphics"}}]),n}(be),Se.xypic.includegraphics.defaults=be.defaults,Se.PosDecor=function(){function e(t,n){we(this,e),this.pos=t,this.decor=n}return fe(e,[{key:"toString",value:function(){return this.pos.toString()+" "+this.decor}}]),e}(),(Se.Pos=function e(){we(this,e)}).Coord=function(){function e(t,n){we(this,e),this.coord=t,this.pos2s=n}return fe(e,[{key:"toString",value:function(){return this.coord.toString()+" "+this.pos2s.mkString(" ")}}]),e}(),Se.Pos.Plus=function(){function e(t){we(this,e),this.coord=t}return fe(e,[{key:"toString",value:function(){return"+("+this.coord+")"}}]),e}(),Se.Pos.Minus=function(){function e(t){we(this,e),this.coord=t}return fe(e,[{key:"toString",value:function(){return"-("+this.coord+")"}}]),e}(),Se.Pos.Skew=function(){function e(t){we(this,e),this.coord=t}return fe(e,[{key:"toString",value:function(){return"!("+this.coord+")"}}]),e}(),Se.Pos.Cover=function(){function e(t){we(this,e),this.coord=t}return fe(e,[{key:"toString",value:function(){return".("+this.coord+")"}}]),e}(),Se.Pos.Then=function(){function e(t){we(this,e),this.coord=t}return fe(e,[{key:"toString",value:function(){return",("+this.coord+")"}}]),e}(),Se.Pos.SwapPAndC=function(){function e(t){we(this,e),this.coord=t}return fe(e,[{key:"toString",value:function(){return";("+this.coord+")"}}]),e}(),Se.Pos.SetBase=function(){function e(t){we(this,e),this.coord=t}return fe(e,[{key:"toString",value:function(){return":("+this.coord+")"}}]),e}(),Se.Pos.SetYBase=function(){function e(t){we(this,e),this.coord=t}return fe(e,[{key:"toString",value:function(){return"::("+this.coord+")"}}]),e}(),Se.Pos.ConnectObject=function(){function e(t){we(this,e),this.object=t}return fe(e,[{key:"toString",value:function(){return"**("+this.object+")"}}]),e}(),Se.Pos.DropObject=function(){function e(t){we(this,e),this.object=t}return fe(e,[{key:"toString",value:function(){return"*("+this.object+")"}}]),e}(),Se.Pos.Place=function(){function e(t){we(this,e),this.place=t}return fe(e,[{key:"toString",value:function(){return"?("+this.place+")"}}]),e}(),Se.Pos.PushCoord=function(){function e(t){we(this,e),this.coord=t}return fe(e,[{key:"toString",value:function(){return"@+("+this.coord+")"}}]),e}(),Se.Pos.EvalCoordThenPop=function(){function e(t){we(this,e),this.coord=t}return fe(e,[{key:"toString",value:function(){return"@-("+this.coord+")"}}]),e}(),Se.Pos.LoadStack=function(){function e(t){we(this,e),this.coord=t}return fe(e,[{key:"toString",value:function(){return"@=("+this.coord+")"}}]),e}(),Se.Pos.DoCoord=function(){function e(t){we(this,e),this.coord=t}return fe(e,[{key:"toString",value:function(){return"@@("+this.coord+")"}}]),e}(),Se.Pos.InitStack=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"@i"}}]),e}(),Se.Pos.EnterFrame=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"@("}}]),e}(),Se.Pos.LeaveFrame=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"@)"}}]),e}(),Se.Pos.SavePos=function(){function e(t){we(this,e),this.id=t}return fe(e,[{key:"toString",value:function(){return'="'+this.id+'"'}}]),e}(),Se.Pos.SaveMacro=function(){function e(t,n){we(this,e),this.macro=t,this.id=n}return fe(e,[{key:"toString",value:function(){return"=("+this.macro+' "'+this.id+'")'}}]),e}(),Se.Pos.SaveBase=function(){function e(t){we(this,e),this.id=t}return fe(e,[{key:"toString",value:function(){return'=:"'+this.id+'"'}}]),e}(),Se.Pos.SaveStack=function(){function e(t){we(this,e),this.id=t}return fe(e,[{key:"toString",value:function(){return'=@"'+this.id+'"'}}]),e}(),(Se.Coord=function e(){we(this,e)}).Vector=function(){function e(t){we(this,e),this.vector=t}return fe(e,[{key:"toString",value:function(){return this.vector.toString()}}]),e}(),Se.Coord.C=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"c"}}]),e}(),Se.Coord.P=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"p"}}]),e}(),Se.Coord.X=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"x"}}]),e}(),Se.Coord.Y=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"y"}}]),e}(),Se.Coord.Id=function(){function e(t){we(this,e),this.id=t}return fe(e,[{key:"toString",value:function(){return'"'+this.id+'"'}}]),e}(),Se.Coord.Group=function(){function e(t){we(this,e),this.posDecor=t}return fe(e,[{key:"toString",value:function(){return"{"+this.posDecor+"}"}}]),e}(),Se.Coord.StackPosition=function(){function e(t){we(this,e),this.number=t}return fe(e,[{key:"toString",value:function(){return"s{"+this.number+"}"}}]),e}(),Se.Coord.DeltaRowColumn=function(){function e(t,n,r){we(this,e),this.prefix=t,this.dr=n,this.dc=r}return fe(e,[{key:"toString",value:function(){return"["+(""===this.prefix?"":'"'+this.prefix+'"')+this.dr+","+this.dc+"]"}}]),e}(),Se.Coord.Hops=function(){function e(t,n){we(this,e),this.prefix=t,this.hops=n}return fe(e,[{key:"toString",value:function(){return"["+(""===this.prefix?"":'"'+this.prefix+'"')+this.hops.mkString("")+"]"}}]),e}(),Se.Coord.HopsWithPlace=function(){function e(t,n,r){we(this,e),this.prefix=t,this.hops=n,this.place=r}return fe(e,[{key:"toString",value:function(){return"["+(""===this.prefix?"":'"'+this.prefix+'"')+this.hops.mkString("")+this.place+"]"}}]),e}(),(Se.Vector=function e(){we(this,e)}).InCurBase=function(){function e(t,n){we(this,e),this.x=t,this.y=n}return fe(e,[{key:"toString",value:function(){return"("+this.x+", "+this.y+")"}}]),e}(),Se.Vector.Abs=function(){function e(t,n){we(this,e),this.x=t,this.y=n}return fe(e,[{key:"toString",value:function(){return"<"+this.x+", "+this.y+">"}}]),e}(),Se.Vector.Angle=function(){function e(t){we(this,e),this.degree=t}return fe(e,[{key:"toString",value:function(){return"a("+this.degree+")"}}]),e}(),Se.Vector.Dir=function(){function e(t,n){we(this,e),this.dir=t,this.dimen=n}return fe(e,[{key:"toString",value:function(){return"/"+this.dir+" "+this.dimen+"/"}}]),e}(),Se.Vector.Corner=function(){function e(t,n){we(this,e),this.corner=t,this.factor=n}return fe(e,[{key:"toString",value:function(){return this.corner.toString()+"("+this.factor+")"}}]),e}(),(Se.Corner=function e(){we(this,e)}).L=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"L"}}]),e}(),Se.Corner.R=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"R"}}]),e}(),Se.Corner.D=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"D"}}]),e}(),Se.Corner.U=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"U"}}]),e}(),Se.Corner.CL=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"CL"}}]),e}(),Se.Corner.CR=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"CR"}}]),e}(),Se.Corner.CD=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"CD"}}]),e}(),Se.Corner.CU=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"CU"}}]),e}(),Se.Corner.LD=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"LD"}}]),e}(),Se.Corner.RD=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"RD"}}]),e}(),Se.Corner.LU=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"LU"}}]),e}(),Se.Corner.RU=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"RU"}}]),e}(),Se.Corner.NearestEdgePoint=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"E"}}]),e}(),Se.Corner.PropEdgePoint=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"P"}}]),e}(),Se.Corner.Axis=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"A"}}]),e}(),(Se.Place=function(){function e(t,n,r,a){we(this,e),this.shaveP=t,this.shaveC=n,this.factor=r,this.slide=a}return fe(e,[{key:"compound",value:function(e){return new Se.Place(this.shaveP+e.shaveP,this.shaveC+e.shaveC,void 0===e.factor?this.factor:e.factor,e.slide)}},{key:"toString",value:function(){for(var e="",t=0;t<this.shaveP;t++)e+="<";for(var n=0;n<this.shaveC;n++)e+=">";return void 0!==this.factor&&(e+="("+this.factor+")"),this.slide.dimen.foreach((function(t){e+="/"+t+"/"})),e}}]),e}()).Factor=function(){function e(t){we(this,e),this.factor=t}return fe(e,[{key:"toString",value:function(){return this.factor.toString()}},{key:"isIntercept",get:function(){return!1}}]),e}(),Se.Place.Intercept=function(){function e(t){we(this,e),this.pos=t}return fe(e,[{key:"toString",value:function(){return"!{"+this.pos+"}"}},{key:"isIntercept",get:function(){return!0}}]),e}(),Se.Slide=function(){function e(t){we(this,e),this.dimen=t}return fe(e,[{key:"toString",value:function(){return this.dimen.getOrElse("")}}]),e}(),Se.Object=function(){function e(t,n){we(this,e),this.modifiers=t,this.object=n}return fe(e,[{key:"dirVariant",value:function(){return this.object.dirVariant()}},{key:"dirMain",value:function(){return this.object.dirMain()}},{key:"isDir",value:function(){return this.object.isDir()}},{key:"toString",value:function(){return this.modifiers.mkString()+this.object.toString()}}]),e}(),(Se.ObjectBox=function(){function e(){we(this,e)}return fe(e,[{key:"dirVariant",value:function(){}},{key:"dirMain",value:function(){}},{key:"isDir",value:function(){return!1}},{key:"isEmpty",get:function(){return!1}}]),e}()).Text=function(e){de(n,e);var t=ve(n);function n(e){var r;return we(this,n),(r=t.call(this)).math=e,r}return fe(n,[{key:"toString",value:function(){return"{"+this.math.toString()+"}"}}]),n}(Se.ObjectBox),Se.ObjectBox.Empty=function(e){de(n,e);var t=ve(n);function n(){return we(this,n),t.call(this)}return fe(n,[{key:"toString",value:function(){return"{}"}},{key:"isEmpty",get:function(){return!0}}]),n}(Se.ObjectBox),Se.ObjectBox.Xymatrix=function(e){de(n,e);var t=ve(n);function n(e){var r;return we(this,n),(r=t.call(this)).xymatrix=e,r}return fe(n,[{key:"toString",value:function(){return this.xymatrix.toString()}}]),n}(Se.ObjectBox),Se.ObjectBox.Txt=function(e){de(n,e);var t=ve(n);function n(e,r){var a;return we(this,n),(a=t.call(this)).width=e,a.textObject=r,a}return fe(n,[{key:"toString",value:function(){return"\\txt"+this.width+"{"+this.textObject.toString()+"}"}}]),n}(Se.ObjectBox),Se.ObjectBox.Txt.Width=function(e){de(n,e);var t=ve(n);function n(){return we(this,n),t.call(this)}return n}(Se.ObjectBox),Se.ObjectBox.Txt.Width.Vector=function(e){de(n,e);var t=ve(n);function n(e){var r;return we(this,n),(r=t.call(this)).vector=e,r}return fe(n,[{key:"toString",value:function(){return this.vector.toString()}}]),n}(Se.ObjectBox),Se.ObjectBox.Txt.Width.Default=function(e){de(n,e);var t=ve(n);function n(){return we(this,n),t.call(this)}return fe(n,[{key:"toString",value:function(){return""}}]),n}(Se.ObjectBox),Se.ObjectBox.WrapUpObject=function(e){de(n,e);var t=ve(n);function n(e){var r;return we(this,n),(r=t.call(this)).object=e,r}return fe(n,[{key:"toString",value:function(){return"\\object"+this.object.toString()}}]),n}(Se.ObjectBox),Se.ObjectBox.CompositeObject=function(e){de(n,e);var t=ve(n);function n(e){var r;return we(this,n),(r=t.call(this)).objects=e,r}return fe(n,[{key:"toString",value:function(){return"\\composite{"+this.objects.mkString(" * ")+"}"}}]),n}(Se.ObjectBox),Se.ObjectBox.Xybox=function(e){de(n,e);var t=ve(n);function n(e){var r;return we(this,n),(r=t.call(this)).posDecor=e,r}return fe(n,[{key:"toString",value:function(){return"\\xybox{"+this.posDecor.toString()+"}"}}]),n}(Se.ObjectBox),Se.ObjectBox.Cir=function(e){de(n,e);var t=ve(n);function n(e,r){var a;return we(this,n),(a=t.call(this)).radius=e,a.cir=r,a}return fe(n,[{key:"toString",value:function(){return"\\cir"+this.radius+"{"+this.cir+"}"}}]),n}(Se.ObjectBox),Se.ObjectBox.Cir.Radius=function e(){we(this,e)},Se.ObjectBox.Cir.Radius.Vector=function(){function e(t){we(this,e),this.vector=t}return fe(e,[{key:"toString",value:function(){return this.vector.toString()}}]),e}(),Se.ObjectBox.Cir.Radius.Default=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return""}}]),e}(),Se.ObjectBox.Cir.Cir=function e(){we(this,e)},Se.ObjectBox.Cir.Cir.Segment=function(){function e(t,n,r){we(this,e),this.startDiag=t,this.orient=n,this.endDiag=r}return fe(e,[{key:"toString",value:function(){return this.startDiag.toString()+this.orient+this.endDiag}}]),e}(),Se.ObjectBox.Cir.Cir.Full=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return""}}]),e}(),Se.ObjectBox.Dir=function(e){de(n,e);var t=ve(n);function n(e,r){var a;return we(this,n),(a=t.call(this)).variant=e,a.main=r,a}return fe(n,[{key:"dirVariant",value:function(){return this.variant}},{key:"dirMain",value:function(){return this.main}},{key:"isDir",value:function(){return!0}},{key:"toString",value:function(){return"\\dir"+this.variant+"{"+this.main+"}"}}]),n}(Se.ObjectBox),Se.ObjectBox.Curve=function(e){de(n,e);var t=ve(n);function n(e,r,a){var i;return we(this,n),(i=t.call(this)).modifiers=e,i.objects=r,i.poslist=a,i}return fe(n,[{key:"dirVariant",value:function(){return""}},{key:"dirMain",value:function(){return"-"}},{key:"isDir",value:function(){return!1}},{key:"toString",value:function(){return"\\curve"+this.modifiers.mkString("")+"{"+this.objects.mkString(" ")+" "+this.poslist.mkString("&")+"}"}}]),n}(Se.ObjectBox),Se.ObjectBox.Curve.Modifier=function e(){we(this,e)},Se.ObjectBox.Curve.Modifier.p=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"~p"}}]),e}(),Se.ObjectBox.Curve.Modifier.P=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"~P"}}]),e}(),Se.ObjectBox.Curve.Modifier.l=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"~l"}}]),e}(),Se.ObjectBox.Curve.Modifier.L=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"~L"}}]),e}(),Se.ObjectBox.Curve.Modifier.c=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"~c"}}]),e}(),Se.ObjectBox.Curve.Modifier.C=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"~C"}}]),e}(),Se.ObjectBox.Curve.Modifier.pc=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"~pc"}}]),e}(),Se.ObjectBox.Curve.Modifier.pC=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"~pC"}}]),e}(),Se.ObjectBox.Curve.Modifier.Pc=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"~Pc"}}]),e}(),Se.ObjectBox.Curve.Modifier.PC=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"~PC"}}]),e}(),Se.ObjectBox.Curve.Modifier.lc=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"~lc"}}]),e}(),Se.ObjectBox.Curve.Modifier.lC=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"~lC"}}]),e}(),Se.ObjectBox.Curve.Modifier.Lc=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"~Lc"}}]),e}(),Se.ObjectBox.Curve.Modifier.LC=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"~LC"}}]),e}(),Se.ObjectBox.Curve.Modifier.cC=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"~cC"}}]),e}(),Se.ObjectBox.Curve.Object=function e(){we(this,e)},Se.ObjectBox.Curve.Object.Drop=function(){function e(t){we(this,e),this.object=t}return fe(e,[{key:"toString",value:function(){return"~*"+this.object}}]),e}(),Se.ObjectBox.Curve.Object.Connect=function(){function e(t){we(this,e),this.object=t}return fe(e,[{key:"toString",value:function(){return"~**"+this.object}}]),e}(),Se.ObjectBox.Curve.PosList=function e(){we(this,e)},Se.ObjectBox.Curve.PosList.CurPos=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return""}}]),e}(),Se.ObjectBox.Curve.PosList.Pos=function(){function e(t){we(this,e),this.pos=t}return fe(e,[{key:"toString",value:function(){return this.pos.toString()}}]),e}(),Se.ObjectBox.Curve.PosList.AddStack=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"~@"}}]),e}(),(Se.Modifier=function e(){we(this,e)}).Vector=function(e){de(n,e);var t=ve(n);function n(e){var r;return we(this,n),(r=t.call(this)).vector=e,r}return fe(n,[{key:"toString",value:function(){return"!"+this.vector}}]),n}(Se.Modifier),Se.Modifier.RestoreOriginalRefPoint=function(e){de(n,e);var t=ve(n);function n(){return we(this,n),t.call(this)}return fe(n,[{key:"toString",value:function(){return"!"}}]),n}(Se.Modifier),Se.Modifier.AddOp=function(e){de(n,e);var t=ve(n);function n(e,r){var a;return we(this,n),(a=t.call(this)).op=e,a.size=r,a}return fe(n,[{key:"toString",value:function(){return this.op.toString()+" "+this.size}}]),n}(Se.Modifier),Se.Modifier.AddOp.Grow=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"+"}}]),e}(),Se.Modifier.AddOp.Shrink=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"-"}}]),e}(),Se.Modifier.AddOp.Set=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"="}}]),e}(),Se.Modifier.AddOp.GrowTo=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"+="}}]),e}(),Se.Modifier.AddOp.ShrinkTo=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"-="}}]),e}(),Se.Modifier.AddOp.VactorSize=function(){function e(t){we(this,e),this.vector=t}return fe(e,[{key:"toString",value:function(){return this.vector.toString()}},{key:"isDefault",get:function(){return!1}}]),e}(),Se.Modifier.AddOp.DefaultSize=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return""}},{key:"isDefault",get:function(){return!0}}]),e}(),Se.Modifier.Shape=function e(){we(this,e)},Se.Modifier.Shape.Point=function(e){de(n,e);var t=ve(n);function n(){return we(this,n),t.call(this)}return fe(n,[{key:"toString",value:function(){return"[.]"}}]),n}(Se.Modifier),Se.Modifier.Shape.Rect=function(e){de(n,e);var t=ve(n);function n(){return we(this,n),t.call(this)}return fe(n,[{key:"toString",value:function(){return"[]"}}]),n}(Se.Modifier),Se.Modifier.Shape.Alphabets=function(e){de(n,e);var t=ve(n);function n(e){var r;return we(this,n),(r=t.call(this)).alphabets=e,r}return fe(n,[{key:"toString",value:function(){return"["+this.alphabets+"]"}}]),n}(Se.Modifier),Se.Modifier.Shape.DefineShape=function(e){de(n,e);var t=ve(n);function n(e){var r;return we(this,n),(r=t.call(this)).shape=e,r}return fe(n,[{key:"toString",value:function(){return"["+this.shape+"]"}}]),n}(Se.Modifier),Se.Modifier.Shape.Circle=function(e){de(n,e);var t=ve(n);function n(){return we(this,n),t.call(this)}return fe(n,[{key:"toString",value:function(){return"[o]"}}]),n}(Se.Modifier),Se.Modifier.Shape.L=function(e){de(n,e);var t=ve(n);function n(){return we(this,n),t.call(this)}return fe(n,[{key:"toString",value:function(){return"[l]"}}]),n}(Se.Modifier),Se.Modifier.Shape.R=function(e){de(n,e);var t=ve(n);function n(){return we(this,n),t.call(this)}return fe(n,[{key:"toString",value:function(){return"[r]"}}]),n}(Se.Modifier),Se.Modifier.Shape.U=function(e){de(n,e);var t=ve(n);function n(){return we(this,n),t.call(this)}return fe(n,[{key:"toString",value:function(){return"[u]"}}]),n}(Se.Modifier),Se.Modifier.Shape.D=function(e){de(n,e);var t=ve(n);function n(){return we(this,n),t.call(this)}return fe(n,[{key:"toString",value:function(){return"[d]"}}]),n}(Se.Modifier),Se.Modifier.Shape.C=function(e){de(n,e);var t=ve(n);function n(){return we(this,n),t.call(this)}return fe(n,[{key:"toString",value:function(){return"[c]"}}]),n}(Se.Modifier),Se.Modifier.Shape.ChangeColor=function(e){de(n,e);var t=ve(n);function n(e){var r;return we(this,n),(r=t.call(this)).colorName=e,r}return fe(n,[{key:"toString",value:function(){return"["+this.colorName+"]"}}]),n}(Se.Modifier),Se.Modifier.Shape.CompositeModifiers=function(e){de(n,e);var t=ve(n);function n(e){var r;return we(this,n),(r=t.call(this)).modifiers=e,r}return fe(n,[{key:"toString",value:function(){return this.modifiers.mkString("")}}]),n}(Se.Modifier),Se.Modifier.Shape.Frame=function(e){de(n,e);var t=ve(n);function n(e,r){var a;return we(this,n),(a=t.call(this)).main=e,a.options=r,a}return fe(n,[{key:"toString",value:function(){return"[F"+this.main+this.options.mkString("")+"]"}}]),n}(Se.Modifier),Se.Modifier.Shape.Frame.Radius=function(){function e(t){we(this,e),this.vector=t}return fe(e,[{key:"toString",value:function(){return":"+this.vector}}]),e}(),Se.Modifier.Shape.Frame.Color=function(){function e(t){we(this,e),this.colorName=t}return fe(e,[{key:"toString",value:function(){return":"+this.colorName}}]),e}(),Se.Modifier.Invisible=function(e){de(n,e);var t=ve(n);function n(){return we(this,n),t.call(this)}return fe(n,[{key:"toString",value:function(){return"i"}}]),n}(Se.Modifier),Se.Modifier.Hidden=function(e){de(n,e);var t=ve(n);function n(){return we(this,n),t.call(this)}return fe(n,[{key:"toString",value:function(){return"h"}}]),n}(Se.Modifier),Se.Modifier.Direction=function(e){de(n,e);var t=ve(n);function n(e){var r;return we(this,n),(r=t.call(this)).direction=e,r}return fe(n,[{key:"toString",value:function(){return this.direction.toString()}}]),n}(Se.Modifier),(Se.Direction=function e(){we(this,e)}).Compound=function(){function e(t,n){we(this,e),this.dir=t,this.rots=n}return fe(e,[{key:"toString",value:function(){return this.dir.toString()+this.rots.mkString()}}]),e}(),Se.Direction.Diag=function(){function e(t){we(this,e),this.diag=t}return fe(e,[{key:"toString",value:function(){return this.diag.toString()}}]),e}(),Se.Direction.Vector=function(){function e(t){we(this,e),this.vector=t}return fe(e,[{key:"toString",value:function(){return"v"+this.vector.toString()}}]),e}(),Se.Direction.ConstructVector=function(){function e(t){we(this,e),this.posDecor=t}return fe(e,[{key:"toString",value:function(){return"q{"+this.posDecor.toString()+"}"}}]),e}(),Se.Direction.RotVector=function(){function e(t){we(this,e),this.vector=t}return fe(e,[{key:"toString",value:function(){return":"+this.vector.toString()}}]),e}(),Se.Direction.RotAntiCW=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"_"}}]),e}(),Se.Direction.RotCW=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"^"}}]),e}(),(Se.Diag=function e(){we(this,e)}).Default=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return""}}]),e}(),Se.Diag.Angle=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return this.symbol}}]),e}(),Se.Diag.LD=function(e){de(n,e);var t=ve(n);function n(){return we(this,n),t.call(this)}return fe(n,[{key:"turn",value:function(e){return"^"===e?new Se.Diag.RD:new Se.Diag.LU}},{key:"symbol",get:function(){return"ld"}},{key:"ang",get:function(){return-3*Math.PI/4}}]),n}(Se.Diag.Angle),Se.Diag.RD=function(e){de(n,e);var t=ve(n);function n(){return we(this,n),t.call(this)}return fe(n,[{key:"turn",value:function(e){return"^"===e?new Se.Diag.RU:new Se.Diag.LD}},{key:"symbol",get:function(){return"rd"}},{key:"ang",get:function(){return-Math.PI/4}}]),n}(Se.Diag.Angle),Se.Diag.LU=function(e){de(n,e);var t=ve(n);function n(){return we(this,n),t.call(this)}return fe(n,[{key:"turn",value:function(e){return"^"===e?new Se.Diag.LD:new Se.Diag.RU}},{key:"symbol",get:function(){return"lu"}},{key:"ang",get:function(){return 3*Math.PI/4}}]),n}(Se.Diag.Angle),Se.Diag.RU=function(e){de(n,e);var t=ve(n);function n(){return we(this,n),t.call(this)}return fe(n,[{key:"turn",value:function(e){return"^"===e?new Se.Diag.LU:new Se.Diag.RD}},{key:"symbol",get:function(){return"ru"}},{key:"ang",get:function(){return Math.PI/4}}]),n}(Se.Diag.Angle),Se.Diag.L=function(e){de(n,e);var t=ve(n);function n(){return we(this,n),t.call(this)}return fe(n,[{key:"turn",value:function(e){return"^"===e?new Se.Diag.D:new Se.Diag.U}},{key:"symbol",get:function(){return"l"}},{key:"ang",get:function(){return Math.PI}}]),n}(Se.Diag.Angle),Se.Diag.R=function(e){de(n,e);var t=ve(n);function n(){return we(this,n),t.call(this)}return fe(n,[{key:"turn",value:function(e){return"^"===e?new Se.Diag.U:new Se.Diag.D}},{key:"symbol",get:function(){return"r"}},{key:"ang",get:function(){return 0}}]),n}(Se.Diag.Angle),Se.Diag.D=function(e){de(n,e);var t=ve(n);function n(){return we(this,n),t.call(this)}return fe(n,[{key:"turn",value:function(e){return"^"===e?new Se.Diag.R:new Se.Diag.L}},{key:"symbol",get:function(){return"d"}},{key:"ang",get:function(){return-Math.PI/2}}]),n}(Se.Diag.Angle),Se.Diag.U=function(e){de(n,e);var t=ve(n);function n(){return we(this,n),t.call(this)}return fe(n,[{key:"turn",value:function(e){return"^"===e?new Se.Diag.L:new Se.Diag.R}},{key:"symbol",get:function(){return"u"}},{key:"ang",get:function(){return Math.PI/2}}]),n}(Se.Diag.Angle),Se.ObjectBox.Frame=function(e){de(n,e);var t=ve(n);function n(e,r){var a;return we(this,n),(a=t.call(this)).radius=e,a.main=r,a}return fe(n,[{key:"toString",value:function(){return"\\frm"+this.radius+"{"+this.main+"}"}}]),n}(Se.ObjectBox),Se.ObjectBox.Frame.Radius=function e(){we(this,e)},Se.ObjectBox.Frame.Radius.Vector=function(){function e(t){we(this,e),this.vector=t}return fe(e,[{key:"toString",value:function(){return this.vector.toString()}}]),e}(),Se.ObjectBox.Frame.Radius.Default=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return""}}]),e}(),Se.Decor=function(){function e(t){we(this,e),this.commands=t}return fe(e,[{key:"toString",value:function(){return this.commands.mkString(" ")}}]),e}(),(Se.Command=function e(){we(this,e)}).Save=function(){function e(t){we(this,e),this.pos=t}return fe(e,[{key:"toString",value:function(){return"\\save "+this.pos}}]),e}(),Se.Command.Restore=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"\\restore"}}]),e}(),Se.Command.Pos=function(){function e(t){we(this,e),this.pos=t}return fe(e,[{key:"toString",value:function(){return"\\POS "+this.pos}}]),e}(),Se.Command.AfterPos=function(){function e(t,n){we(this,e),this.decor=t,this.pos=n}return fe(e,[{key:"toString",value:function(){return"\\afterPOS{"+this.decor+"} "+this.pos}}]),e}(),Se.Command.Drop=function(){function e(t){we(this,e),this.object=t}return fe(e,[{key:"toString",value:function(){return"\\drop "+this.object}}]),e}(),Se.Command.Connect=function(){function e(t){we(this,e),this.object=t}return fe(e,[{key:"toString",value:function(){return"\\connect "+this.object}}]),e}(),Se.Command.Relax=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"\\relax"}}]),e}(),Se.Command.Ignore=function(){function e(t,n){we(this,e),this.pos=t,this.decor=n}return fe(e,[{key:"toString",value:function(){return"\\ignore{"+this.pos+" "+this.decor+"}"}}]),e}(),Se.Command.ShowAST=function(){function e(t,n){we(this,e),this.pos=t,this.decor=n}return fe(e,[{key:"toString",value:function(){return"\\xyshowAST{"+this.pos+" "+this.decor+"}"}}]),e}(),Se.Command.Path=function(){function e(t){we(this,e),this.path=t}return fe(e,[{key:"toString",value:function(){return"\\PATH "+this.path}}]),e}(),Se.Command.AfterPath=function(){function e(t,n){we(this,e),this.decor=t,this.path=n}return fe(e,[{key:"toString",value:function(){return"\\afterPATH{"+this.decor+"} "+this.path}}]),e}(),Se.Command.Path.Path=function(){function e(t){we(this,e),this.pathElements=t}return fe(e,[{key:"toString",value:function(){return this.pathElements.mkString("[",", ","]")}}]),e}(),Se.Command.Path.SetBeforeAction=function(){function e(t){we(this,e),this.posDecor=t}return fe(e,[{key:"toString",value:function(){return"~={"+this.posDecor+"}"}}]),e}(),Se.Command.Path.SetAfterAction=function(){function e(t){we(this,e),this.posDecor=t}return fe(e,[{key:"toString",value:function(){return"~/{"+this.posDecor+"}"}}]),e}(),Se.Command.Path.AddLabelNextSegmentOnly=function(){function e(t){we(this,e),this.labels=t}return fe(e,[{key:"toString",value:function(){return"~<{"+this.labels+"}"}}]),e}(),Se.Command.Path.AddLabelLastSegmentOnly=function(){function e(t){we(this,e),this.labels=t}return fe(e,[{key:"toString",value:function(){return"~>{"+this.labels+"}"}}]),e}(),Se.Command.Path.AddLabelEverySegment=function(){function e(t){we(this,e),this.labels=t}return fe(e,[{key:"toString",value:function(){return"~+{"+this.labels+"}"}}]),e}(),Se.Command.Path.StraightSegment=function(){function e(t){we(this,e),this.segment=t}return fe(e,[{key:"toString",value:function(){return"'"+this.segment}}]),e}(),Se.Command.Path.TurningSegment=function(){function e(t,n){we(this,e),this.turn=t,this.segment=n}return fe(e,[{key:"toString",value:function(){return"`"+this.turn+" "+this.segment}}]),e}(),Se.Command.Path.LastSegment=function(){function e(t){we(this,e),this.segment=t}return fe(e,[{key:"toString",value:function(){return this.segment.toString()}}]),e}(),Se.Command.Path.Turn=function e(){we(this,e)},Se.Command.Path.Turn.Diag=function(){function e(t,n){we(this,e),this.diag=t,this.radius=n}return fe(e,[{key:"toString",value:function(){return this.diag.toString()+" "+this.radius}}]),e}(),Se.Command.Path.Turn.Cir=function(){function e(t,n){we(this,e),this.cir=t,this.radius=n}return fe(e,[{key:"toString",value:function(){return this.cir.toString()+" "+this.radius}}]),e}(),Se.Command.Path.TurnRadius=function e(){we(this,e)},Se.Command.Path.TurnRadius.Default=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return""}}]),e}(),Se.Command.Path.TurnRadius.Dimen=function(){function e(t){we(this,e),this.dimen=t}return fe(e,[{key:"toString",value:function(){return"/"+this.dimen}}]),e}(),Se.Command.Path.Segment=function(){function e(t,n,r){we(this,e),this.pos=t,this.slide=n,this.labels=r}return fe(e,[{key:"toString",value:function(){return this.pos.toString()+" "+this.slide+" "+this.labels}}]),e}(),Se.Command.Path.Labels=function(){function e(t){we(this,e),this.labels=t}return fe(e,[{key:"toString",value:function(){return this.labels.mkString(" ")}}]),e}(),Se.Command.Path.Label=function e(t,n,r){we(this,e),this.anchor=t,this.it=n,this.aliasOption=r},Se.Command.Path.Label.Above=function(e){de(n,e);var t=ve(n);function n(e,r,a){return we(this,n),t.call(this,e,r,a)}return fe(n,[{key:"toString",value:function(){return"^("+this.anchor+" "+this.it+" "+this.aliasOption+")"}}]),n}(Se.Command.Path.Label),Se.Command.Path.Label.Below=function(e){de(n,e);var t=ve(n);function n(e,r,a){return we(this,n),t.call(this,e,r,a)}return fe(n,[{key:"toString",value:function(){return"_("+this.anchor+" "+this.it+" "+this.aliasOption+")"}}]),n}(Se.Command.Path.Label),Se.Command.Path.Label.At=function(e){de(n,e);var t=ve(n);function n(e,r,a){return we(this,n),t.call(this,e,r,a)}return fe(n,[{key:"toString",value:function(){return"|("+this.anchor+" "+this.it+" "+this.aliasOption+")"}}]),n}(Se.Command.Path.Label),Se.Command.Ar=function(){function e(t,n){we(this,e),this.forms=t,this.path=n}return fe(e,[{key:"toString",value:function(){return"\\ar "+this.forms.mkString(" ")+" "+this.path}}]),e}(),Se.Command.Ar.Form=function e(){we(this,e)},Se.Command.Ar.Form.BuildArrow=function(e){de(n,e);var t=ve(n);function n(e,r,a,i){var o;return we(this,n),(o=t.call(this)).variant=e,o.tailTip=r,o.stemConn=a,o.headTip=i,o}return fe(n,[{key:"toString",value:function(){return"@"+this.variant+"{"+this.tailTip.toString()+", "+this.stemConn.toString()+", "+this.headTip.toString()+"}"}}]),n}(Se.Command.Ar.Form),Se.Command.Ar.Form.ChangeVariant=function(e){de(n,e);var t=ve(n);function n(e){var r;return we(this,n),(r=t.call(this)).variant=e,r}return fe(n,[{key:"toString",value:function(){return"@"+this.variant}}]),n}(Se.Command.Ar.Form),Se.Command.Ar.Form.Tip=function e(){we(this,e)},Se.Command.Ar.Form.Tip.Tipchars=function(){function e(t){we(this,e),this.tipchars=t}return fe(e,[{key:"toString",value:function(){return this.tipchars}}]),e}(),Se.Command.Ar.Form.Tip.Object=function(){function e(t){we(this,e),this.object=t}return fe(e,[{key:"toString",value:function(){return"*"+this.object}}]),e}(),Se.Command.Ar.Form.Tip.Dir=function(){function e(t){we(this,e),this.dir=t}return fe(e,[{key:"toString",value:function(){return this.dir}}]),e}(),Se.Command.Ar.Form.Conn=function e(){we(this,e)},Se.Command.Ar.Form.Conn.Connchars=function(){function e(t){we(this,e),this.connchars=t}return fe(e,[{key:"toString",value:function(){return this.connchars}}]),e}(),Se.Command.Ar.Form.Conn.Object=function(){function e(t){we(this,e),this.object=t}return fe(e,[{key:"toString",value:function(){return"*"+this.object}}]),e}(),Se.Command.Ar.Form.Conn.Dir=function(){function e(t){we(this,e),this.dir=t}return fe(e,[{key:"toString",value:function(){return this.dir}}]),e}(),Se.Command.Ar.Form.ChangeStem=function(){function e(t){we(this,e),this.connchar=t}return fe(e,[{key:"toString",value:function(){return"@"+this.connchar}}]),e}(),Se.Command.Ar.Form.DashArrowStem=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"@!"}}]),e}(),Se.Command.Ar.Form.CurveArrow=function(){function e(t,n){we(this,e),this.direction=t,this.dist=n}return fe(e,[{key:"toString",value:function(){return"@/"+this.direction+" "+this.dist+"/"}}]),e}(),Se.Command.Ar.Form.CurveFitToDirection=function(){function e(t,n){we(this,e),this.outDirection=t,this.inDirection=n}return fe(e,[{key:"toString",value:function(){return"@("+this.outDirection+","+this.inDirection+")"}}]),e}(),Se.Command.Ar.Form.CurveWithControlPoints=function(){function e(t){we(this,e),this.coord=t}return fe(e,[{key:"toString",value:function(){return"@`{"+this.coord+"}"}}]),e}(),Se.Command.Ar.Form.AddShape=function(){function e(t){we(this,e),this.shape=t}return fe(e,[{key:"toString",value:function(){return"@["+this.shape+"]"}}]),e}(),Se.Command.Ar.Form.AddModifiers=function(){function e(t){we(this,e),this.modifiers=t}return fe(e,[{key:"toString",value:function(){return"@*{"+this.modifiers.mkString(" ")+"}"}}]),e}(),Se.Command.Ar.Form.Slide=function(){function e(t){we(this,e),this.slideDimen=t}return fe(e,[{key:"toString",value:function(){return"@<"+this.slideDimen+">"}}]),e}(),Se.Command.Ar.Form.LabelAt=function(){function e(t,n){we(this,e),this.anchor=t,this.it=n}return fe(e,[{key:"toString",value:function(){return"|"+this.anchor+" "+this.it}}]),e}(),Se.Command.Ar.Form.LabelAbove=function(){function e(t,n){we(this,e),this.anchor=t,this.it=n}return fe(e,[{key:"toString",value:function(){return"^"+this.anchor+" "+this.it}}]),e}(),Se.Command.Ar.Form.LabelBelow=function(){function e(t,n){we(this,e),this.anchor=t,this.it=n}return fe(e,[{key:"toString",value:function(){return"_"+this.anchor+" "+this.it}}]),e}(),Se.Command.Ar.Form.ReverseAboveAndBelow=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"@?"}}]),e}(),Se.Command.Xymatrix=function(){function e(t,n){we(this,e),this.setup=t,this.rows=n}return fe(e,[{key:"toString",value:function(){return"\\xymatrix"+this.setup+"{\n"+this.rows.mkString("","\\\\\n","")+"\n}"}}]),e}(),Se.Command.Xymatrix.Setup=function e(){we(this,e)},Se.Command.Xymatrix.Setup.Prefix=function(){function e(t){we(this,e),this.prefix=t}return fe(e,[{key:"toString",value:function(){return'"'+this.prefix+'"'}}]),e}(),Se.Command.Xymatrix.Setup.ChangeSpacing=function e(t,n){we(this,e),this.addop=t,this.dimen=n},Se.Command.Xymatrix.Setup.ChangeSpacing.Row=function(e){de(n,e);var t=ve(n);function n(e,r){return we(this,n),t.call(this,e,r)}return fe(n,[{key:"toString",value:function(){return"@R"+this.addop+this.dimen}}]),n}(Se.Command.Xymatrix.Setup.ChangeSpacing),Se.Command.Xymatrix.Setup.ChangeSpacing.Column=function(e){de(n,e);var t=ve(n);function n(e,r){return we(this,n),t.call(this,e,r)}return fe(n,[{key:"toString",value:function(){return"@C"+this.addop+this.dimen}}]),n}(Se.Command.Xymatrix.Setup.ChangeSpacing),Se.Command.Xymatrix.Setup.ChangeSpacing.RowAndColumn=function(e){de(n,e);var t=ve(n);function n(e,r){return we(this,n),t.call(this,e,r)}return fe(n,[{key:"toString",value:function(){return"@"+this.addop+this.dimen}}]),n}(Se.Command.Xymatrix.Setup.ChangeSpacing),Se.Command.Xymatrix.Setup.PretendEntrySize=function e(t){we(this,e),this.dimen=t},Se.Command.Xymatrix.Setup.PretendEntrySize.Height=function(e){de(n,e);var t=ve(n);function n(e){return we(this,n),t.call(this,e)}return fe(n,[{key:"toString",value:function(){return"@!R="+this.dimen}}]),n}(Se.Command.Xymatrix.Setup.PretendEntrySize),Se.Command.Xymatrix.Setup.PretendEntrySize.Width=function(e){de(n,e);var t=ve(n);function n(e){return we(this,n),t.call(this,e)}return fe(n,[{key:"toString",value:function(){return"@!C="+this.dimen}}]),n}(Se.Command.Xymatrix.Setup.PretendEntrySize),Se.Command.Xymatrix.Setup.PretendEntrySize.HeightAndWidth=function(e){de(n,e);var t=ve(n);function n(e){return we(this,n),t.call(this,e)}return fe(n,[{key:"toString",value:function(){return"@!="+this.dimen}}]),n}(Se.Command.Xymatrix.Setup.PretendEntrySize),Se.Command.Xymatrix.Setup.FixGrid=function e(){we(this,e)},Se.Command.Xymatrix.Setup.FixGrid.Row=function(e){de(n,e);var t=ve(n);function n(){return we(this,n),t.call(this)}return fe(n,[{key:"toString",value:function(){return"@!R"}}]),n}(Se.Command.Xymatrix.Setup.FixGrid),Se.Command.Xymatrix.Setup.FixGrid.Column=function(e){de(n,e);var t=ve(n);function n(){return we(this,n),t.call(this)}return fe(n,[{key:"toString",value:function(){return"@!C"}}]),n}(Se.Command.Xymatrix.Setup.FixGrid),Se.Command.Xymatrix.Setup.FixGrid.RowAndColumn=function(e){de(n,e);var t=ve(n);function n(){return we(this,n),t.call(this)}return fe(n,[{key:"toString",value:function(){return"@!"}}]),n}(Se.Command.Xymatrix.Setup.FixGrid),Se.Command.Xymatrix.Setup.AdjustEntrySize=function e(t,n){we(this,e),this.addop=t,this.dimen=n},Se.Command.Xymatrix.Setup.AdjustEntrySize.Margin=function(e){de(n,e);var t=ve(n);function n(e,r){return we(this,n),t.call(this,e,r)}return fe(n,[{key:"toString",value:function(){return"@M"+this.addop+this.dimen}}]),n}(Se.Command.Xymatrix.Setup.AdjustEntrySize),Se.Command.Xymatrix.Setup.AdjustEntrySize.Width=function(e){de(n,e);var t=ve(n);function n(e,r){return we(this,n),t.call(this,e,r)}return fe(n,[{key:"toString",value:function(){return"@W"+this.addop+this.dimen}}]),n}(Se.Command.Xymatrix.Setup.AdjustEntrySize),Se.Command.Xymatrix.Setup.AdjustEntrySize.Height=function(e){de(n,e);var t=ve(n);function n(e,r){return we(this,n),t.call(this,e,r)}return fe(n,[{key:"toString",value:function(){return"@H"+this.addop+this.dimen}}]),n}(Se.Command.Xymatrix.Setup.AdjustEntrySize),Se.Command.Xymatrix.Setup.AdjustLabelSep=function(){function e(t,n){we(this,e),this.addop=t,this.dimen=n}return fe(e,[{key:"toString",value:function(){return"@L"+this.addop+this.dimen}}]),e}(),Se.Command.Xymatrix.Setup.SetOrientation=function(){function e(t){we(this,e),this.direction=t}return fe(e,[{key:"toString",value:function(){return"@"+this.direction}}]),e}(),Se.Command.Xymatrix.Setup.AddModifier=function(){function e(t){we(this,e),this.modifier=t}return fe(e,[{key:"toString",value:function(){return"@*"+this.modifier}}]),e}(),Se.Command.Xymatrix.Row=function(){function e(t){we(this,e),this.entries=t}return fe(e,[{key:"toString",value:function(){return this.entries.mkString(" & ")}}]),e}(),Se.Command.Xymatrix.Entry=function e(){we(this,e)},Se.Command.Xymatrix.Entry.SimpleEntry=function(e){de(n,e);var t=ve(n);function n(e,r,a){var i;return we(this,n),(i=t.call(this)).modifiers=e,i.objectbox=r,i.decor=a,i}return fe(n,[{key:"toString",value:function(){return this.modifiers.mkString("**{","","}")+" "+this.objectbox+" "+this.decor}},{key:"isEmpty",get:function(){return!1}}]),n}(Se.Command.Xymatrix.Entry),Se.Command.Xymatrix.Entry.ObjectEntry=function(e){de(n,e);var t=ve(n);function n(e,r,a){var i;return we(this,n),(i=t.call(this)).object=e,i.pos=r,i.decor=a,i}return fe(n,[{key:"toString",value:function(){return"*"+this.object+" "+this.pos+" "+this.decor}},{key:"isEmpty",get:function(){return!1}}]),n}(Se.Command.Xymatrix.Entry),Se.Command.Xymatrix.Entry.EmptyEntry=function(e){de(n,e);var t=ve(n);function n(e){var r;return we(this,n),(r=t.call(this)).decor=e,r}return fe(n,[{key:"toString",value:function(){return""+this.decor}},{key:"isEmpty",get:function(){return!0}}]),n}(Se.Command.Xymatrix.Entry),Se.Command.Twocell=function(){function e(t,n,r){we(this,e),this.twocell=t,this.switches=n,this.arrow=r}return fe(e,[{key:"toString",value:function(){return this.twocell.toString()+this.switches.mkString("")+this.arrow}}]),e}(),Se.Command.Twocell.Hops2cell=function e(t,n){we(this,e),this.hops=t,this.maybeDisplace=n},Se.Command.Twocell.Twocell=function(e){de(n,e);var t=ve(n);function n(e,r){return we(this,n),t.call(this,e,r)}return fe(n,[{key:"toString",value:function(){return"\\xtwocell["+this.hops+"]"+this.maybeDisplace.getOrElse("{}")}}]),n}(Se.Command.Twocell.Hops2cell),Se.Command.Twocell.UpperTwocell=function(e){de(n,e);var t=ve(n);function n(e,r){return we(this,n),t.call(this,e,r)}return fe(n,[{key:"toString",value:function(){return"\\xuppertwocell["+this.hops+"]"+this.maybeDisplace.getOrElse("{}")}}]),n}(Se.Command.Twocell.Hops2cell),Se.Command.Twocell.LowerTwocell=function(e){de(n,e);var t=ve(n);function n(e,r){return we(this,n),t.call(this,e,r)}return fe(n,[{key:"toString",value:function(){return"\\xlowertwocell["+this.hops+"]"+this.maybeDisplace.getOrElse("{}")}}]),n}(Se.Command.Twocell.Hops2cell),Se.Command.Twocell.CompositeMap=function(e){de(n,e);var t=ve(n);function n(e,r){return we(this,n),t.call(this,e,r)}return fe(n,[{key:"toString",value:function(){return"\\xcompositemap["+this.hops+"]"+this.maybeDisplace.getOrElse("{}")}}]),n}(Se.Command.Twocell.Hops2cell),Se.Command.Twocell.Switch=function e(){we(this,e)},Se.Command.Twocell.Switch.UpperLabel=function(){function e(t){we(this,e),this.label=t}return fe(e,[{key:"toString",value:function(){return"^"+this.label}}]),e}(),Se.Command.Twocell.Switch.LowerLabel=function(){function e(t){we(this,e),this.label=t}return fe(e,[{key:"toString",value:function(){return"_"+this.label}}]),e}(),Se.Command.Twocell.Switch.SetCurvature=function(){function e(t){we(this,e),this.nudge=t}return fe(e,[{key:"toString",value:function(){return this.nudge.toString()}}]),e}(),Se.Command.Twocell.Switch.DoNotSetCurvedArrows=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"\\omit"}}]),e}(),Se.Command.Twocell.Switch.PlaceModMapObject=function(){function e(){we(this,e)}return fe(e,[{key:"toString",value:function(){return"~!"}}]),e}(),Se.Command.Twocell.Switch.ChangeHeadTailObject=function(){function e(t,n){we(this,e),this.what=t,this.object=n}return fe(e,[{key:"toString",value:function(){return"~"+this.what+"{"+this.object+"}"}}]),e}(),Se.Command.Twocell.Switch.ChangeCurveObject=function(){function e(t,n,r){we(this,e),this.what=t,this.spacer=n,this.maybeObject=r}return fe(e,[{key:"toString",value:function(){return"~"+this.what+"{"+this.spacer+(this.maybeObject.isDefined?"~**"+this.maybeObject.get:"")+"}"}}]),e}(),Se.Command.Twocell.Label=function(){function e(t,n){we(this,e),this.maybeNudge=t,this.labelObject=n}return fe(e,[{key:"toString",value:function(){return this.maybeNudge.toString()+this.labelObject}}]),e}(),Se.Command.Twocell.Nudge=function e(){we(this,e)},Se.Command.Twocell.Nudge.Number=function(e){de(n,e);var t=ve(n);function n(e){var r;return we(this,n),(r=t.call(this)).number=e,r}return fe(n,[{key:"toString",value:function(){return"<"+this.number+">"}}]),n}(Se.Command.Twocell.Nudge),Se.Command.Twocell.Nudge.Omit=function(e){de(n,e);var t=ve(n);function n(){return we(this,n),t.call(this)}return fe(n,[{key:"toString",value:function(){return"<\\omit>"}}]),n}(Se.Command.Twocell.Nudge),Se.Command.Twocell.Arrow=function e(){we(this,e)},Se.Command.Twocell.Arrow.WithOrientation=function(e){de(n,e);var t=ve(n);function n(e,r){var a;return we(this,n),(a=t.call(this)).tok=e,a.labelObject=r,a}return fe(n,[{key:"toString",value:function(){return"{["+this.tok+"] "+this.labelObject+"}"}}]),n}(Se.Command.Twocell.Arrow),Se.Command.Twocell.Arrow.WithPosition=function(e){de(n,e);var t=ve(n);function n(e,r){var a;return we(this,n),(a=t.call(this)).nudge=e,a.labelObject=r,a}return fe(n,[{key:"toString",value:function(){return"{["+this.nudge+"] "+this.labelObject+"}"}}]),n}(Se.Command.Twocell.Arrow),Se.Command.Newdir=function(){function e(t,n){we(this,e),this.dirMain=t,this.compositeObject=n}return fe(e,[{key:"toString",value:function(){return"\\newdir{"+this.dirMain+"}{"+this.compositeObject+"}"}}]),e}(),Se.Pos.Xyimport=function e(){we(this,e)},Se.Pos.Xyimport.TeXCommand=function(e){de(n,e);var t=ve(n);function n(e,r,a,i,o){var u;return we(this,n),(u=t.call(this)).width=e,u.height=r,u.xOffset=a,u.yOffset=i,u.graphics=o,u}return fe(n,[{key:"toString",value:function(){return"\\xyimport("+this.width+", "+this.height+")("+this.xOffset+", "+this.yOffset+"){"+this.graphics+"}"}}]),n}(Se.Pos.Xyimport),Se.Pos.Xyimport.Graphics=function(e){de(n,e);var t=ve(n);function n(e,r,a,i,o){var u;return we(this,n),(u=t.call(this)).width=e,u.height=r,u.xOffset=a,u.yOffset=i,u.graphics=o,u}return fe(n,[{key:"toString",value:function(){return"\\xyimport("+this.width+", "+this.height+")("+this.xOffset+", "+this.yOffset+"){"+this.graphics+"}"}}]),n}(Se.Pos.Xyimport),Se.Command.Includegraphics=function(){function e(t,n,r){we(this,e),this.isClipped=t,this.attributeList=n,this.filepath=r}return fe(e,[{key:"toString",value:function(){return"\\includegraphics"+(this.isClipped?"*":"")+this.attributeList.mkString("[",",","]")+"{"+this.filepath+"}"}},{key:"isIncludegraphics",get:function(){return!0}}]),e}(),Se.Command.Includegraphics.Attr=function e(){we(this,e)},Se.Command.Includegraphics.Attr.Width=function(e){de(n,e);var t=ve(n);function n(e){var r;return we(this,n),(r=t.call(this)).dimen=e,r}return fe(n,[{key:"toString",value:function(){return"width="+this.dimen}}]),n}(Se.Command.Includegraphics.Attr),Se.Command.Includegraphics.Attr.Height=function(e){de(n,e);var t=ve(n);function n(e){var r;return we(this,n),(r=t.call(this)).dimen=e,r}return fe(n,[{key:"toString",value:function(){return"height="+this.dimen}}]),n}(Se.Command.Includegraphics.Attr);var Ce=ae.fun,ke=ae.elem,Je=function(e){return Ce(ae.elem(e))},Pe=ae.literal,Oe=ae.regex,Be=ae.regexLiteral,Ee=function(e){return Ce(ae.literal(e))},Ae=ae.seq,Le=ae.or,je=function(e){return ae.lazyParser(e)().rep()},De=function(e){return ae.lazyParser(e)().rep1()},Te=function(e){return ae.lazyParser(e)().opt()},Re=ae.success,Fe=function(e){return function(){var t=e.memo;return void 0===t&&(t=e.memo=e()),t}},Ge=new ae,Ve={xy:Fe((function(){return Ge.posDecor().to((function(e){return e}))})),xybox:Fe((function(){return Pe("{").andr(Ge.posDecor).andl(Ee("}")).to((function(e){return e}))})),xymatrixbox:Fe((function(){return Ge.xymatrix().to((function(e){return new Se.PosDecor(new Se.Pos.Coord(new Se.Coord.C,F.empty),new Se.Decor(F.empty.append(e)))}))})),posDecor:Fe((function(){return Ae(Ge.pos,Ge.decor).to((function(e){return new Se.PosDecor(e.head,e.tail)}))})),pos:Fe((function(){return Ae(Ge.coord,je(Ge.pos2)).to((function(e){return new Se.Pos.Coord(e.head,e.tail)}))})),nonemptyPos:Fe((function(){return Le(Ae(Ge.nonemptyCoord,je(Ge.pos2)),Ae(Ge.coord,De(Ge.pos2))).to((function(e){return new Se.Pos.Coord(e.head,e.tail)}))})),pos2:Fe((function(){return Le(Pe("+").andr(Ge.coord).to((function(e){return new Se.Pos.Plus(e)})),Pe("-").andr(Ge.coord).to((function(e){return new Se.Pos.Minus(e)})),Pe("!").andr(Ge.coord).to((function(e){return new Se.Pos.Skew(e)})),Pe(".").andr(Ge.coord).to((function(e){return new Se.Pos.Cover(e)})),Pe(",").andr(Ge.coord).to((function(e){return new Se.Pos.Then(e)})),Pe(";").andr(Ge.coord).to((function(e){return new Se.Pos.SwapPAndC(e)})),Pe("::").andr(Ge.coord).to((function(e){return new Se.Pos.SetYBase(e)})),Pe(":").andr(Ge.coord).to((function(e){return new Se.Pos.SetBase(e)})),Pe("**").andr(Ge.object).to((function(e){return new Se.Pos.ConnectObject(e)})),Pe("*").andr(Ge.object).to((function(e){return new Se.Pos.DropObject(e)})),Pe("?").andr(Ge.place).to((function(e){return new Se.Pos.Place(e)})),Pe("@+").andr(Ge.coord).to((function(e){return new Se.Pos.PushCoord(e)})),Pe("@-").andr(Ge.coord).to((function(e){return new Se.Pos.EvalCoordThenPop(e)})),Pe("@=").andr(Ge.coord).to((function(e){return new Se.Pos.LoadStack(e)})),Pe("@@").andr(Ge.coord).to((function(e){return new Se.Pos.DoCoord(e)})),Pe("@i").to((function(){return new Se.Pos.InitStack})),Pe("@(").to((function(){return new Se.Pos.EnterFrame})),Pe("@)").to((function(){return new Se.Pos.LeaveFrame})),Pe("=:").andr(Ee('"')).andr(Ge.id).andl(Je('"')).to((function(e){return new Se.Pos.SaveBase(e)})),Pe("=@").andr(Ee('"')).andr(Ge.id).andl(Je('"')).to((function(e){return new Se.Pos.SaveStack(e)})),Pe("=").andr(Ee('"')).andr(Ge.id).andl(Je('"')).to((function(e){return new Se.Pos.SavePos(e)})),Pe("=").andr(Ge.nonemptyCoord).andl(Ee('"')).and(Ge.id).andl(Je('"')).to((function(e){return new Se.Pos.SaveMacro(e.head,e.tail)})),Ge.xyimport)})),coord:Fe((function(){return Le(Ge.nonemptyCoord,Re("empty").to((function(){return new Se.Coord.C})))})),nonemptyCoord:Fe((function(){return Le(Pe("c").to((function(){return new Se.Coord.C})),Pe("p").to((function(){return new Se.Coord.P})),Pe("x").to((function(){return new Se.Coord.X})),Pe("y").to((function(){return new Se.Coord.Y})),Ge.vector().to((function(e){return new Se.Coord.Vector(e)})),Pe('"').andr(Ge.id).andl(Je('"')).to((function(e){return new Se.Coord.Id(e)})),Pe("{").andr(Ge.posDecor).andl(Ee("}")).to((function(e){return new Se.Coord.Group(e)})),Pe("s").andr(Ce(Be(/^\d/))).to((function(e){return new Se.Coord.StackPosition(parseInt(e))})),Pe("s").andr(Ee("{")).and(Ge.nonnegativeNumber).andl(Ee("}")).to((function(e){return new Se.Coord.StackPosition(e)})),Pe("[").andr(Ce(Te(Pe('"').andr(Ge.id).andl(Je('"'))).to((function(e){return e.getOrElse("")})))).and(Ge.number).andl(Ee(",")).and(Ge.number).andl(Ee("]")).to((function(e){return new Se.Coord.DeltaRowColumn(e.head.head,e.head.tail,e.tail)})),Pe("[").andr(Ce(Te(Pe('"').andr(Ge.id).andl(Je('"'))).to((function(e){return e.getOrElse("")})))).and(Ce(je(Oe(/^[lrud]/)))).andl(Ee("]")).to((function(e){return new Se.Coord.Hops(e.head,e.tail)})),Pe("[").andr(Ce(Te(Pe('"').andr(Ge.id).andl(Je('"'))).to((function(e){return e.getOrElse("")})))).and(Ce(De(Oe(/^[lrud]/)))).and(Ge.place).andl(Ee("]")).to((function(e){return new Se.Coord.DeltaRowColumn(e.head.head,e.head.tail,new Se.Pos.Place(e.tail))})))})),vector:Fe((function(){return Le(Pe("(").andr(Ge.factor).andl(Ee(",")).and(Ge.factor).andl(Ee(")")).to((function(e){return new Se.Vector.InCurBase(e.head,e.tail)})),Pe("<").andr(Ge.dimen).andl(Ee(",")).and(Ge.dimen).andl(Ee(">")).to((function(e){return new Se.Vector.Abs(e.head,e.tail)})),Pe("<").andr(Ge.dimen).andl(Ee(">")).to((function(e){return new Se.Vector.Abs(e,e)})),Pe("a").andr(Ee("(")).andr(Ge.number).andl(Ee(")")).to((function(e){return new Se.Vector.Angle(e)})),Pe("/").andr(Ge.direction).and(Ge.looseDimen).andl(Ee("/")).to((function(e){return new Se.Vector.Dir(e.head,e.tail)})),Pe("0").to((function(e){return new Se.Vector.Abs("0mm","0mm")})),(function(){return Ge.corner().and(Ce(ae.opt(Ce(Pe("(").andr(Ge.factor).andl(Ee(")")))).to((function(e){return e.getOrElse(1)})))).to((function(e){return new Se.Vector.Corner(e.head,e.tail)}))}))})),corner:Fe((function(){return Le(Be(/^(CL|LC)/).to((function(){return new Se.Corner.CL})),Be(/^(CR|RC)/).to((function(){return new Se.Corner.CR})),Be(/^(CD|DC)/).to((function(){return new Se.Corner.CD})),Be(/^(CU|UC)/).to((function(){return new Se.Corner.CU})),Be(/^(LD|DL)/).to((function(){return new Se.Corner.LD})),Be(/^(RD|DR)/).to((function(){return new Se.Corner.RD})),Be(/^(LU|UL)/).to((function(){return new Se.Corner.LU})),Be(/^(RU|UR)/).to((function(){return new Se.Corner.RU})),Pe("L").to((function(){return new Se.Corner.L})),Pe("R").to((function(){return new Se.Corner.R})),Pe("D").to((function(){return new Se.Corner.D})),Pe("U").to((function(){return new Se.Corner.U})),Pe("E").to((function(){return new Se.Corner.NearestEdgePoint})),Pe("P").to((function(){return new Se.Corner.PropEdgePoint})),Pe("A").to((function(){return new Se.Corner.Axis})))})),place:Fe((function(){return Le(Pe("<").andr(Ge.place).to((function(e){return new Se.Place(1,0,void 0,void 0).compound(e)})),Pe(">").andr(Ge.place).to((function(e){return new Se.Place(0,1,void 0,void 0).compound(e)})),Pe("(").andr(Ge.factor).andl(Ee(")")).and(Ge.place).to((function(e){return new Se.Place(0,0,new Se.Place.Factor(e.head),void 0).compound(e.tail)})),Pe("!").andr(Ee("{")).andr(Ge.pos).andl(Ee("}")).and(Ge.slide).to((function(e){return new Se.Place(0,0,new Se.Place.Intercept(e.head),e.tail)})),(function(){return Ge.slide().to((function(e){return new Se.Place(0,0,void 0,e)}))}))})),slide:Fe((function(){return Le(Pe("/").andr(Ge.dimen).andl(Ee("/")).to((function(e){return new Se.Slide(new k.Some(e))})),Re("no slide").to((function(){return new Se.Slide(k.empty)})))})),factor:Fe(Ce(Be(/^[+\-]?(\d+(\.\d*)?|\d*\.\d+)/).to((function(e){return parseFloat(e)})))),number:Fe(Ce(Be(/^[+\-]?\d+/).to((function(e){return parseInt(e)})))),nonnegativeNumber:Fe(Ce(Be(/^\d+/).to((function(e){return parseInt(e)})))),unit:Fe(Ce(Be(/^(em|ex|px|pt|pc|in|cm|mm|mu)/).to((function(e){return e})))),dimen:Fe((function(){return Ge.factor().and(Ge.unit).to((function(e){return e.head.toString()+e.tail}))})),looseDimen:Fe((function(){return Ge.looseFactor().and(Ge.unit).to((function(e){return e.head.toString()+e.tail}))})),looseFactor:Fe(Ce(Le(Be(/^(\d \d*(\.\d*))/).to((function(e){return parseFloat(e.replace(/ /,""))})),Be(/^[+\-]?(\d+(\.\d*)?|\d*\.\d+)/).to((function(e){return parseFloat(e)}))))),id:Fe(Ce(Oe(/^[^"]+/))),object:Fe((function(){return Le(je(Ge.modifier).and(Ge.objectbox).to((function(e){return new Se.Object(e.head,e.tail)})))})),objectbox:Fe((function(){return Le(Ge.mathText,Pe("@").andr(Ge.dir),Pe("\\dir").andr(Ge.dir),Pe("\\cir").andr(Ge.cirRadius).andl(Ee("{")).and(Ge.cir).andl(Ee("}")).to((function(e){return new Se.ObjectBox.Cir(e.head,e.tail)})),Pe("\\frm").andr(Ge.frameRadius).andl(Ee("{")).and(Ge.frameMain).andl(Ee("}")).to((function(e){return new Se.ObjectBox.Frame(e.head,e.tail)})),Pe("\\object").andr(Ge.object).to((function(e){return new Se.ObjectBox.WrapUpObject(e)})),Pe("\\composite").and(Ee("{")).andr(Ge.compositeObject).andl(Ee("}")).to((function(e){return new Se.ObjectBox.CompositeObject(e)})),Pe("\\xybox").and(Ee("{")).andr(Ge.posDecor).andl(Ee("}")).to((function(e){return new Se.ObjectBox.Xybox(e)})),Pe("\\xymatrix").andr(Ge.xymatrix).to((function(e){return new Se.ObjectBox.Xymatrix(e)})),Ge.txt,Ge.curve,Oe(/^(\\[a-zA-Z@][a-zA-Z0-9@]+)/).andl(Ee("{")).and(Ge.text).andl(Ee("}")).and(Ge.textNodeCreator).to((function(e){var t=e.head,n=e.tail;return Ge.toMath(t.head+"{"+t.tail+"}",n)})))})),compositeObject:Fe((function(){return Ge.object().and(Ce(je(Pe("*").andr(Ge.object)))).to((function(e){return e.tail.prepend(e.head)}))})),mathText:Fe((function(){return Pe("{").andr(Ge.text).andl(Je("}")).and(Ge.textNodeCreator).to((function(e){var t=e.head,n=e.tail;return Ge.toMath("\\hbox{$\\objectstyle{"+t+"}$}",n)}))})),toMath:function(e,t){var n=t(e);return new Se.ObjectBox.Text(n)},textNodeCreator:Fe((function(){return new ae.Parser((function(e){return new ae.Success(e.context.createTextNode,e)}))})),text:Fe((function(){return Oe(/^[^{}\\%]*/).and((function(){return Le(Oe(/^(\\\{|\\\}|\\%|\\)/).to((function(e){return e})),ke("{").andr(Ge.text).andl(Je("}")).to((function(e){return"{"+e+"}"})),Oe(/^%[^\r\n]*(\r\n|\r|\n)?/).to((function(e){return" "}))).and(Ce(Oe(/^[^{}\\%]*/))).rep().to((function(e){var t="";return e.foreach((function(e){t+=e.head+e.tail})),t}))})).to((function(e){return e.head+e.tail}))})),txt:Fe((function(){return Pe("\\txt").andr(Ge.txtWidth).and(Ce(Oe(/^(\\[a-zA-Z@][a-zA-Z0-9@]+)?/))).andl(Ee("{")).and(Ge.text).andl(Ee("}")).and(Ge.textNodeCreator).to((function(e){var t,n=e.head,r=e.tail,a=n.head.head,i=n.head.tail,o=n.tail,u=o.split("\\\\");if(u.length<=1)t=i+"{\\hbox{"+o+"}}";else{t="\\hbox{$\\begin{array}{c}\n";for(var c=0;c<u.length;c++)t+=i+"{\\hbox{"+u[c].replace(/(^[\r\n\s]+)|([\r\n\s]+$)/g,"")+"}}",c!=u.length-1&&(t+="\\\\\n");t+="\\end{array}$}"}return new Se.ObjectBox.Txt(a,Ge.toMath(t,r))}))})),txtWidth:Fe((function(){return Le(Pe("<").andr(Ge.dimen).andl(Ee(">")).to((function(e){return new Se.Vector.Abs(e,e)})).to((function(e){return new Se.ObjectBox.Txt.Width.Vector(e)})),Re("default").to((function(){return new Se.ObjectBox.Txt.Width.Default})))})),dir:Fe((function(){return Be(/^[\^_0123]/).opt().andl(Ee("{")).and(Ge.dirMain).andl(Ee("}")).to((function(e){return new Se.ObjectBox.Dir(e.head.getOrElse(""),e.tail)}))})),dirMain:Fe((function(){return Oe(/^(-|\.|~|>|<|\(|\)|`|'|\||\*|\+|x|\/|o|=|:|[a-zA-Z@ ])+/).opt().to((function(e){return e.getOrElse("")}))})),cirRadius:Fe((function(){return Le(Ge.vector().to((function(e){return new Se.ObjectBox.Cir.Radius.Vector(e)})),Re("default").to((function(){return new Se.ObjectBox.Cir.Radius.Default})))})),frameRadius:Fe((function(){return Le(Ge.frameRadiusVector().to((function(e){return new Se.ObjectBox.Frame.Radius.Vector(e)})),Re("default").to((function(){return new Se.ObjectBox.Frame.Radius.Default})))})),frameRadiusVector:Fe((function(){return Le(Pe("<").andr(Ge.dimen).andl(Ee(",")).and(Ge.dimen).andl(Ee(">")).to((function(e){return new Se.Vector.Abs(e.head,e.tail)})),Pe("<").andr(Ge.dimen).andl(Ee(">")).to((function(e){return new Se.Vector.Abs(e,e)})))})),frameMain:Fe((function(){return Oe(/^(((_|\^)?(\\\{|\\\}|\(|\)))|[\-=oe,\.\*]*)/)})),cir:Fe((function(){return Le(Ge.nonemptyCir,Re("full").to((function(){return new Se.ObjectBox.Cir.Cir.Full})))})),nonemptyCir:Fe((function(){return Ge.diag().and(Ce(Be(/^[_\^]/))).and(Ge.diag).to((function(e){return new Se.ObjectBox.Cir.Cir.Segment(e.head.head,e.head.tail,e.tail)}))})),curve:Fe((function(){return Pe("\\crv").andr(Ge.curveModifier).andl(Ee("{")).and(Ge.curveObject).and(Ge.curvePoslist).andl(Ee("}")).to((function(e){return new Se.ObjectBox.Curve(e.head.head,e.head.tail,e.tail)}))})),curveModifier:Fe((function(){return je(Ce(Pe("~").andr(Ge.curveOption)))})),curveOption:Fe((function(){return Le(Pe("p").to((function(){return new Se.ObjectBox.Curve.Modifier.p})),Pe("P").to((function(){return new Se.ObjectBox.Curve.Modifier.P})),Pe("l").to((function(){return new Se.ObjectBox.Curve.Modifier.l})),Pe("L").to((function(){return new Se.ObjectBox.Curve.Modifier.L})),Pe("c").to((function(){return new Se.ObjectBox.Curve.Modifier.c})),Pe("C").to((function(){return new Se.ObjectBox.Curve.Modifier.C})),Pe("pc").to((function(){return new Se.ObjectBox.Curve.Modifier.pc})),Pe("pC").to((function(){return new Se.ObjectBox.Curve.Modifier.pC})),Pe("Pc").to((function(){return new Se.ObjectBox.Curve.Modifier.Pc})),Pe("PC").to((function(){return new Se.ObjectBox.Curve.Modifier.PC})),Pe("lc").to((function(){return new Se.ObjectBox.Curve.Modifier.lc})),Pe("lC").to((function(){return new Se.ObjectBox.Curve.Modifier.lC})),Pe("Lc").to((function(){return new Se.ObjectBox.Curve.Modifier.Lc})),Pe("LC").to((function(){return new Se.ObjectBox.Curve.Modifier.LC})),Pe("cC").to((function(){return new Se.ObjectBox.Curve.Modifier.cC})))})),curveObject:Fe((function(){return je(Le(Pe("~*").andr(Ge.object).to((function(e){return new Se.ObjectBox.Curve.Object.Drop(e)})),Pe("~**").andr(Ge.object).to((function(e){return new Se.ObjectBox.Curve.Object.Connect(e)}))))})),curvePoslist:Fe((function(){return Le(Pe("&").andr(Ge.curvePoslist2).to((function(e){return e.prepend(new Se.ObjectBox.Curve.PosList.CurPos)})),Pe("~@").andr(Ee("&")).andr(Ge.curvePoslist2).to((function(e){return e.prepend(new Se.ObjectBox.Curve.PosList.AddStack)})),Pe("~@").to((function(){return F.empty.prepend(new Se.ObjectBox.Curve.PosList.AddStack)})),Ge.pos().andl(Ee("&")).and(Ge.curvePoslist2).to((function(e){return e.tail.prepend(new Se.ObjectBox.Curve.PosList.Pos(e.head))})),Ge.nonemptyPos().to((function(e){return F.empty.prepend(new Se.ObjectBox.Curve.PosList.Pos(e))})),Re("empty").to((function(){return F.empty})))})),curvePoslist2:Fe((function(){return Le(Pe("&").andr(Ge.curvePoslist2).to((function(e){return e.prepend(new Se.ObjectBox.Curve.PosList.CurPos)})),Pe("~@").andr(Ee("&")).andr(Ge.curvePoslist2).to((function(e){return e.prepend(new Se.ObjectBox.Curve.PosList.AddStack)})),Pe("~@").to((function(){return F.empty.prepend(new Se.ObjectBox.Curve.PosList.AddStack)})),Ge.nonemptyPos().andl(Ee("&")).and(Ge.curvePoslist2).to((function(e){return e.tail.prepend(new Se.ObjectBox.Curve.PosList.Pos(e.head))})),Ge.nonemptyPos().to((function(e){return F.empty.prepend(new Se.ObjectBox.Curve.PosList.Pos(e))})),Re("empty").to((function(){return F.empty.prepend(new Se.ObjectBox.Curve.PosList.CurPos)})))})),modifier:Fe((function(){return Le(Pe("!").andr(Ge.vector).to((function(e){return new Se.Modifier.Vector(e)})),Pe("!").to((function(e){return new Se.Modifier.RestoreOriginalRefPoint})),Pe("[").andr(Ge.shape).andl(Ee("]")).to((function(e){return e})),Pe("i").to((function(e){return new Se.Modifier.Invisible})),Pe("h").to((function(e){return new Se.Modifier.Hidden})),Ge.addOp().and(Ge.size).to((function(e){return new Se.Modifier.AddOp(e.head,e.tail)})),Ge.nonemptyDirection().to((function(e){return new Se.Modifier.Direction(e)})))})),addOp:Fe((function(){return Le(Pe("+=").to((function(){return new Se.Modifier.AddOp.GrowTo})),Pe("-=").to((function(){return new Se.Modifier.AddOp.ShrinkTo})),Pe("+").to((function(){return new Se.Modifier.AddOp.Grow})),Pe("-").to((function(){return new Se.Modifier.AddOp.Shrink})),Pe("=").to((function(){return new Se.Modifier.AddOp.Set})))})),size:Fe((function(){return Le((function(){return Ge.vector().to((function(e){return new Se.Modifier.AddOp.VactorSize(e)}))}),Re("default size").to((function(){return new Se.Modifier.AddOp.DefaultSize})))})),shape:Fe((function(){return Le(Pe(".").to((function(){return new Se.Modifier.Shape.Point})),Ge.frameShape,Ge.alphabets().to((function(e){return new Se.Modifier.Shape.Alphabets(e)})),Pe("=").andr(Ge.alphabets).to((function(e){return new Se.Modifier.Shape.DefineShape(e)})),Re("rect").to((function(){return new Se.Modifier.Shape.Rect})))})),frameShape:Fe((function(){return Pe("F").andr(Ge.frameMain).and(Ce(je(Pe(":").andr(Ce(Le(Ge.frameRadiusVector().to((function(e){return new Se.Modifier.Shape.Frame.Radius(e)})),Ge.colorName().to((function(e){return new Se.Modifier.Shape.Frame.Color(e)})))))))).to((function(e){var t=e.head;return""===t&&(t="-"),new Se.Modifier.Shape.Frame(t,e.tail)}))})),alphabets:Fe((function(){return Oe(/^([a-zA-Z]+)/)})),colorName:Fe((function(){return Oe(/^([a-zA-Z][a-zA-Z0-9]*)/)})),direction:Fe((function(){return Ae(Ge.direction0,je(Ge.direction1)).to((function(e){return new Se.Direction.Compound(e.head,e.tail)}))})),direction0:Fe((function(){return Le(Ge.direction2,Ge.diag().to((function(e){return new Se.Direction.Diag(e)})))})),direction1:Fe((function(){return Le(Pe(":").andr(Ge.vector).to((function(e){return new Se.Direction.RotVector(e)})),Pe("_").to((function(e){return new Se.Direction.RotAntiCW})),Pe("^").to((function(e){return new Se.Direction.RotCW})))})),direction2:Fe((function(){return Le(Pe("v").andr(Ge.vector).to((function(e){return new Se.Direction.Vector(e)})),Pe("q").andr(Ee("{")).andr(Ge.posDecor).andl(Ee("}")).to((function(e){return new Se.Direction.ConstructVector(e)})))})),nonemptyDirection:Fe((function(){return Le(Ae(Ge.nonemptyDirection0,je(Ge.direction1)),Ae(Ge.direction0,De(Ge.direction1))).to((function(e){return new Se.Direction.Compound(e.head,e.tail)}))})),nonemptyDirection0:Fe((function(){return Le(Ge.direction2,Ge.nonemptyDiag().to((function(e){return new Se.Direction.Diag(e)})))})),diag:Fe((function(){return Le(Ge.nonemptyDiag,Re("empty").to((function(e){return new Se.Diag.Default})))})),nonemptyDiag:Fe((function(){return Le(Be(/^(ld|dl)/).to((function(e){return new Se.Diag.LD})),Be(/^(rd|dr)/).to((function(e){return new Se.Diag.RD})),Be(/^(lu|ul)/).to((function(e){return new Se.Diag.LU})),Be(/^(ru|ur)/).to((function(e){return new Se.Diag.RU})),Pe("l").to((function(e){return new Se.Diag.L})),Pe("r").to((function(e){return new Se.Diag.R})),Pe("d").to((function(e){return new Se.Diag.D})),Pe("u").to((function(e){return new Se.Diag.U})))})),decor:Fe((function(){return Ge.command().rep().to((function(e){return new Se.Decor(e)}))})),command:Fe((function(){return Le(Pe("\\ar").andr(Ce(je(Ge.arrowForm))).and(Ge.path).to((function(e){return new Se.Command.Ar(e.head,e.tail)})),Pe("\\xymatrix").andr(Ge.xymatrix),Pe("\\PATH").andr(Ge.path).to((function(e){return new Se.Command.Path(e)})),Pe("\\afterPATH").andr(Ee("{")).andr(Ge.decor).andl(Ee("}")).and(Ge.path).to((function(e){return new Se.Command.AfterPath(e.head,e.tail)})),Pe("\\save").andr(Ge.pos).to((function(e){return new Se.Command.Save(e)})),Pe("\\restore").to((function(){return new Se.Command.Restore})),Pe("\\POS").andr(Ge.pos).to((function(e){return new Se.Command.Pos(e)})),Pe("\\afterPOS").andr(Ee("{")).andr(Ge.decor).andl(Ee("}")).and(Ge.pos).to((function(e){return new Se.Command.AfterPos(e.head,e.tail)})),Pe("\\drop").andr(Ge.object).to((function(e){return new Se.Command.Drop(e)})),Pe("\\connect").andr(Ge.object).to((function(e){return new Se.Command.Connect(e)})),Pe("\\relax").to((function(){return new Se.Command.Relax})),Pe("\\xyignore").andr(Ee("{")).andr(Ge.pos).and(Ge.decor).andl(Ee("}")).to((function(e){return new Se.Command.Ignore(e.head,e.tail)})),Pe("\\xyshowAST").andr(Ee("{")).andr(Ge.pos).and(Ge.decor).andl(Ee("}")).to((function(e){return new Se.Command.ShowAST(e.head,e.tail)})),Ge.twocellCommand)})),arrowForm:Fe((function(){return Le(Pe("@").andr(Ce(Oe(/^([\-\.~=:])/))).to((function(e){return new Se.Command.Ar.Form.ChangeStem(e)})),Pe("@").andr(Ee("!")).to((function(e){return new Se.Command.Ar.Form.DashArrowStem})),Pe("@").andr(Ee("/")).andr(Ge.direction).and(Ce(Te(Ge.looseDimen))).andl(Ee("/")).to((function(e){return new Se.Command.Ar.Form.CurveArrow(e.head,e.tail.getOrElse(".5pc"))})),Pe("@").andr(Ee("(")).andr(Ge.direction).andl(Ee(",")).and(Ge.direction).andl(Ee(")")).to((function(e){return new Se.Command.Ar.Form.CurveFitToDirection(e.head,e.tail)})),Pe("@").andr(Ee("`")).andr(Ge.coord).to((function(e){return new Se.Command.Ar.Form.CurveWithControlPoints(e)})),Pe("@").andr(Ee("[")).andr(Ge.shape).andl(Ee("]")).to((function(e){return new Se.Command.Ar.Form.AddShape(e)})),Pe("@").andr(Ee("*")).andr(Ee("{")).andr(Ce(je(Ge.modifier))).andl(Ee("}")).to((function(e){return new Se.Command.Ar.Form.AddModifiers(e)})),Pe("@").andr(Ee("<")).andr(Ge.dimen).andl(Ee(">")).to((function(e){return new Se.Command.Ar.Form.Slide(e)})),Pe("|").andr(Ge.anchor).and(Ge.it).to((function(e){return new Se.Command.Ar.Form.LabelAt(e.head,e.tail)})),Pe("^").andr(Ge.anchor).and(Ge.it).to((function(e){return new Se.Command.Ar.Form.LabelAbove(e.head,e.tail)})),Pe("_").andr(Ge.anchor).and(Ge.it).to((function(e){return new Se.Command.Ar.Form.LabelBelow(e.head,e.tail)})),Pe("@").andr(Ee("?")).to((function(){return new Se.Command.Ar.Form.ReverseAboveAndBelow})),Pe("@").andr(Ce(Oe(/^([\^_0123])/).opt())).and(Ce(Te(Ge.tipConnTip))).to((function(e){var t=e.head.getOrElse("");if(e.tail.isDefined){var n=e.tail.get;return new Se.Command.Ar.Form.BuildArrow(t,n.tail,n.stem,n.head)}return new Se.Command.Ar.Form.ChangeVariant(t)})))})),tipConnTip:Fe((function(){return Pe("{").andr(Ce(Te(Ge.nonemptyTip))).and(Ce(Te(Ge.nonemptyConn))).and(Ce(Te(Ge.nonemptyTip))).andl(Ee("}")).to((function(e){var t,n,r,a=e.head.head,i=e.head.tail,o=e.tail,u=new Se.Command.Ar.Form.Tip.Tipchars("");return i.isDefined||o.isDefined?(t=a.getOrElse(u),n=i.getOrElse(new Se.Command.Ar.Form.Conn.Connchars("")),r=o.getOrElse(u)):a.isDefined?(t=u,n=new Se.Command.Ar.Form.Conn.Connchars("-"),r=a.getOrElse(u)):(t=u,n=new Se.Command.Ar.Form.Conn.Connchars(""),r=u),{tail:t,stem:n,head:r}}))})),nonemptyTip:Fe((function(){return Le(Oe(/^([<>()|'`+\/a-zA-Z ]+)/).to((function(e){return new Se.Command.Ar.Form.Tip.Tipchars(e)})),Pe("*").andr(Ge.object).to((function(e){return new Se.Command.Ar.Form.Tip.Object(e)})),Ge.dir().to((function(e){return new Se.Command.Ar.Form.Tip.Dir(e)})))})),nonemptyConn:Fe((function(){return Le(Oe(/^([\-\.~=:]+)/).to((function(e){return new Se.Command.Ar.Form.Conn.Connchars(e)})),Pe("*").andr(Ge.object).to((function(e){return new Se.Command.Ar.Form.Conn.Object(e)})),Ge.dir().to((function(e){return new Se.Command.Ar.Form.Conn.Dir(e)})))})),path:Fe((function(){return Ge.path2(F.empty).to((function(e){return new Se.Command.Path.Path(e)}))})),path2:function(e){var t=Fe((function(){return Ge.path2(e)}));return Le(Ge.path3().and(t).to((function(e){return e.tail.prepend(e.head)})),Ae("~","{",t,"}").to((function(e){return e.head.tail})).into((function(e){return Ge.path2(e)})),Ge.segment().to((function(e){return F.empty.prepend(new Se.Command.Path.LastSegment(e))})),Re(e).to((function(e){return e})))},path3:Fe((function(){return Le(Ae("~","=","{",Ge.posDecor,"}").to((function(e){return new Se.Command.Path.SetBeforeAction(e.head.tail)})),Ae("~","/","{",Ge.posDecor,"}").to((function(e){return new Se.Command.Path.SetAfterAction(e.head.tail)})),Ae("~","<","{",Ge.labels,"}").to((function(e){return new Se.Command.Path.AddLabelNextSegmentOnly(e.head.tail)})),Ae("~",">","{",Ge.labels,"}").to((function(e){return new Se.Command.Path.AddLabelLastSegmentOnly(e.head.tail)})),Ae("~","+","{",Ge.labels,"}").to((function(e){return new Se.Command.Path.AddLabelEverySegment(e.head.tail)})),Ae("'",Ge.segment).to((function(e){return new Se.Command.Path.StraightSegment(e.tail)})),Ae("`",Ge.turn,Ge.segment).to((function(e){return new Se.Command.Path.TurningSegment(e.head.tail,e.tail)})))})),turn:Fe((function(){return Le(Ge.nonemptyCir().and(Ge.turnRadius).to((function(e){return new Se.Command.Path.Turn.Cir(e.head,e.tail)})),Ge.diag().and(Ge.turnRadius).to((function(e){return new Se.Command.Path.Turn.Diag(e.head,e.tail)})))})),turnRadius:Fe((function(){return Le(Pe("/").andr(Ge.dimen).to((function(e){return new Se.Command.Path.TurnRadius.Dimen(e)})),Re("default").to((function(){return new Se.Command.Path.TurnRadius.Default})))})),segment:Fe((function(){return Ge.nonemptyPos().and(Ge.pathSlide).and(Ge.labels).to((function(e){return new Se.Command.Path.Segment(e.head.head,e.head.tail,e.tail)}))})),pathSlide:Fe((function(){return Le(Pe("<").andr(Ge.dimen).andl(Ee(">")).to((function(e){return new Se.Slide(new k.Some(e))})),Re("no slide").to((function(){return new Se.Slide(k.empty)})))})),labels:Fe((function(){return Ge.label().rep().to((function(e){return new Se.Command.Path.Labels(e)}))})),label:Fe((function(){return Le(Ae("^",Ge.anchor,Ge.it,Ge.alias).to((function(e){return new Se.Command.Path.Label.Above(new Se.Pos.Place(e.head.head.tail),e.head.tail,e.tail)})),Ae("_",Ge.anchor,Ge.it,Ge.alias).to((function(e){return new Se.Command.Path.Label.Below(new Se.Pos.Place(e.head.head.tail),e.head.tail,e.tail)})),Ae("|",Ge.anchor,Ge.it,Ge.alias).to((function(e){return new Se.Command.Path.Label.At(new Se.Pos.Place(e.head.head.tail),e.head.tail,e.tail)})))})),anchor:Fe((function(){return Le(Pe("-").andr(Ge.anchor).to((function(e){return new Se.Place(1,1,new Se.Place.Factor(.5),void 0).compound(e)})),Ge.place)})),it:Fe((function(){return je(Pe("[").andr(Ge.shape).andl(Ee("]")).to((function(e){return e}))).and(Ge.it2).to((function(e){return new Se.Object(e.head.concat(e.tail.modifiers),e.tail.object)}))})),it2:Fe((function(){return Le(Be(/^[0-9a-zA-Z]/).and(Ge.textNodeCreator).to((function(e){var t=e.head,n=e.tail;return new Se.Object(F.empty,Ge.toMath("\\labelstyle "+t,n))})),Be(/^(\\[a-zA-Z][a-zA-Z0-9]*)/).and(Ge.textNodeCreator).to((function(e){var t=e.head,n=e.tail;return new Se.Object(F.empty,Ge.toMath("\\labelstyle "+t,n))})),Pe("{").andr(Ge.text).andl(Je("}")).and(Ge.textNodeCreator).to((function(e){var t=e.head,n=e.tail;return new Se.Object(F.empty,Ge.toMath("\\labelstyle "+t,n))})),Pe("*").andr(Ge.object),Pe("@").andr(Ge.dir).to((function(e){return new Se.Object(F.empty,e)})))})),alias:Fe((function(){return Ae("=",'"',Ge.id,'"').opt().to((function(e){return e.map((function(e){return e.head.tail}))}))})),xymatrix:Fe((function(){return Ge.setup().andl(Ee("{")).and(Ge.rows).andl(Ee("}")).to((function(e){return new Se.Command.Xymatrix(e.head,e.tail)}))})),setup:Fe((function(){return je(Ce(Le(Pe('"').andr(Ce(Oe(/^[^"]+/))).andl(Je('"')).to((function(e){return new Se.Command.Xymatrix.Setup.Prefix(e)})),Pe("@!").andr(Ce(Oe(/^[RC]/).opt().to((function(e){return e.getOrElse("")})))).and(Ce(Le(ke("0").to((function(){return"0em"})),ke("=").andr(Ge.dimen)))).to((function(e){var t=e.tail;switch(e.head){case"R":return new Se.Command.Xymatrix.Setup.PretendEntrySize.Height(t);case"C":return new Se.Command.Xymatrix.Setup.PretendEntrySize.Width(t);default:return new Se.Command.Xymatrix.Setup.PretendEntrySize.HeightAndWidth(t)}})),Pe("@!").andr(Ce(Le(ke("R").to((function(){return new Se.Command.Xymatrix.Setup.FixGrid.Row})),ke("C").to((function(){return new Se.Command.Xymatrix.Setup.FixGrid.Column}))).opt().to((function(e){return e.getOrElse(new Se.Command.Xymatrix.Setup.FixGrid.RowAndColumn)})))),Pe("@").andr(Ce(Oe(/^[MWHL]/))).and(Ge.addOp).and(Ge.dimen).to((function(e){var t=e.head.tail,n=e.tail;switch(e.head.head){case"M":return new Se.Command.Xymatrix.Setup.AdjustEntrySize.Margin(t,n);case"W":return new Se.Command.Xymatrix.Setup.AdjustEntrySize.Width(t,n);case"H":return new Se.Command.Xymatrix.Setup.AdjustEntrySize.Height(t,n);case"L":return new Se.Command.Xymatrix.Setup.AdjustLabelSep(t,n)}})),Pe("@").andr(Ge.nonemptyDirection).to((function(e){return new Se.Command.Xymatrix.Setup.SetOrientation(e)})),Pe("@*[").andr(Ge.shape).andl(Ee("]")).to((function(e){return new Se.Command.Xymatrix.Setup.AddModifier(e)})),Pe("@*").andr(Ge.addOp).and(Ge.size).to((function(e){return new Se.Command.Xymatrix.Setup.AddModifier(new Se.Modifier.AddOp(e.head,e.tail))})),Pe("@").andr(Ce(Oe(/^[RC]/).opt().to((function(e){return e.getOrElse("")})))).and(Ge.addOp).and(Ge.dimen).to((function(e){var t=e.head.tail,n=e.tail;switch(e.head.head){case"R":return new Se.Command.Xymatrix.Setup.ChangeSpacing.Row(t,n);case"C":return new Se.Command.Xymatrix.Setup.ChangeSpacing.Column(t,n);default:return new Se.Command.Xymatrix.Setup.ChangeSpacing.RowAndColumn(t,n)}})),Pe("@1").to((function(){return new Se.Command.Xymatrix.Setup.AdjustEntrySize.Margin(new Se.Modifier.AddOp.Set,"1pc")})))))})),rows:Fe((function(){return Ge.row().and(Ce(je(Pe("\\\\").andr(Ge.row)))).to((function(e){var t=e.tail.prepend(e.head);if(!t.isEmpty){var n=t.at(t.length()-1);1===n.entries.length()&&n.entries.at(0).isEmpty&&(t=t.reverse().tail.reverse())}return t}))})),row:Fe((function(){return Ge.entry().and(Ce(je(Pe("&").andr(Ge.entry)))).to((function(e){return new Se.Command.Xymatrix.Row(e.tail.prepend(e.head))}))})),entry:Fe((function(){return Le(Pe("*").andr(Ge.object).and(Ge.pos).and(Ge.decor).to((function(e){var t=e.head.head,n=e.head.tail,r=e.tail;return new Se.Command.Xymatrix.Entry.ObjectEntry(t,n,r)})),Ge.entryModifier().rep().and(Ge.looseObjectbox).and(Ge.decor).to((function(e){var t=e.head.head.foldLeft(F.empty,(function(e,t){return t.concat(e)})),n=e.head.tail.isEmpty,r=e.head.tail.object,a=e.tail;return n&&t.isEmpty?new Se.Command.Xymatrix.Entry.EmptyEntry(a):new Se.Command.Xymatrix.Entry.SimpleEntry(t,r,a)})))})),entryModifier:Fe((function(){return Le(Pe("**").andr(Ee("[")).andr(Ge.shape).andl(Ee("]")).to((function(e){return F.empty.append(e)})),Pe("**").andr(Ee("{")).andr(Ce(je(Ge.modifier))).andl(Ee("}")))})),looseObjectbox:Fe((function(){return Le(Ge.objectbox().to((function(e){return{isEmpty:!1,object:e}})),Oe(/^[^\\{}%&]+/).opt().to((function(e){return e.getOrElse("")})).and(Ce(je(Le(ke("{").andr(Ge.text).andl(Je("}")).to((function(e){return"{"+e+"}"})),ke("\\").andr(Ce((e=Oe(/^(\\|ar|xymatrix|PATH|afterPATH|save|restore|POS|afterPOS|drop|connect|xyignore|([lrud]+(twocell|uppertwocell|lowertwocell|compositemap))|xtwocell|xuppertwocell|xlowertwocell|xcompositemap)/),ae.not(ae.lazyParser(e))))).andr(Ce(Oe(/^[{}%&]/).opt().to((function(e){return e.getOrElse("")})))).to((function(e){return"\\"+e})),Oe(/^%[^\r\n]*(\r\n|\r|\n)?/).to((function(e){return" "}))).and(Ce(Oe(/^[^\\{}%&]+/).opt().to((function(e){return e.getOrElse("")})))).to((function(e){return e.head+e.tail}))).to((function(e){return e.mkString("")})))).and(Ge.textNodeCreator).to((function(e){var t=e.head,n=e.tail,r=t.head+t.tail;return{isEmpty:0===r.trim().length,object:Ge.toMath("\\hbox{$\\objectstyle{"+r+"}$}",n)}})));var e})),twocellCommand:Fe((function(){return Ge.twocell().and(Ce(je(Ge.twocellSwitch))).and(Ge.twocellArrow).to((function(e){return new Se.Command.Twocell(e.head.head,e.head.tail,e.tail)}))})),twocell:Fe((function(){return Le(Be(/^\\[lrud]+twocell/).to((function(e){var t=e.substring(1,e.length-"twocell".length);return new Se.Command.Twocell.Twocell(t,k.empty)})),Be(/^\\[lrud]+uppertwocell/).to((function(e){var t=e.substring(1,e.length-"uppertwocell".length);return new Se.Command.Twocell.UpperTwocell(t,k.empty)})),Be(/^\\[lrud]+lowertwocell/).to((function(e){var t=e.substring(1,e.length-"lowertwocell".length);return new Se.Command.Twocell.LowerTwocell(t,k.empty)})),Be(/^\\[lrud]+compositemap/).to((function(e){var t=e.substring(1,e.length-"compositemap".length);return new Se.Command.Twocell.CompositeMap(t,k.empty)})),Le(Pe("\\xtwocell").to((function(){return Se.Command.Twocell.Twocell})),Pe("\\xuppertwocell").to((function(){return Se.Command.Twocell.UpperTwocell})),Pe("\\xlowertwocell").to((function(){return Se.Command.Twocell.LowerTwocell})),Pe("\\xcompositemap").to((function(){return Se.Command.Twocell.CompositeMap}))).andl(Ee("[")).and(Ce(Oe(/^[lrud]+/))).andl(Ee("]")).andl(Ee("{")).and(Ge.text).andl(Ee("}")).and(Ge.textNodeCreator).to((function(e){var t=e.head,n=e.tail,r=new Se.Object(F.empty,Ge.toMath("\\labelstyle "+t.tail,n));return new t.head.head(t.head.tail,new k.Some(r))})))})),twocellSwitch:Fe((function(){return Le(Pe("^").andr(Ge.twocellLabel).to((function(e){return new Se.Command.Twocell.Switch.UpperLabel(e)})),Pe("_").andr(Ge.twocellLabel).to((function(e){return new Se.Command.Twocell.Switch.LowerLabel(e)})),Pe("\\omit").to((function(){return new Se.Command.Twocell.Switch.DoNotSetCurvedArrows})),Pe("~!").to((function(){return new Se.Command.Twocell.Switch.PlaceModMapObject})),Be(/^(~[`'])/).andl(Ee("{")).and(Ge.object).andl(Ee("}")).to((function(e){var t=e.head.substring(1);return new Se.Command.Twocell.Switch.ChangeHeadTailObject(t,e.tail)})),Be(/^(~[\^_]?)/).andl(Ee("{")).and(Ge.object).and(Ce(Te(Pe("~**").andr(Ge.object)))).andl(Ee("}")).to((function(e){var t=e.head.head.substring(1),n=e.head.tail,r=e.tail;return new Se.Command.Twocell.Switch.ChangeCurveObject(t,n,r)})),Ge.nudge().to((function(e){return new Se.Command.Twocell.Switch.SetCurvature(e)})))})),twocellLabel:Fe((function(){return Le(Be(/^[0-9a-zA-Z]/).and(Ge.textNodeCreator).to((function(e){var t=e.head,n=e.tail,r=new Se.Object(F.empty,Ge.toMath("\\twocellstyle "+t,n));return new Se.Command.Twocell.Label(k.empty,r)})),Be(/^(\\[a-zA-Z][a-zA-Z0-9]*)/).and(Ge.textNodeCreator).to((function(e){var t=e.head,n=e.tail,r=new Se.Object(F.empty,Ge.toMath("\\twocellstyle "+t,n));return new Se.Command.Twocell.Label(k.empty,r)})),Pe("{").andr(Ce(Te(Ge.nudge))).andl(Ee("*")).and(Ge.object).andl(Ee("}")).to((function(e){return new Se.Command.Twocell.Label(e.head,e.tail)})),Pe("{").andr(Ce(Te(Ge.nudge))).and(Ge.text).andl(Je("}")).and(Ge.textNodeCreator).to((function(e){var t=e.head,n=e.tail,r=new Se.Object(F.empty,Ge.toMath("\\twocellstyle "+t.tail,n));return new Se.Command.Twocell.Label(t.head,r)})))})),nudge:Fe((function(){return Le(Pe("<\\omit>").to((function(){return new Se.Command.Twocell.Nudge.Omit})),Pe("<").andr(Ge.factor).andl(Ee(">")).to((function(e){return new Se.Command.Twocell.Nudge.Number(e)})))})),twocellArrow:Fe((function(){return Le(Pe("{").andr(Ce(Be(/^([\^_=`'"!]|\\omit)/))).and(Ge.twocellLabelEntry).andl(Ee("}")).to((function(e){return new Se.Command.Twocell.Arrow.WithOrientation(e.head,e.tail)})),Pe("{").andr(Ge.nudge).and(Ge.twocellLabelEntry).andl(Ee("}")).to((function(e){return new Se.Command.Twocell.Arrow.WithPosition(e.head,e.tail)})),Pe("{").andr(Ge.twocellLabelEntry).andl(Ee("}")).to((function(e){return new Se.Command.Twocell.Arrow.WithOrientation("",e)})),Re("no arrow label").andr(Ge.textNodeCreator).to((function(e){return new Se.Command.Twocell.Arrow.WithOrientation("",new Se.Object(F.empty,Ge.toMath("\\twocellstyle{}",e)))})))})),twocellLabelEntry:Fe((function(){return Le(Pe("*").andr(Ge.object),Ge.text().and(Ge.textNodeCreator).to((function(e){var t=e.head,n=e.tail;return new Se.Object(F.empty,Ge.toMath("\\twocellstyle "+t,n))})))})),newdir:Fe((function(){return Pe("{").andr(Ge.dirMain).andl(Je("}")).andl(Ee("{")).and(Ge.compositeObject).andl(Ee("}")).to((function(e){return new Se.Command.Newdir(e.head,new Se.ObjectBox.CompositeObject(e.tail))}))})),xyimport:Fe((function(){return Pe("\\xyimport").andr(Ee("(")).andr(Ge.factor).andl(Ee(",")).and(Ge.factor).andl(Ee(")")).and(Ce(Te(Pe("(").andr(Ge.factor).andl(Ee(",")).and(Ge.factor).andl(Ee(")"))))).andl(Ee("{")).and(Ce(Le(Pe("\\includegraphics").andr(Ge.includegraphics),Ge.text().and(Ge.textNodeCreator).to((function(e){var t=e.head,n=e.tail;return Ge.toMath("\\hbox{$\\objectstyle{"+t+"}$}",n)}))))).andl(Ee("}")).to((function(e){var t,n,r=e.head.head.head,a=e.head.head.tail;e.head.tail.isDefined?(t=e.head.tail.get.head,n=e.head.tail.get.tail):(t=0,n=0);var i=e.tail;return void 0!==i.isIncludegraphics?new Se.Pos.Xyimport.Graphics(r,a,t,n,i):new Se.Pos.Xyimport.TeXCommand(r,a,t,n,i)}))})),includegraphics:Fe((function(){return Pe("[").andr(Ce(Te(Ge.includegraphicsAttrList))).andl(Ee("]")).andl(Ee("{")).and(Ce(Be(/^[^\s{}]+/))).andl(Ee("}")).to((function(e){var t=e.head.getOrElse(F.empty),n=e.tail;return new Se.Command.Includegraphics(!1,t,n)}))})),includegraphicsAttrList:Fe((function(){return Ge.includegraphicsAttr().and(Ce(je(Pe(",").andr(Ge.includegraphicsAttr)))).to((function(e){return e.tail.prepend(e.head)}))})),includegraphicsAttr:Fe((function(){return Le(Pe("width").andr(Ee("=")).andr(Ge.dimen).to((function(e){return new Se.Command.Includegraphics.Attr.Width(e)})),Pe("height").andr(Ee("=")).andr(Ge.dimen).to((function(e){return new Se.Command.Includegraphics.Attr.Height(e)})))}))};for(var _e in Ve)Ge[_e]=Ve[_e];var Ie=Ge,ze=n(9),Qe=n(10),Ne=function(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]},Xe=function(e){return e<0?-1:e>0?1:0},Ue=function(e){return Math.abs(e)<f.machinePrecision?0:e},We=function(e,t){var n=e[t],r=function(){var r=n.call(this),i=function(){return r};return i.reset=a,e[t]=i,r},a=function(){e[t]=r};r.reset=a,a()},He=function(e){return Math.round(100*e)/100};function qe(e){return(qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ze(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ye(e,t)}function Ye(e,t){return(Ye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $e(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=et(e);if(t){var a=et(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Ke(this,n)}}function Ke(e,t){return!t||"object"!==qe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function et(e){return(et=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rt(e,t,n){return t&&nt(e.prototype,t),n&&nt(e,n),e}var at=function(){function e(){tt(this,e)}return rt(e,[{key:"toRect",value:function(t){return new e.Rect(this.x,this.y,t)}},{key:"toPoint",value:function(){return new e.Point(this.x,this.y)}},{key:"combineRect",value:function(t){return e.combineRect(this,t)}}],[{key:"combineRect",value:function(e,t){if(void 0===e)return t;if(void 0===t)return e;var n=-(Math.min(e.x-e.l,t.x-t.l)-e.x),r=Math.max(e.x+e.r,t.x+t.r)-e.x,a=-(Math.min(e.y-e.d,t.y-t.d)-e.y),i=Math.max(e.y+e.u,t.y+t.u)-e.y;return e.toRect({l:n,r:r,d:a,u:i})}}]),e}();function it(e){return(it="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ot(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ut(e,t)}function ut(e,t){return(ut=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ct(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pt(e);if(t){var a=pt(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return st(this,n)}}function st(e,t){return!t||"object"!==it(t)&&"function"!=typeof t?ht(e):t}function ht(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pt(e){return(pt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function lt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function mt(e,t,n){return t&&xt(e.prototype,t),n&&xt(e,n),e}at.Point=function(e){Ze(n,e);var t=$e(n);function n(e,r){var a;return tt(this,n),(a=t.call(this)).x=e,a.y=r,a}return rt(n,[{key:"isPoint",value:function(){return!0}},{key:"isRect",value:function(){return!1}},{key:"isCircle",value:function(){return!1}},{key:"edgePoint",value:function(e,t){return this}},{key:"proportionalEdgePoint",value:function(e,t){return this}},{key:"grow",value:function(e,t){var n=Math.max(0,e),r=Math.max(0,t);return this.toRect({l:n,r:n,u:r,d:r})}},{key:"toSize",value:function(e,t){return this.toRect({l:e/2,r:e/2,u:t/2,d:t/2})}},{key:"growTo",value:function(e,t){var n=Math.max(0,e),r=Math.max(0,t);return this.toRect({l:n/2,r:n/2,u:r/2,d:r/2})}},{key:"shrinkTo",value:function(e,t){return this}},{key:"move",value:function(e,t){return new at.Point(e,t)}},{key:"shiftFrame",value:function(e,t){return this}},{key:"rotate",value:function(e){return this}},{key:"contains",value:function(e){return!1}},{key:"toString",value:function(){return"{x:"+this.x+", y:"+this.y+"}"}},{key:"l",get:function(){return 0}},{key:"r",get:function(){return 0}},{key:"u",get:function(){return 0}},{key:"d",get:function(){return 0}}]),n}(at),at.Rect=function(e){Ze(n,e);var t=$e(n);function n(e,r,a){var i;return tt(this,n),(i=t.call(this)).x=e,i.y=r,i.l=a.l||0,i.r=a.r||0,i.u=a.u||0,i.d=a.d||0,i}return rt(n,[{key:"isPoint",value:function(){return 0===this.l&&0===this.r&&0===this.u&&0===this.d}},{key:"isRect",value:function(){return!this.isPoint()}},{key:"isCircle",value:function(){return!1}},{key:"edgePoint",value:function(e,t){if(this.isPoint())return this;var n,r=e-this.x,a=t-this.y;return r>0?(n=a*this.r/r)>this.u?new at.Point(this.x+this.u*r/a,this.y+this.u):n<-this.d?new at.Point(this.x-this.d*r/a,this.y-this.d):new at.Point(this.x+this.r,this.y+n):r<0?(n=-a*this.l/r)>this.u?new at.Point(this.x+this.u*r/a,this.y+this.u):n<-this.d?new at.Point(this.x-this.d*r/a,this.y-this.d):new at.Point(this.x-this.l,this.y+n):a>0?new at.Point(this.x,this.y+this.u):new at.Point(this.x,this.y-this.d)}},{key:"proportionalEdgePoint",value:function(e,t){if(this.isPoint())return this;var n=e-this.x,r=t-this.y;if(Math.abs(n)<f.machinePrecision&&Math.abs(r)<f.machinePrecision)return new at.Point(this.x-this.l,this.y+this.u);var a,i=this.l+this.r,o=this.u+this.d,u=Math.PI,c=Math.atan2(r,n);return-3*u/4<c&&c<=-u/4?(a=(c+3*u/4)/(u/2),new at.Point(this.x+this.r-a*i,this.y+this.u)):-u/4<c&&c<=u/4?(a=(c+u/4)/(u/2),new at.Point(this.x-this.l,this.y+this.u-a*o)):u/4<c&&c<=3*u/4?(a=(c-u/4)/(u/2),new at.Point(this.x-this.l+a*i,this.y-this.d)):(a=(c-(c>0?3*u/4:-5*u/4))/(u/2),new at.Point(this.x+this.r,this.y-this.d+a*o))}},{key:"grow",value:function(e,t){return this.toRect({l:Math.max(0,this.l+e),r:Math.max(0,this.r+e),u:Math.max(0,this.u+t),d:Math.max(0,this.d+t)})}},{key:"toSize",value:function(e,t){var n,r,a,i,o=this.l+this.r,u=this.u+this.d;return 0===o?(i=e/2,a=e/2):(i=e*this.l/o,a=e*this.r/o),0===u?(n=t/2,r=t/2):(n=t*this.u/u,r=t*this.d/u),this.toRect({l:i,r:a,u:n,d:r})}},{key:"growTo",value:function(e,t){var n=this.u,r=this.d,a=this.r,i=this.l,o=i+a,u=n+r;return e>o&&(0===o?(i=e/2,a=e/2):(i=e*this.l/o,a=e*this.r/o)),t>u&&(0===u?(n=t/2,r=t/2):(n=t*this.u/u,r=t*this.d/u)),this.toRect({l:i,r:a,u:n,d:r})}},{key:"shrinkTo",value:function(e,t){var n=this.u,r=this.d,a=this.r,i=this.l,o=i+a,u=n+r;return e<o&&(0===o?(i=e/2,a=e/2):(i=e*this.l/o,a=e*this.r/o)),t<u&&(0===u?(n=t/2,r=t/2):(n=t*this.u/u,r=t*this.d/u)),this.toRect({l:i,r:a,u:n,d:r})}},{key:"move",value:function(e,t){return new at.Rect(e,t,{l:this.l,r:this.r,u:this.u,d:this.d})}},{key:"shiftFrame",value:function(e,t){return new at.Rect(this.x,this.y,{l:Math.max(0,this.l-e),r:Math.max(0,this.r+e),u:Math.max(0,this.u+t),d:Math.max(0,this.d-t)})}},{key:"rotate",value:function(e){var t=Math.cos(e),n=Math.sin(e),r=-this.l,a=this.r,i=this.u,o=-this.d,u={x:r*t-i*n,y:r*n+i*t},c={x:r*t-o*n,y:r*n+o*t},s={x:a*t-i*n,y:a*n+i*t},h={x:a*t-o*n,y:a*n+o*t};return this.toRect({l:-Math.min(u.x,c.x,s.x,h.x),r:Math.max(u.x,c.x,s.x,h.x),u:Math.max(u.y,c.y,s.y,h.y),d:-Math.min(u.y,c.y,s.y,h.y)})}},{key:"contains",value:function(e){var t=e.x,n=e.y;return t>=this.x-this.l&&t<=this.x+this.r&&n>=this.y-this.d&&n<=this.y+this.u}},{key:"toString",value:function(){return"{x:"+this.x+", y:"+this.y+", l:"+this.l+", r:"+this.r+", u:"+this.u+", d:"+this.d+"}"}}]),n}(at),at.Ellipse=function(e){Ze(n,e);var t=$e(n);function n(e,r,a,i,o,u){var c;return tt(this,n),(c=t.call(this)).x=e,c.y=r,c.l=a,c.r=i,c.u=o,c.d=u,c}return rt(n,[{key:"isPoint",value:function(){return 0===this.r&&0===this.l||0===this.u&&0===this.d}},{key:"isRect",value:function(){return!1}},{key:"isCircle",value:function(){return!this.isPoint()}},{key:"isPerfectCircle",value:function(){return this.l===this.r&&this.l===this.u&&this.l===this.d}},{key:"edgePoint",value:function(e,t){if(this.isPoint())return this;if(this.isPerfectCircle()){var n,r=e-this.x,a=t-this.y;return n=Math.abs(r)<f.machinePrecision&&Math.abs(a)<f.machinePrecision?-Math.PI/2:Math.atan2(a,r),new at.Point(this.x+this.r*Math.cos(n),this.y+this.r*Math.sin(n))}Math.PI;var i=this.l,o=this.r,u=this.u,c=this.d,s=this.x,h=this.y,p=s+(o-i)/2,l=h+(u-c)/2,x=(i+o)/2,m=(u+c)/2,d=-(r=e-s),y=(a=t-h)*x,v=d*m,g=y*y+v*v,M=-(c=y*p+v*l+((r*h-a*s)*x+(x-m)*d*l))/g,w=g*x*x-c*c;if(w<0)return new at.Point(this.x,this.y-this.d);var S=Math.sqrt(w)/g,b=m/x,C=y*M+v*S+p,k=b*(v*M-y*S+l-l)+l,J=y*M-v*S+p,P=b*(v*M+y*S+l-l)+l,O=Xe;return O(C-p)===O(e-p)&&O(k-l)===O(t-l)?new at.Point(C,k):new at.Point(J,P)}},{key:"proportionalEdgePoint",value:function(e,t){if(this.isPoint())return this;if(this.isPerfectCircle()){var n,r=e-this.x,a=t-this.y;return n=Math.abs(r)<f.machinePrecision&&Math.abs(a)<f.machinePrecision?-Math.PI/2:Math.atan2(a,r),new at.Point(this.x-this.r*Math.cos(n),this.y-this.r*Math.sin(n))}Math.PI;var i=this.l,o=this.r,u=this.u,c=this.d,s=this.x,h=this.y,p=s+(o-i)/2,l=h+(u-c)/2,x=(i+o)/2,m=(u+c)/2,d=-(r=e-s),y=(a=t-h)*x,v=d*m,g=y*y+v*v,M=-(c=y*p+v*l+((r*h-a*s)*x+(x-m)*d*l))/g,w=g*x*x-c*c;if(w<0)return new at.Point(this.x,this.y-this.d);var S=Math.sqrt(w)/g,b=m/x,C=y*M+v*S+p,k=b*(v*M-y*S+l-l)+l,J=y*M-v*S+p,P=b*(v*M+y*S+l-l)+l;return sign(C-p)===sign(e-p)&&sign(k-l)===sign(t-l)?new at.Point(J,P):new at.Point(C,k)}},{key:"grow",value:function(e,t){return new at.Ellipse(this.x,this.y,Math.max(0,this.l+e),Math.max(0,this.r+e),Math.max(0,this.u+t),Math.max(0,this.d+t))}},{key:"toSize",value:function(e,t){var n,r,a,i,o=this.l+this.r,u=this.u+this.d;return 0===o?(i=e/2,a=e/2):(i=e*this.l/o,a=e*this.r/o),0===u?(n=t/2,r=t/2):(n=t*this.u/u,r=t*this.d/u),new at.Ellipse(this.x,this.y,i,a,n,r)}},{key:"growTo",value:function(e,t){var n=this.u,r=this.d,a=this.r,i=this.l,o=i+a,u=n+r;return e>o&&(0===o?(i=e/2,a=e/2):(i=e*this.l/o,a=e*this.r/o)),t>u&&(0===u?(n=t/2,r=t/2):(n=t*this.u/u,r=t*this.d/u)),new at.Ellipse(this.x,this.y,i,a,n,r)}},{key:"shrinkTo",value:function(e,t){var n=this.u,r=this.d,a=this.r,i=this.l,o=i+a,u=n+r;return e<o&&(0===o?(i=e/2,a=e/2):(i=e*this.l/o,a=e*this.r/o)),t<u&&(0===u?(n=t/2,r=t/2):(n=t*this.u/u,r=t*this.d/u)),new at.Ellipse(this.x,this.y,i,a,n,r)}},{key:"move",value:function(e,t){return new at.Ellipse(e,t,this.l,this.r,this.u,this.d)}},{key:"shiftFrame",value:function(e,t){return new at.Ellipse(this.x,this.y,Math.max(0,this.l-e),Math.max(0,this.r+e),Math.max(0,this.u+t),Math.max(0,this.d-t))}},{key:"rotate",value:function(e){return this}},{key:"contains",value:function(e){var t=e.x,n=e.y;if(this.isPoint())return!1;var r=this.l,a=this.r,i=this.u,o=this.d,u=(r+a)/2,c=t-(this.x+(a-r)/2),s=(n-(this.y+(i-o)/2))/((i+o)/2/u);return c*c+s*s<=u*u}},{key:"toString",value:function(){return"{x:"+this.x+", y:"+this.y+", l:"+this.l+", r:"+this.r+", u:"+this.u+", d:"+this.d+"}"}}]),n}(at);var ft=function(){function e(){lt(this,e)}return mt(e,[{key:"isNone",get:function(){return!1}}]),e}();function dt(e){return(dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yt(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vt(e,t)}function vt(e,t){return(vt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=St(e);if(t){var a=St(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Mt(this,n)}}function Mt(e,t){return!t||"object"!==dt(t)&&"function"!=typeof t?wt(e):t}function wt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function St(e){return(St=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function bt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ct(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kt(e,t,n){return t&&Ct(e.prototype,t),n&&Ct(e,n),e}ft.NoneShape=function(e){ot(n,e);var t=ct(n);function n(){return lt(this,n),t.call(this)}return mt(n,[{key:"draw",value:function(e){}},{key:"getBoundingBox",value:function(){}},{key:"toString",value:function(){return"NoneShape"}},{key:"isNone",get:function(){return!0}}]),n}(ft),ft.none=new ft.NoneShape,ft.InvisibleBoxShape=function(e){ot(n,e);var t=ct(n);function n(e){var r;return lt(this,n),(r=t.call(this)).bbox=e,r}return mt(n,[{key:"draw",value:function(e){}},{key:"getBoundingBox",value:function(){return this.bbox}},{key:"toString",value:function(){return"InvisibleBoxShape[bbox:"+this.bbox.toString()+"]"}}]),n}(ft),ft.TranslateShape=function(e){ot(n,e);var t=ct(n);function n(e,r,a){var i;return lt(this,n),(i=t.call(this)).dx=e,i.dy=r,i.shape=a,We(ht(i),"getBoundingBox"),i}return mt(n,[{key:"draw",value:function(e){var t=e.createGroup(e.transformBuilder().translate(this.dx,this.dy));this.shape.draw(t)}},{key:"getBoundingBox",value:function(){var e=this.shape.getBoundingBox();if(void 0!==e)return new at.Rect(e.x+this.dx,e.y+this.dy,e)}},{key:"toString",value:function(){return"TranslateShape[dx:"+this.dx+", dy:"+this.dy+", shape:"+this.shape.toString()+"]"}}]),n}(ft),ft.CompositeShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).foregroundShape=e,a.backgroundShape=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"draw",value:function(e){this.backgroundShape.draw(e),this.foregroundShape.draw(e)}},{key:"getBoundingBox",value:function(){return at.combineRect(this.foregroundShape.getBoundingBox(),this.backgroundShape.getBoundingBox())}},{key:"toString",value:function(){return"("+this.foregroundShape.toString()+", "+this.backgroundShape.toString()+")"}}]),n}(ft),ft.ChangeColorShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).color=e,a.shape=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"draw",value:function(e){var t=e.createChangeColorGroup(this.color);this.shape.draw(t)}},{key:"getBoundingBox",value:function(){return this.shape.getBoundingBox()}},{key:"toString",value:function(){return this.shape+", color:"+this.color}}]),n}(ft),ft.CircleSegmentShape=function(e){ot(n,e);var t=ct(n);function n(e,r,a,i,o,u,c,s,h){var p;return lt(this,n),(p=t.call(this)).x=e,p.y=r,p.sx=a,p.sy=i,p.r=o,p.large=u,p.flip=c,p.ex=s,p.ey=h,We(ht(p),"getBoundingBox"),p}return mt(n,[{key:"draw",value:function(e){e.createSVGElement("path",{d:"M"+r.MathJax.xypic.measure.em2px(this.sx)+","+r.MathJax.xypic.measure.em2px(-this.sy)+" A"+r.MathJax.xypic.measure.em2px(this.r)+","+r.MathJax.xypic.measure.em2px(this.r)+" 0 "+this.large+","+this.flip+" "+r.MathJax.xypic.measure.em2px(this.ex)+","+r.MathJax.xypic.measure.em2px(-this.ey)})}},{key:"getBoundingBox",value:function(){return new at.Ellipse(this.x,this.y,this.r,this.r,this.r,this.r)}},{key:"toString",value:function(){return"CircleSegmentShape[x:"+this.x+", y:"+this.y+", sx:"+this.sx+", sy:"+this.sy+", r:"+this.r+", large:"+this.large+", flip:"+this.flip+", ex:"+this.ex+", ey:"+this.ey+"]"}}]),n}(ft),ft.FullCircleShape=function(e){ot(n,e);var t=ct(n);function n(e,r,a){var i;return lt(this,n),(i=t.call(this)).x=e,i.y=r,i.r=a,We(ht(i),"getBoundingBox"),i}return mt(n,[{key:"draw",value:function(e){e.createSVGElement("circle",{cx:r.MathJax.xypic.measure.em2px(this.x),cy:r.MathJax.xypic.measure.em2px(-this.y),r:r.MathJax.xypic.measure.em2px(this.r)})}},{key:"getBoundingBox",value:function(){return new at.Ellipse(this.x,this.y,this.r,this.r,this.r,this.r)}},{key:"toString",value:function(){return"FullCircleShape[x:"+this.x+", y:"+this.y+", r:"+this.r+"]"}}]),n}(ft),ft.RectangleShape=function(e){ot(n,e);var t=ct(n);function n(e,r,a,i,o,u,c,s,h,p,l,x){var m;return lt(this,n),(m=t.call(this)).x=e,m.y=r,m.left=a,m.right=i,m.up=o,m.down=u,m.r=c,m.isDoubled=s,m.color=h,m.dasharray=p,m.fillColor=l,m.hideLine=x||!1,We(ht(m),"getBoundingBox"),m}return mt(n,[{key:"draw",value:function(e){var t;t={x:r.MathJax.xypic.measure.em2px(this.x-this.left),y:-r.MathJax.xypic.measure.em2px(this.y+this.up),width:r.MathJax.xypic.measure.em2px(this.left+this.right),height:r.MathJax.xypic.measure.em2px(this.up+this.down),rx:r.MathJax.xypic.measure.em2px(this.r)},void 0!==this.dasharray&&(t["stroke-dasharray"]=this.dasharray),this.hideLine?t.stroke="none":void 0!==this.color&&(t.stroke=this.color),void 0!==this.fillColor&&(t.fill=this.fillColor),e.createSVGElement("rect",t),this.isDoubled&&(t={x:r.MathJax.xypic.measure.em2px(this.x-this.left+r.MathJax.xypic.measure.thickness),y:-r.MathJax.xypic.measure.em2px(this.y+this.up-r.MathJax.xypic.measure.thickness),width:r.MathJax.xypic.measure.em2px(this.left+this.right-2*r.MathJax.xypic.measure.thickness),height:r.MathJax.xypic.measure.em2px(this.up+this.down-2*r.MathJax.xypic.measure.thickness),rx:r.MathJax.xypic.measure.em2px(Math.max(this.r-r.MathJax.xypic.measure.thickness,0))},void 0!==this.dasharray&&(t["stroke-dasharray"]=this.dasharray),this.hideLine?t.stroke="none":void 0!==this.color&&(t.stroke=this.color),void 0!==this.fillColor&&(t.fill=this.fillColor),e.createSVGElement("rect",t))}},{key:"getBoundingBox",value:function(){return new at.Rect(this.x,this.y,{l:this.left,r:this.right,u:this.up,d:this.down})}},{key:"toString",value:function(){return"RectangleShape[x:"+this.x+", y:"+this.y+", left:"+this.left+", right:"+this.right+", up:"+this.up+", down:"+this.down+", r:"+this.r+", isDouble:"+this.isDouble+", dasharray:"+this.dasharray+"]"}}]),n}(ft),ft.EllipseShape=function(e){ot(n,e);var t=ct(n);function n(e,r,a,i,o,u,c,s,h){var p;return lt(this,n),(p=t.call(this)).x=e,p.y=r,p.rx=a,p.ry=i,p.isDoubled=o,p.color=u,p.dasharray=c,p.fillColor=s,p.hideLine=h||!1,We(ht(p),"getBoundingBox"),p}return mt(n,[{key:"draw",value:function(e){var t;t={cx:r.MathJax.xypic.measure.em2px(this.x),cy:-r.MathJax.xypic.measure.em2px(this.y),rx:r.MathJax.xypic.measure.em2px(this.rx),ry:r.MathJax.xypic.measure.em2px(this.ry)},void 0!==this.dasharray&&(t["stroke-dasharray"]=this.dasharray),this.hideLine?t.stroke="none":void 0!==this.color&&(t.stroke=this.color),void 0!==this.fillColor&&(t.fill=this.fillColor),e.createSVGElement("ellipse",t),this.isDoubled&&(t={cx:r.MathJax.xypic.measure.em2px(this.x),cy:-r.MathJax.xypic.measure.em2px(this.y),rx:r.MathJax.xypic.measure.em2px(Math.max(this.rx-r.MathJax.xypic.measure.thickness)),ry:r.MathJax.xypic.measure.em2px(Math.max(this.ry-r.MathJax.xypic.measure.thickness))},void 0!==this.dasharray&&(t["stroke-dasharray"]=this.dasharray),this.hideLine?t.stroke="none":void 0!==this.color&&(t.stroke=this.color),void 0!==this.fillColor&&(t.fill=this.fillColor),e.createSVGElement("ellipse",t))}},{key:"getBoundingBox",value:function(){return new at.Rect(this.x,this.y,{l:this.rx,r:this.rx,u:this.ry,d:this.ry})}},{key:"toString",value:function(){return"EllipseShape[x:"+this.x+", y:"+this.y+", rx:"+this.rx+", ry:"+this.ry+", isDoubled:"+this.isDoubled+", dasharray:"+this.dasharray+"]"}}]),n}(ft),ft.BoxShadeShape=function(e){ot(n,e);var t=ct(n);function n(e,r,a,i,o,u,c,s){var h;return lt(this,n),(h=t.call(this)).x=e,h.y=r,h.left=a,h.right=i,h.up=o,h.down=u,h.depth=c,h.color=s||"currentColor",We(ht(h),"getBoundingBox"),h}return mt(n,[{key:"draw",value:function(e){var t=r.MathJax.xypic.measure.em2px(this.x),n=r.MathJax.xypic.measure.em2px(this.y),a=r.MathJax.xypic.measure.em2px(this.left),i=r.MathJax.xypic.measure.em2px(this.right),o=r.MathJax.xypic.measure.em2px(this.up),u=r.MathJax.xypic.measure.em2px(this.down),c=r.MathJax.xypic.measure.em2px(this.depth);e.createSVGElement("path",{d:"M"+(t-a+c)+","+(-n+u)+"L"+(t+i)+","+(-n+u)+"L"+(t+i)+","+(-n-o+c)+"L"+(t+i+c)+","+(-n-o+c)+"L"+(t+i+c)+","+(-n+u+c)+"L"+(t-a+c)+","+(-n+u+c)+"Z",stroke:this.color,fill:this.color})}},{key:"getBoundingBox",value:function(){return new at.Rect(this.x,this.y,{l:this.left,r:this.right+this.depth,u:this.up,d:this.down+this.depth})}},{key:"toString",value:function(){return"RectangleShape[x:"+this.x+", y:"+this.y+", left:"+this.left+", right:"+this.right+", up:"+this.up+", down:"+this.down+", depth:"+this.depth+"]"}}]),n}(ft),ft.LeftBrace=function(e){ot(n,e);var t=ct(n);function n(e,r,a,i,o,u){var c;return lt(this,n),(c=t.call(this)).x=e,c.y=r,c.up=a,c.down=i,c.degree=o,c.color=u||"currentColor",We(ht(c),"getBoundingBox"),c}return mt(n,[{key:"draw",value:function(e){var t,n=r.MathJax.xypic.measure.oneem,a=Math.max(1.41975,this.down/n*1.125)-.660375,i=.660375-Math.max(1.41975,this.up/n*1.125);t="M"+r.MathJax.xypic.measure.em2px(-.0675)+" "+r.MathJax.xypic.measure.em2px(a)+"T"+r.MathJax.xypic.measure.em2px(-.068625)+" "+r.MathJax.xypic.measure.em2px(.07875+a)+"Q"+r.MathJax.xypic.measure.em2px(-.068625)+" "+r.MathJax.xypic.measure.em2px(.190125+a)+" "+r.MathJax.xypic.measure.em2px(-.0585)+" "+r.MathJax.xypic.measure.em2px(.250875+a)+"T"+r.MathJax.xypic.measure.em2px(-.01125)+" "+r.MathJax.xypic.measure.em2px(.387+a)+"Q"+r.MathJax.xypic.measure.em2px(.07425)+" "+r.MathJax.xypic.measure.em2px(.55575+a)+" "+r.MathJax.xypic.measure.em2px(.2475)+" "+r.MathJax.xypic.measure.em2px(.6525+a)+"L"+r.MathJax.xypic.measure.em2px(.262125)+" "+r.MathJax.xypic.measure.em2px(.660375+a)+"L"+r.MathJax.xypic.measure.em2px(.3015)+" "+r.MathJax.xypic.measure.em2px(.660375+a)+"L"+r.MathJax.xypic.measure.em2px(.30825)+" "+r.MathJax.xypic.measure.em2px(.653625+a)+"V"+r.MathJax.xypic.measure.em2px(.622125+a)+"Q"+r.MathJax.xypic.measure.em2px(.30825)+" "+r.MathJax.xypic.measure.em2px(.60975+a)+" "+r.MathJax.xypic.measure.em2px(.2925)+" "+r.MathJax.xypic.measure.em2px(.60075+a)+"Q"+r.MathJax.xypic.measure.em2px(.205875)+" "+r.MathJax.xypic.measure.em2px(.541125+a)+" "+r.MathJax.xypic.measure.em2px(.149625)+" "+r.MathJax.xypic.measure.em2px(.44775+a)+"T"+r.MathJax.xypic.measure.em2px(.07425)+" "+r.MathJax.xypic.measure.em2px(.239625+a)+"Q"+r.MathJax.xypic.measure.em2px(.07425)+" "+r.MathJax.xypic.measure.em2px(.2385+a)+" "+r.MathJax.xypic.measure.em2px(.073125)+" "+r.MathJax.xypic.measure.em2px(.235125+a)+"Q"+r.MathJax.xypic.measure.em2px(.068625)+" "+r.MathJax.xypic.measure.em2px(.203625+a)+" "+r.MathJax.xypic.measure.em2px(.0675)+" "+r.MathJax.xypic.measure.em2px(.041625+a)+"L"+r.MathJax.xypic.measure.em2px(.0675)+" "+r.MathJax.xypic.measure.em2px(.75825)+"Q"+r.MathJax.xypic.measure.em2px(.0675)+" "+r.MathJax.xypic.measure.em2px(.496125)+" "+r.MathJax.xypic.measure.em2px(.066375)+" "+r.MathJax.xypic.measure.em2px(.486)+"Q"+r.MathJax.xypic.measure.em2px(.05625)+" "+r.MathJax.xypic.measure.em2px(.336375)+" "+r.MathJax.xypic.measure.em2px(-.021375)+" "+r.MathJax.xypic.measure.em2px(.212625)+"T"+r.MathJax.xypic.measure.em2px(-.226125)+" "+r.MathJax.xypic.measure.em2px(.010125)+"L"+r.MathJax.xypic.measure.em2px(-.241875)+" 0L"+r.MathJax.xypic.measure.em2px(-.226125)+" "+r.MathJax.xypic.measure.em2px(-.010125)+"Q"+r.MathJax.xypic.measure.em2px(-.106875)+" "+r.MathJax.xypic.measure.em2px(-.084375)+" "+r.MathJax.xypic.measure.em2px(-.025875)+" "+r.MathJax.xypic.measure.em2px(-.207)+"T"+r.MathJax.xypic.measure.em2px(.066375)+" "+r.MathJax.xypic.measure.em2px(-.486)+"Q"+r.MathJax.xypic.measure.em2px(.0675)+" "+r.MathJax.xypic.measure.em2px(-.496125)+" "+r.MathJax.xypic.measure.em2px(.0675)+" "+r.MathJax.xypic.measure.em2px(-.75825)+"L"+r.MathJax.xypic.measure.em2px(.0675)+" "+r.MathJax.xypic.measure.em2px(-.041625+i)+"Q"+r.MathJax.xypic.measure.em2px(.068625)+" "+r.MathJax.xypic.measure.em2px(-.203625+i)+" "+r.MathJax.xypic.measure.em2px(.073125)+" "+r.MathJax.xypic.measure.em2px(-.235125+i)+"Q"+r.MathJax.xypic.measure.em2px(.07425)+" "+r.MathJax.xypic.measure.em2px(-.2385+i)+" "+r.MathJax.xypic.measure.em2px(.07425)+" "+r.MathJax.xypic.measure.em2px(-.239625+i)+"Q"+r.MathJax.xypic.measure.em2px(.093375)+" "+r.MathJax.xypic.measure.em2px(-.354375+i)+" "+r.MathJax.xypic.measure.em2px(.149625)+" "+r.MathJax.xypic.measure.em2px(-.44775+i)+"T"+r.MathJax.xypic.measure.em2px(.2925)+" "+r.MathJax.xypic.measure.em2px(-.60075+i)+"Q"+r.MathJax.xypic.measure.em2px(.30825)+" "+r.MathJax.xypic.measure.em2px(-.60975+i)+" "+r.MathJax.xypic.measure.em2px(.30825)+" "+r.MathJax.xypic.measure.em2px(-.622125+i)+"L"+r.MathJax.xypic.measure.em2px(.30825)+" "+r.MathJax.xypic.measure.em2px(-.653625+i)+"L"+r.MathJax.xypic.measure.em2px(.3015)+" "+r.MathJax.xypic.measure.em2px(-.660375+i)+"L"+r.MathJax.xypic.measure.em2px(.262125)+" "+r.MathJax.xypic.measure.em2px(-.660375+i)+"L"+r.MathJax.xypic.measure.em2px(.2475)+" "+r.MathJax.xypic.measure.em2px(-.6525+i)+"Q"+r.MathJax.xypic.measure.em2px(.07425)+" "+r.MathJax.xypic.measure.em2px(-.55575+i)+" "+r.MathJax.xypic.measure.em2px(-.01125)+" "+r.MathJax.xypic.measure.em2px(-.387+i)+"Q"+r.MathJax.xypic.measure.em2px(-.048375)+" "+r.MathJax.xypic.measure.em2px(-.311625+i)+" "+r.MathJax.xypic.measure.em2px(-.0585)+" "+r.MathJax.xypic.measure.em2px(-.250875+i)+"T"+r.MathJax.xypic.measure.em2px(-.068625)+" "+r.MathJax.xypic.measure.em2px(-.07875+i)+"Q"+r.MathJax.xypic.measure.em2px(-.0675)+" "+r.MathJax.xypic.measure.em2px(i)+" "+r.MathJax.xypic.measure.em2px(-.0675)+" "+r.MathJax.xypic.measure.em2px(i)+"L"+r.MathJax.xypic.measure.em2px(-.0675)+" "+r.MathJax.xypic.measure.em2px(-.759375)+"V"+r.MathJax.xypic.measure.em2px(-.5985)+"Q"+r.MathJax.xypic.measure.em2px(-.0675)+" "+r.MathJax.xypic.measure.em2px(-.47925)+" "+r.MathJax.xypic.measure.em2px(-.075375)+" "+r.MathJax.xypic.measure.em2px(-.41175)+"T"+r.MathJax.xypic.measure.em2px(-.11475)+" "+r.MathJax.xypic.measure.em2px(-.27)+"Q"+r.MathJax.xypic.measure.em2px(-.133875)+" "+r.MathJax.xypic.measure.em2px(-.2205)+" "+r.MathJax.xypic.measure.em2px(-.160875)+" "+r.MathJax.xypic.measure.em2px(-.17775)+"T"+r.MathJax.xypic.measure.em2px(-.212625)+" "+r.MathJax.xypic.measure.em2px(-.106875)+"T"+r.MathJax.xypic.measure.em2px(-.25875)+" "+r.MathJax.xypic.measure.em2px(-.06075)+"T"+r.MathJax.xypic.measure.em2px(-.293625)+" "+r.MathJax.xypic.measure.em2px(-.0315)+"T"+r.MathJax.xypic.measure.em2px(-.307125)+" "+r.MathJax.xypic.measure.em2px(-.02025)+"Q"+r.MathJax.xypic.measure.em2px(-.30825)+" "+r.MathJax.xypic.measure.em2px(-.019125)+" "+r.MathJax.xypic.measure.em2px(-.30825)+" 0T"+r.MathJax.xypic.measure.em2px(-.307125)+" "+r.MathJax.xypic.measure.em2px(.02025)+"Q"+r.MathJax.xypic.measure.em2px(-.307125)+" "+r.MathJax.xypic.measure.em2px(.021375)+" "+r.MathJax.xypic.measure.em2px(-.284625)+" "+r.MathJax.xypic.measure.em2px(.03825)+"T"+r.MathJax.xypic.measure.em2px(-.2295)+" "+r.MathJax.xypic.measure.em2px(.091125)+"T"+r.MathJax.xypic.measure.em2px(-.162)+" "+r.MathJax.xypic.measure.em2px(.176625)+"T"+r.MathJax.xypic.measure.em2px(-.10125)+" "+r.MathJax.xypic.measure.em2px(.30825)+"T"+r.MathJax.xypic.measure.em2px(-.068625)+" "+r.MathJax.xypic.measure.em2px(.482625)+"Q"+r.MathJax.xypic.measure.em2px(-.0675)+" "+r.MathJax.xypic.measure.em2px(.496125)+" "+r.MathJax.xypic.measure.em2px(-.0675)+" "+r.MathJax.xypic.measure.em2px(.759375)+"Z",e.createSVGElement("path",{d:t,fill:this.color,stroke:this.color,"stroke-width":"0pt",transform:"translate("+r.MathJax.xypic.measure.em2px(this.x)+","+r.MathJax.xypic.measure.em2px(-this.y)+") rotate("+-this.degree+") scale("+n/1.125+")"})}},{key:"getBoundingBox",value:function(){var e=r.MathJax.xypic.measure.oneem;return new at.Rect(this.x,this.y,{l:.274*e,r:.274*e,u:Math.max(1.41975*e/1.125,this.up),d:Math.max(1.41975*e/1.125,this.down)}).rotate(this.degree*Math.PI/180)}},{key:"toString",value:function(){return"LeftBrace[x:"+this.x+", y:"+this.y+", up:"+this.up+", down:"+this.down+"]"}}]),n}(ft),ft.LeftParenthesis=function(e){ot(n,e);var t=ct(n);function n(e,r,a,i,o){var u;return lt(this,n),(u=t.call(this)).x=e,u.y=r,u.height=a,u.degree=i,u.color=o||"currentColor",We(ht(u),"getBoundingBox"),u}return mt(n,[{key:"draw",value:function(e){var t,n=r.MathJax.xypic.measure.oneem,a=Math.max(.660375,this.height/2/n*1.125)-.660375,i=-a;t="M"+r.MathJax.xypic.measure.em2px(-.0675)+" "+r.MathJax.xypic.measure.em2px(a)+"T"+r.MathJax.xypic.measure.em2px(-.068625)+" "+r.MathJax.xypic.measure.em2px(.07875+a)+"Q"+r.MathJax.xypic.measure.em2px(-.068625)+" "+r.MathJax.xypic.measure.em2px(.190125+a)+" "+r.MathJax.xypic.measure.em2px(-.0585)+" "+r.MathJax.xypic.measure.em2px(.250875+a)+"T"+r.MathJax.xypic.measure.em2px(-.01125)+" "+r.MathJax.xypic.measure.em2px(.387+a)+"Q"+r.MathJax.xypic.measure.em2px(.07425)+" "+r.MathJax.xypic.measure.em2px(.55575+a)+" "+r.MathJax.xypic.measure.em2px(.2475)+" "+r.MathJax.xypic.measure.em2px(.6525+a)+"L"+r.MathJax.xypic.measure.em2px(.262125)+" "+r.MathJax.xypic.measure.em2px(.660375+a)+"L"+r.MathJax.xypic.measure.em2px(.3015)+" "+r.MathJax.xypic.measure.em2px(.660375+a)+"L"+r.MathJax.xypic.measure.em2px(.30825)+" "+r.MathJax.xypic.measure.em2px(.653625+a)+"V"+r.MathJax.xypic.measure.em2px(.622125+a)+"Q"+r.MathJax.xypic.measure.em2px(.30825)+" "+r.MathJax.xypic.measure.em2px(.60975+a)+" "+r.MathJax.xypic.measure.em2px(.2925)+" "+r.MathJax.xypic.measure.em2px(.60075+a)+"Q"+r.MathJax.xypic.measure.em2px(.205875)+" "+r.MathJax.xypic.measure.em2px(.541125+a)+" "+r.MathJax.xypic.measure.em2px(.149625)+" "+r.MathJax.xypic.measure.em2px(.44775+a)+"T"+r.MathJax.xypic.measure.em2px(.07425)+" "+r.MathJax.xypic.measure.em2px(.239625+a)+"Q"+r.MathJax.xypic.measure.em2px(.07425)+" "+r.MathJax.xypic.measure.em2px(.2385+a)+" "+r.MathJax.xypic.measure.em2px(.073125)+" "+r.MathJax.xypic.measure.em2px(.235125+a)+"Q"+r.MathJax.xypic.measure.em2px(.068625)+" "+r.MathJax.xypic.measure.em2px(.203625+a)+" "+r.MathJax.xypic.measure.em2px(.0675)+" "+r.MathJax.xypic.measure.em2px(.041625+a)+"L"+r.MathJax.xypic.measure.em2px(.0675)+" "+r.MathJax.xypic.measure.em2px(-.041625+i)+"Q"+r.MathJax.xypic.measure.em2px(.068625)+" "+r.MathJax.xypic.measure.em2px(-.203625+i)+" "+r.MathJax.xypic.measure.em2px(.073125)+" "+r.MathJax.xypic.measure.em2px(-.235125+i)+"Q"+r.MathJax.xypic.measure.em2px(.07425)+" "+r.MathJax.xypic.measure.em2px(-.2385+i)+" "+r.MathJax.xypic.measure.em2px(.07425)+" "+r.MathJax.xypic.measure.em2px(-.239625+i)+"Q"+r.MathJax.xypic.measure.em2px(.093375)+" "+r.MathJax.xypic.measure.em2px(-.354375+i)+" "+r.MathJax.xypic.measure.em2px(.149625)+" "+r.MathJax.xypic.measure.em2px(-.44775+i)+"T"+r.MathJax.xypic.measure.em2px(.2925)+" "+r.MathJax.xypic.measure.em2px(-.60075+i)+"Q"+r.MathJax.xypic.measure.em2px(.30825)+" "+r.MathJax.xypic.measure.em2px(-.60975+i)+" "+r.MathJax.xypic.measure.em2px(.30825)+" "+r.MathJax.xypic.measure.em2px(-.622125+i)+"L"+r.MathJax.xypic.measure.em2px(.30825)+" "+r.MathJax.xypic.measure.em2px(-.653625+i)+"L"+r.MathJax.xypic.measure.em2px(.3015)+" "+r.MathJax.xypic.measure.em2px(-.660375+i)+"L"+r.MathJax.xypic.measure.em2px(.262125)+" "+r.MathJax.xypic.measure.em2px(-.660375+i)+"L"+r.MathJax.xypic.measure.em2px(.2475)+" "+r.MathJax.xypic.measure.em2px(-.6525+i)+"Q"+r.MathJax.xypic.measure.em2px(.07425)+" "+r.MathJax.xypic.measure.em2px(-.55575+i)+" "+r.MathJax.xypic.measure.em2px(-.01125)+" "+r.MathJax.xypic.measure.em2px(-.387+i)+"Q"+r.MathJax.xypic.measure.em2px(-.048375)+" "+r.MathJax.xypic.measure.em2px(-.311625+i)+" "+r.MathJax.xypic.measure.em2px(-.0585)+" "+r.MathJax.xypic.measure.em2px(-.250875+i)+"T"+r.MathJax.xypic.measure.em2px(-.068625)+" "+r.MathJax.xypic.measure.em2px(-.07875+i)+"Q"+r.MathJax.xypic.measure.em2px(-.0675)+" "+r.MathJax.xypic.measure.em2px(i)+" "+r.MathJax.xypic.measure.em2px(-.0675)+" "+r.MathJax.xypic.measure.em2px(i)+"Z",e.createSVGElement("path",{d:t,fill:this.color,stroke:this.color,"stroke-width":"0pt",transform:"translate("+r.MathJax.xypic.measure.em2px(this.x)+","+r.MathJax.xypic.measure.em2px(-this.y)+") rotate("+-this.degree+") scale("+n/1.125+")"})}},{key:"getBoundingBox",value:function(){var e=r.MathJax.xypic.measure.oneem;return new at.Rect(this.x,this.y,{l:.06*e,r:.274*e,u:Math.max(.660375*e/1.125,this.height/2),d:Math.max(.660375*e/1.125,this.height/2)}).rotate(this.degree*Math.PI/180)}},{key:"toString",value:function(){return"LeftBrace[x:"+this.x+", y:"+this.y+", up:"+this.up+", down:"+this.down+"]"}}]),n}(ft),ft.TextShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.math=r,a.originalBBox=void 0,We(ht(a),"getBoundingBox"),We(ht(a),"getOriginalReferencePoint"),a}return mt(n,[{key:"draw",value:function(e){this._draw(e,!1)}},{key:"getBoundingBox",value:function(){return this._draw(r.MathJax.xypic.svgForTestLayout,!0)}},{key:"getOriginalReferencePoint",value:function(){this.getBoundingBox();var e=this.originalBBox,t=this.c,n=e.H,r=e.D;return new at.Point(t.x,t.y-(n-r)/2)}},{key:"toString",value:function(){return"TextShape[c:"+this.c.toString()+", math:"+this.math.toString()+"]"}}]),n}(ft),ft.ImageShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.url=r,We(ht(a),"getBoundingBox"),We(ht(a),"getOriginalReferencePoint"),a}return mt(n,[{key:"draw",value:function(e){var t=this.c;e.createSVGElement("image",{x:r.MathJax.xypic.measure.em2px(t.x-t.l),y:r.MathJax.xypic.measure.em2px(-t.y-t.u),width:r.MathJax.xypic.measure.em2px(t.l+t.r),height:r.MathJax.xypic.measure.em2px(t.u+t.d),preserveAspectRatio:"none","xlink:href":this.url})}},{key:"getBoundingBox",value:function(){return this.c}},{key:"getOriginalReferencePoint",value:function(){return this.c}},{key:"toString",value:function(){return"ImageShape[c:"+this.c.toString()+", height:"+this.height+", width:"+this.width+", url:"+this.url+"]"}}]),n}(ft),ft.ArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(){return lt(this,n),t.call(this)}return mt(n,[{key:"draw",value:function(e){var t=e.createGroup(e.transformBuilder().translate(this.c.x,this.c.y).rotateRadian(this.angle));this.drawDelegate(t)}},{key:"getBoundingBox",value:function(){return this.c.toRect(this.getBox()).rotate(this.angle)}},{key:"toString",value:function(){return"ArrowheadShape[c:"+this.c.toString()+", angle:"+this.angle+"]"}}]),n}(ft),ft.GT2ArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){var e=r.MathJax.xypic.measure.oneem;return{l:.456*e,r:0,d:.229*e,u:.229*e}}},{key:"getRadius",value:function(){return.213*r.MathJax.xypic.measure.oneem}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.oneem,n=e.createGroup(e.transformBuilder().rotateDegree(-10)),a=e.createGroup(e.transformBuilder().rotateDegree(10));n.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(-.222*t)+","+r.MathJax.xypic.measure.em2px(-.02*t)+" "+r.MathJax.xypic.measure.em2px(-.489*t)+","+r.MathJax.xypic.measure.em2px(-.147*t)}),a.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(-.222*t)+","+r.MathJax.xypic.measure.em2px(.02*t)+" "+r.MathJax.xypic.measure.em2px(-.489*t)+","+r.MathJax.xypic.measure.em2px(.147*t)})}}]),n}(ft.ArrowheadShape),ft.GT3ArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){var e=r.MathJax.xypic.measure.oneem;return{l:.507*e,r:0,d:.268*e,u:.268*e}}},{key:"getRadius",value:function(){return.325*r.MathJax.xypic.measure.oneem}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.oneem,n=e.createGroup(e.transformBuilder().rotateDegree(-15)),a=e.createGroup(e.transformBuilder().rotateDegree(15));n.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(-.222*t)+","+r.MathJax.xypic.measure.em2px(-.02*t)+" "+r.MathJax.xypic.measure.em2px(-.489*t)+","+r.MathJax.xypic.measure.em2px(-.147*t)}),e.createSVGElement("line",{x1:0,y1:0,x2:r.MathJax.xypic.measure.em2px(-.507*t),y2:0}),a.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(-.222*t)+","+r.MathJax.xypic.measure.em2px(.02*t)+" "+r.MathJax.xypic.measure.em2px(-.489*t)+","+r.MathJax.xypic.measure.em2px(.147*t)})}}]),n}(ft.ArrowheadShape),ft.UpperGTArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){var e=r.MathJax.xypic.measure.oneem;return{l:.489*e,r:0,d:0,u:.147*e}}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.oneem;e.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(-.222*t)+","+r.MathJax.xypic.measure.em2px(-.02*t)+" "+r.MathJax.xypic.measure.em2px(-.489*t)+","+r.MathJax.xypic.measure.em2px(-.147*t)})}}]),n}(ft.ArrowheadShape),ft.LowerGTArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){var e=r.MathJax.xypic.measure.oneem;return{l:.489*e,r:0,d:.147*e,u:0}}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.oneem;e.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(-.222*t)+","+r.MathJax.xypic.measure.em2px(.02*t)+" "+r.MathJax.xypic.measure.em2px(-.489*t)+","+r.MathJax.xypic.measure.em2px(.147*t)})}}]),n}(ft.ArrowheadShape),ft.GTArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){var e=r.MathJax.xypic.measure.oneem;return{l:.489*e,r:0,d:.147*e,u:.147*e}}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.oneem;e.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(-.222*t)+","+r.MathJax.xypic.measure.em2px(.02*t)+" "+r.MathJax.xypic.measure.em2px(-.489*t)+","+r.MathJax.xypic.measure.em2px(.147*t)}),e.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(-.222*t)+","+r.MathJax.xypic.measure.em2px(-.02*t)+" "+r.MathJax.xypic.measure.em2px(-.489*t)+","+r.MathJax.xypic.measure.em2px(-.147*t)})}}]),n}(ft.ArrowheadShape),ft.LT2ArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){var e=r.MathJax.xypic.measure.oneem;return{l:0,r:.456*e,d:.229*e,u:.229*e}}},{key:"getRadius",value:function(){return.213*r.MathJax.xypic.measure.oneem}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.oneem,n=e.createGroup(e.transformBuilder().rotateDegree(10)),a=e.createGroup(e.transformBuilder().rotateDegree(-10));n.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(.222*t)+","+r.MathJax.xypic.measure.em2px(-.02*t)+" "+r.MathJax.xypic.measure.em2px(.489*t)+","+r.MathJax.xypic.measure.em2px(-.147*t)}),a.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(.222*t)+","+r.MathJax.xypic.measure.em2px(.02*t)+" "+r.MathJax.xypic.measure.em2px(.489*t)+","+r.MathJax.xypic.measure.em2px(.147*t)})}}]),n}(ft.ArrowheadShape),ft.LT3ArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){var e=r.MathJax.xypic.measure.oneem;return{l:0,r:.507*e,d:.268*e,u:.268*e}}},{key:"getRadius",value:function(){return.325*r.MathJax.xypic.measure.oneem}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.oneem,n=e.createGroup(e.transformBuilder().rotateDegree(15)),a=e.createGroup(e.transformBuilder().rotateDegree(-15));n.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(.222*t)+","+r.MathJax.xypic.measure.em2px(-.02*t)+" "+r.MathJax.xypic.measure.em2px(.489*t)+","+r.MathJax.xypic.measure.em2px(-.147*t)}),e.createSVGElement("line",{x1:0,y1:0,x2:r.MathJax.xypic.measure.em2px(.507*t),y2:0}),a.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(.222*t)+","+r.MathJax.xypic.measure.em2px(.02*t)+" "+r.MathJax.xypic.measure.em2px(.489*t)+","+r.MathJax.xypic.measure.em2px(.147*t)})}}]),n}(ft.ArrowheadShape),ft.UpperLTArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){var e=r.MathJax.xypic.measure.oneem;return{l:0,r:.489*e,d:0,u:.147*e}}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.oneem;e.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(.222*t)+","+r.MathJax.xypic.measure.em2px(-.02*t)+" "+r.MathJax.xypic.measure.em2px(.489*t)+","+r.MathJax.xypic.measure.em2px(-.147*t)})}}]),n}(ft.ArrowheadShape),ft.LowerLTArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){var e=r.MathJax.xypic.measure.oneem;return{l:0,r:.489*e,d:.147*e,u:0}}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.oneem;e.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(.222*t)+","+r.MathJax.xypic.measure.em2px(.02*t)+" "+r.MathJax.xypic.measure.em2px(.489*t)+","+r.MathJax.xypic.measure.em2px(.147*t)})}}]),n}(ft.ArrowheadShape),ft.LTArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){var e=r.MathJax.xypic.measure.oneem;return{l:0,r:.489*e,d:.147*e,u:.147*e}}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.oneem;e.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(.222*t)+","+r.MathJax.xypic.measure.em2px(-.02*t)+" "+r.MathJax.xypic.measure.em2px(.489*t)+","+r.MathJax.xypic.measure.em2px(-.147*t)}),e.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(.222*t)+","+r.MathJax.xypic.measure.em2px(.02*t)+" "+r.MathJax.xypic.measure.em2px(.489*t)+","+r.MathJax.xypic.measure.em2px(.147*t)})}}]),n}(ft.ArrowheadShape),ft.UpperColumnArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:0,r:0,u:r.MathJax.xypic.measure.lineElementLength,d:0}}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.em2px(r.MathJax.xypic.measure.lineElementLength);e.createSVGElement("line",{x1:0,y1:0,x2:0,y2:-t})}}]),n}(ft.ArrowheadShape),ft.LowerColumnArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:0,r:0,u:0,d:r.MathJax.xypic.measure.lineElementLength}}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.em2px(r.MathJax.xypic.measure.lineElementLength);e.createSVGElement("line",{x1:0,y1:0,x2:0,y2:t})}}]),n}(ft.ArrowheadShape),ft.Column2ArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:0,r:0,u:.5*(r.MathJax.xypic.measure.lineElementLength+r.MathJax.xypic.measure.thickness),d:.5*(r.MathJax.xypic.measure.lineElementLength+r.MathJax.xypic.measure.thickness)}}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.em2px(.5*(r.MathJax.xypic.measure.lineElementLength+r.MathJax.xypic.measure.thickness));e.createSVGElement("line",{x1:0,y1:t,x2:0,y2:-t})}}]),n}(ft.ArrowheadShape),ft.Column3ArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:0,r:0,u:.5*r.MathJax.xypic.measure.lineElementLength+r.MathJax.xypic.measure.thickness,d:.5*r.MathJax.xypic.measure.lineElementLength+r.MathJax.xypic.measure.thickness}}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.em2px(.5*r.MathJax.xypic.measure.lineElementLength+r.MathJax.xypic.measure.thickness);e.createSVGElement("line",{x1:0,y1:t,x2:0,y2:-t})}}]),n}(ft.ArrowheadShape),ft.ColumnArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:0,r:0,u:.5*r.MathJax.xypic.measure.lineElementLength,d:.5*r.MathJax.xypic.measure.lineElementLength}}},{key:"drawDelegate",value:function(e){r.MathJax.xypic.measure.thickness;var t=r.MathJax.xypic.measure.em2px(.5*r.MathJax.xypic.measure.lineElementLength);e.createSVGElement("line",{x1:0,y1:t,x2:0,y2:-t})}}]),n}(ft.ArrowheadShape),ft.UpperLParenArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:.5*r.MathJax.xypic.measure.lineElementLength,r:0,u:r.MathJax.xypic.measure.lineElementLength,d:0}}},{key:"drawDelegate",value:function(e){r.MathJax.xypic.measure.thickness;var t=r.MathJax.xypic.measure.em2px(.5*r.MathJax.xypic.measure.lineElementLength);e.createSVGElement("path",{d:"M0,0 A "+t+","+t+" 0 0,1 0,"+-2*t})}}]),n}(ft.ArrowheadShape),ft.LowerLParenArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:.5*r.MathJax.xypic.measure.lineElementLength,r:0,u:0,d:r.MathJax.xypic.measure.lineElementLength}}},{key:"drawDelegate",value:function(e){r.MathJax.xypic.measure.thickness;var t=r.MathJax.xypic.measure.em2px(.5*r.MathJax.xypic.measure.lineElementLength);e.createSVGElement("path",{d:"M0,0 A "+t+","+t+" 0 0,0 0,"+2*t})}}]),n}(ft.ArrowheadShape),ft.LParenArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:0,r:.5*r.MathJax.xypic.measure.lineElementLength,u:.5*r.MathJax.xypic.measure.lineElementLength,d:.5*r.MathJax.xypic.measure.lineElementLength}}},{key:"drawDelegate",value:function(e){r.MathJax.xypic.measure.thickness;var t=r.MathJax.xypic.measure.em2px(.5*r.MathJax.xypic.measure.lineElementLength);e.createSVGElement("path",{d:"M"+t+","+-t+" A "+t+","+t+" 0 0,0 "+t+","+t})}}]),n}(ft.ArrowheadShape),ft.UpperRParenArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:0,r:.5*r.MathJax.xypic.measure.lineElementLength,u:r.MathJax.xypic.measure.lineElementLength,d:0}}},{key:"drawDelegate",value:function(e){r.MathJax.xypic.measure.thickness;var t=r.MathJax.xypic.measure.em2px(.5*r.MathJax.xypic.measure.lineElementLength);e.createSVGElement("path",{d:"M0,0 A "+t+","+t+" 0 0,0 0,"+-2*t})}}]),n}(ft.ArrowheadShape),ft.LowerRParenArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:0,r:.5*r.MathJax.xypic.measure.lineElementLength,u:0,d:r.MathJax.xypic.measure.lineElementLength}}},{key:"drawDelegate",value:function(e){r.MathJax.xypic.measure.thickness;var t=r.MathJax.xypic.measure.em2px(.5*r.MathJax.xypic.measure.lineElementLength);e.createSVGElement("path",{d:"M0,0 A "+t+","+t+" 0 0,1 0,"+2*t})}}]),n}(ft.ArrowheadShape),ft.RParenArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:.5*r.MathJax.xypic.measure.lineElementLength,r:0,u:.5*r.MathJax.xypic.measure.lineElementLength,d:.5*r.MathJax.xypic.measure.lineElementLength}}},{key:"drawDelegate",value:function(e){r.MathJax.xypic.measure.thickness;var t=r.MathJax.xypic.measure.em2px(.5*r.MathJax.xypic.measure.lineElementLength);e.createSVGElement("path",{d:"M"+-t+","+-t+" A "+t+","+t+" 0 0,1 "+-t+","+t})}}]),n}(ft.ArrowheadShape),ft.LowerBackquoteArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:.5*r.MathJax.xypic.measure.lineElementLength,r:0,u:0,d:.5*r.MathJax.xypic.measure.lineElementLength}}},{key:"drawDelegate",value:function(e){r.MathJax.xypic.measure.thickness;var t=r.MathJax.xypic.measure.em2px(.5*r.MathJax.xypic.measure.lineElementLength);e.createSVGElement("path",{d:"M0,0 A "+t+","+t+" 0 0,0 "+-t+","+t})}}]),n}(ft.ArrowheadShape),ft.UpperBackquoteArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:.5*r.MathJax.xypic.measure.lineElementLength,r:0,u:.5*r.MathJax.xypic.measure.lineElementLength,d:0}}},{key:"drawDelegate",value:function(e){r.MathJax.xypic.measure.thickness;var t=r.MathJax.xypic.measure.em2px(.5*r.MathJax.xypic.measure.lineElementLength);e.createSVGElement("path",{d:"M0,0 A "+t+","+t+" 0 0,1 "+-t+","+-t})}}]),n}(ft.ArrowheadShape),ft.LowerQuoteArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:0,r:.5*r.MathJax.xypic.measure.lineElementLength,u:0,d:.5*r.MathJax.xypic.measure.lineElementLength}}},{key:"drawDelegate",value:function(e){r.MathJax.xypic.measure.thickness;var t=r.MathJax.xypic.measure.em2px(.5*r.MathJax.xypic.measure.lineElementLength);e.createSVGElement("path",{d:"M0,0 A "+t+","+t+" 0 0,1 "+t+","+t})}}]),n}(ft.ArrowheadShape),ft.UpperQuoteArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:0,r:.5*r.MathJax.xypic.measure.lineElementLength,u:.5*r.MathJax.xypic.measure.lineElementLength,d:0}}},{key:"drawDelegate",value:function(e){r.MathJax.xypic.measure.thickness;var t=r.MathJax.xypic.measure.em2px(.5*r.MathJax.xypic.measure.lineElementLength);e.createSVGElement("path",{d:"M0,0 A "+t+","+t+" 0 0,0 "+t+","+-t})}}]),n}(ft.ArrowheadShape),ft.AsteriskArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=0,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:r.MathJax.xypic.measure.thickness,r:r.MathJax.xypic.measure.thickness,u:r.MathJax.xypic.measure.thickness,d:r.MathJax.xypic.measure.thickness}}},{key:"drawDelegate",value:function(e){e.createSVGElement("circle",{cx:0,cy:0,r:r.MathJax.xypic.measure.em2px(r.MathJax.xypic.measure.thickness),fill:"currentColor"})}}]),n}(ft.ArrowheadShape),ft.OArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=0,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:r.MathJax.xypic.measure.thickness,r:r.MathJax.xypic.measure.thickness,u:r.MathJax.xypic.measure.thickness,d:r.MathJax.xypic.measure.thickness}}},{key:"drawDelegate",value:function(e){e.createSVGElement("circle",{cx:0,cy:0,r:r.MathJax.xypic.measure.em2px(r.MathJax.xypic.measure.thickness)})}}]),n}(ft.ArrowheadShape),ft.PlusArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:.5*r.MathJax.xypic.measure.lineElementLength,r:.5*r.MathJax.xypic.measure.lineElementLength,u:.5*r.MathJax.xypic.measure.lineElementLength,d:.5*r.MathJax.xypic.measure.lineElementLength}}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.lineElementLength/2,n=r.MathJax.xypic.measure.em2px(t);e.createSVGElement("line",{x1:-n,y1:0,x2:n,y2:0}),e.createSVGElement("line",{x1:0,y1:n,x2:0,y2:-n})}}]),n}(ft.ArrowheadShape),ft.XArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r+Math.PI/4,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:.5*r.MathJax.xypic.measure.lineElementLength,r:.5*r.MathJax.xypic.measure.lineElementLength,u:.5*r.MathJax.xypic.measure.lineElementLength,d:.5*r.MathJax.xypic.measure.lineElementLength}}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.lineElementLength/2,n=r.MathJax.xypic.measure.em2px(t);e.createSVGElement("line",{x1:-n,y1:0,x2:n,y2:0}),e.createSVGElement("line",{x1:0,y1:n,x2:0,y2:-n})}}]),n}(ft.ArrowheadShape),ft.SlashArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r-Math.PI/10,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:0,r:0,u:r.MathJax.xypic.measure.lineElementLength/2,d:r.MathJax.xypic.measure.lineElementLength/2}}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.lineElementLength/2,n=r.MathJax.xypic.measure.em2px(t);e.createSVGElement("line",{x1:0,y1:n,x2:0,y2:-n})}}]),n}(ft.ArrowheadShape),ft.Line3ArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:0,r:r.MathJax.xypic.measure.lineElementLength,u:r.MathJax.xypic.measure.thickness,d:r.MathJax.xypic.measure.thickness}}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.em2px(r.MathJax.xypic.measure.lineElementLength),n=r.MathJax.xypic.measure.em2px(r.MathJax.xypic.measure.thickness);e.createSVGElement("line",{x1:0,y1:n,x2:t,y2:n}),e.createSVGElement("line",{x1:0,y1:0,x2:t,y2:0}),e.createSVGElement("line",{x1:0,y1:-n,x2:t,y2:-n})}}]),n}(ft.ArrowheadShape),ft.Line2ArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:0,r:r.MathJax.xypic.measure.lineElementLength,u:.5*r.MathJax.xypic.measure.thickness,d:.5*r.MathJax.xypic.measure.thickness}}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.em2px(.5*r.MathJax.xypic.measure.thickness),n=r.MathJax.xypic.measure.em2px(r.MathJax.xypic.measure.lineElementLength);e.createSVGElement("line",{x1:0,y1:t,x2:n,y2:t}),e.createSVGElement("line",{x1:0,y1:-t,x2:n,y2:-t})}}]),n}(ft.ArrowheadShape),ft.LineArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:0,r:r.MathJax.xypic.measure.lineElementLength,u:0,d:0}}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.em2px(r.MathJax.xypic.measure.lineElementLength);e.createSVGElement("line",{x1:0,y1:0,x2:t,y2:0})}}]),n}(ft.ArrowheadShape),ft.Dot3ArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:0,r:0,u:r.MathJax.xypic.measure.thickness,d:r.MathJax.xypic.measure.thickness}}},{key:"drawDelegate",value:function(e){r.MathJax.xypic.measure.oneem;var t=r.MathJax.xypic.measure.em2px(r.MathJax.xypic.measure.thickness),n=r.MathJax.xypic.measure.em2px(r.MathJax.xypic.measure.thickness),a=r.MathJax.xypic.measure.dottedDasharray;e.createSVGElement("line",{x1:0,y1:t,x2:n,y2:t,"stroke-dasharray":a}),e.createSVGElement("line",{x1:0,y1:0,x2:n,y2:0,"stroke-dasharray":a}),e.createSVGElement("line",{x1:0,y1:-t,x2:n,y2:-t,"stroke-dasharray":a})}}]),n}(ft.ArrowheadShape),ft.Dot2ArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:0,r:0,u:.5*r.MathJax.xypic.measure.thickness,d:.5*r.MathJax.xypic.measure.thickness}}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.em2px(.5*r.MathJax.xypic.measure.thickness),n=r.MathJax.xypic.measure.em2px(r.MathJax.xypic.measure.thickness),a=r.MathJax.xypic.measure.dottedDasharray;e.createSVGElement("line",{x1:0,y1:t,x2:n,y2:t,"stroke-dasharray":a}),e.createSVGElement("line",{x1:0,y1:-t,x2:n,y2:-t,"stroke-dasharray":a})}}]),n}(ft.ArrowheadShape),ft.DotArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:0,r:0,u:0,d:0}}},{key:"drawDelegate",value:function(e){r.MathJax.xypic.measure.oneem;var t=r.MathJax.xypic.measure.em2px(r.MathJax.xypic.measure.thickness),n=r.MathJax.xypic.measure.dottedDasharray;e.createSVGElement("line",{x1:0,y1:0,x2:t,y2:0,"stroke-dasharray":n})}}]),n}(ft.ArrowheadShape),ft.Tilde3ArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:-2*r.MathJax.xypic.measure.thickness,r:2*r.MathJax.xypic.measure.thickness,u:2*r.MathJax.xypic.measure.thickness,d:2*r.MathJax.xypic.measure.thickness}}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.em2px(r.MathJax.xypic.measure.thickness);e.createSVGElement("path",{d:"M"+-2*t+","+t+" Q"+-t+",0 0,"+t+" T"+2*t+","+t+"M"+-2*t+",0 Q"+-t+","+-t+" 0,0 T"+2*t+",0M"+-2*t+","+-t+" Q"+-t+","+-2*t+" 0,"+-t+" T"+2*t+","+-t})}}]),n}(ft.ArrowheadShape),ft.Tilde2ArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:-2*r.MathJax.xypic.measure.thickness,r:2*r.MathJax.xypic.measure.thickness,u:1.5*r.MathJax.xypic.measure.thickness,d:1.5*r.MathJax.xypic.measure.thickness}}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.em2px(r.MathJax.xypic.measure.thickness);e.createSVGElement("path",{d:"M"+-2*t+","+.5*t+" Q"+-t+","+-.5*t+" 0,"+.5*t+" T"+2*t+","+.5*t+"M"+-2*t+","+-.5*t+" Q"+-t+","+-1.5*t+" 0,"+-.5*t+" T"+2*t+","+-.5*t})}}]),n}(ft.ArrowheadShape),ft.TildeArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:-2*r.MathJax.xypic.measure.thickness,r:2*r.MathJax.xypic.measure.thickness,u:r.MathJax.xypic.measure.thickness,d:r.MathJax.xypic.measure.thickness}}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.em2px(r.MathJax.xypic.measure.thickness);e.createSVGElement("path",{d:"M"+-2*t+",0 Q"+-t+","+-t+" 0,0 T"+2*t+",0"})}}]),n}(ft.ArrowheadShape),ft.TildeArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:-2*r.MathJax.xypic.measure.thickness,r:2*r.MathJax.xypic.measure.thickness,u:r.MathJax.xypic.measure.thickness,d:r.MathJax.xypic.measure.thickness}}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.em2px(r.MathJax.xypic.measure.thickness);e.createSVGElement("path",{d:"M"+-2*t+",0 Q"+-t+","+-t+" 0,0 T"+2*t+",0"})}}]),n}(ft.ArrowheadShape),ft.GTGTArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){var e=r.MathJax.xypic.measure.oneem;return{l:.489*e+2*r.MathJax.xypic.measure.thickness,r:0,d:.147*e,u:.147*e}}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.oneem,n=r.MathJax.xypic.measure.thickness,a=r.MathJax.xypic.measure.em2px(2*n);e.createSVGElement("path",{d:"M"+-a+",0 Q"+(r.MathJax.xypic.measure.em2px(-.222*t)-a)+","+r.MathJax.xypic.measure.em2px(.02*t)+" "+(r.MathJax.xypic.measure.em2px(-.489*t)-a)+","+r.MathJax.xypic.measure.em2px(.147*t)}),e.createSVGElement("path",{d:"M"+-a+",0 Q"+(r.MathJax.xypic.measure.em2px(-.222*t)-a)+","+r.MathJax.xypic.measure.em2px(-.02*t)+" "+(r.MathJax.xypic.measure.em2px(-.489*t)-a)+","+r.MathJax.xypic.measure.em2px(-.147*t)}),e.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(-.222*t)+","+r.MathJax.xypic.measure.em2px(.02*t)+" "+r.MathJax.xypic.measure.em2px(-.489*t)+","+r.MathJax.xypic.measure.em2px(.147*t)}),e.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(-.222*t)+","+r.MathJax.xypic.measure.em2px(-.02*t)+" "+r.MathJax.xypic.measure.em2px(-.489*t)+","+r.MathJax.xypic.measure.em2px(-.147*t)})}}]),n}(ft.ArrowheadShape),ft.UpperGTGTArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){var e=r.MathJax.xypic.measure.oneem;return{l:.489*e+2*r.MathJax.xypic.measure.thickness,r:0,d:0,u:.147*e}}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.oneem,n=r.MathJax.xypic.measure.thickness,a=r.MathJax.xypic.measure.em2px(2*n);e.createSVGElement("path",{d:"M"+-a+",0 Q"+(r.MathJax.xypic.measure.em2px(-.222*t)-a)+","+r.MathJax.xypic.measure.em2px(-.02*t)+" "+(r.MathJax.xypic.measure.em2px(-.489*t)-a)+","+r.MathJax.xypic.measure.em2px(-.147*t)}),e.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(-.222*t)+","+r.MathJax.xypic.measure.em2px(-.02*t)+" "+r.MathJax.xypic.measure.em2px(-.489*t)+","+r.MathJax.xypic.measure.em2px(-.147*t)})}}]),n}(ft.ArrowheadShape),ft.LowerGTGTArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){var e=r.MathJax.xypic.measure.oneem;return{l:.489*e+2*r.MathJax.xypic.measure.thickness,r:0,d:.147*e,u:0}}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.oneem,n=r.MathJax.xypic.measure.thickness,a=r.MathJax.xypic.measure.em2px(2*n);e.createSVGElement("path",{d:"M"+-a+",0 Q"+(r.MathJax.xypic.measure.em2px(-.222*t)-a)+","+r.MathJax.xypic.measure.em2px(.02*t)+" "+(r.MathJax.xypic.measure.em2px(-.489*t)-a)+","+r.MathJax.xypic.measure.em2px(.147*t)}),e.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(-.222*t)+","+r.MathJax.xypic.measure.em2px(.02*t)+" "+r.MathJax.xypic.measure.em2px(-.489*t)+","+r.MathJax.xypic.measure.em2px(.147*t)})}}]),n}(ft.ArrowheadShape),ft.GTGT2ArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){var e=r.MathJax.xypic.measure.oneem;return{l:.456*e+2*r.MathJax.xypic.measure.thickness,r:0,d:.229*e,u:.229*e}}},{key:"getRadius",value:function(){return.213*r.MathJax.xypic.measure.oneem}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.oneem,n=r.MathJax.xypic.measure.thickness,a=e.createGroup(e.transformBuilder().rotateDegree(-10)),i=e.createGroup(e.transformBuilder().rotateDegree(10));a.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(-.222*t)+","+r.MathJax.xypic.measure.em2px(-.02*t)+" "+r.MathJax.xypic.measure.em2px(-.489*t)+","+r.MathJax.xypic.measure.em2px(-.147*t)}),i.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(-.222*t)+","+r.MathJax.xypic.measure.em2px(.02*t)+" "+r.MathJax.xypic.measure.em2px(-.489*t)+","+r.MathJax.xypic.measure.em2px(.147*t)});var o=e.createGroup(e.transformBuilder().translate(-2*n,0).rotateDegree(-10)),u=e.createGroup(e.transformBuilder().translate(-2*n,0).rotateDegree(10));o.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(-.222*t)+","+r.MathJax.xypic.measure.em2px(-.02*t)+" "+r.MathJax.xypic.measure.em2px(-.489*t)+","+r.MathJax.xypic.measure.em2px(-.147*t)}),u.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(-.222*t)+","+r.MathJax.xypic.measure.em2px(.02*t)+" "+r.MathJax.xypic.measure.em2px(-.489*t)+","+r.MathJax.xypic.measure.em2px(.147*t)})}}]),n}(ft.ArrowheadShape),ft.GTGT3ArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){var e=r.MathJax.xypic.measure.oneem;return{l:.507*e+2*r.MathJax.xypic.measure.thickness,r:0,d:.268*e,u:.268*e}}},{key:"getRadius",value:function(){return.325*r.MathJax.xypic.measure.oneem}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.oneem,n=r.MathJax.xypic.measure.thickness,a=e.createGroup(e.transformBuilder().rotateDegree(-15)),i=e.createGroup(e.transformBuilder().rotateDegree(15));a.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(-.222*t)+","+r.MathJax.xypic.measure.em2px(-.02*t)+" "+r.MathJax.xypic.measure.em2px(-.489*t)+","+r.MathJax.xypic.measure.em2px(-.147*t)}),i.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(-.222*t)+","+r.MathJax.xypic.measure.em2px(.02*t)+" "+r.MathJax.xypic.measure.em2px(-.489*t)+","+r.MathJax.xypic.measure.em2px(.147*t)});var o=e.createGroup(e.transformBuilder().translate(-2*n,0).rotateDegree(-15)),u=e.createGroup(e.transformBuilder().translate(-2*n,0).rotateDegree(15));o.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(-.222*t)+","+r.MathJax.xypic.measure.em2px(-.02*t)+" "+r.MathJax.xypic.measure.em2px(-.489*t)+","+r.MathJax.xypic.measure.em2px(-.147*t)}),u.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(-.222*t)+","+r.MathJax.xypic.measure.em2px(.02*t)+" "+r.MathJax.xypic.measure.em2px(-.489*t)+","+r.MathJax.xypic.measure.em2px(.147*t)}),e.createSVGElement("line",{x1:0,y1:0,x2:r.MathJax.xypic.measure.em2px(-.507*t-2*n),y2:0})}}]),n}(ft.ArrowheadShape),ft.LTLTArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){var e=r.MathJax.xypic.measure.oneem;return{l:0,r:.489*e+2*r.MathJax.xypic.measure.thickness,d:.147*e,u:.147*e}}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.oneem,n=r.MathJax.xypic.measure.thickness,a=r.MathJax.xypic.measure.em2px(2*n);e.createSVGElement("path",{d:"M"+a+",0 Q"+(r.MathJax.xypic.measure.em2px(.222*t)+a)+","+r.MathJax.xypic.measure.em2px(-.02*t)+" "+(r.MathJax.xypic.measure.em2px(.489*t)+a)+","+r.MathJax.xypic.measure.em2px(-.147*t)}),e.createSVGElement("path",{d:"M"+a+",0 Q"+(r.MathJax.xypic.measure.em2px(.222*t)+a)+","+r.MathJax.xypic.measure.em2px(.02*t)+" "+(r.MathJax.xypic.measure.em2px(.489*t)+a)+","+r.MathJax.xypic.measure.em2px(.147*t)}),e.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(.222*t)+","+r.MathJax.xypic.measure.em2px(-.02*t)+" "+r.MathJax.xypic.measure.em2px(.489*t)+","+r.MathJax.xypic.measure.em2px(-.147*t)}),e.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(.222*t)+","+r.MathJax.xypic.measure.em2px(.02*t)+" "+r.MathJax.xypic.measure.em2px(.489*t)+","+r.MathJax.xypic.measure.em2px(.147*t)})}}]),n}(ft.ArrowheadShape),ft.UpperLTLTArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){var e=r.MathJax.xypic.measure.oneem;return{l:0,r:.489*e+2*r.MathJax.xypic.measure.thickness,d:0,u:.147*e}}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.oneem,n=r.MathJax.xypic.measure.thickness,a=r.MathJax.xypic.measure.em2px(2*n);e.createSVGElement("path",{d:"M"+a+",0 Q"+(r.MathJax.xypic.measure.em2px(.222*t)+a)+","+r.MathJax.xypic.measure.em2px(-.02*t)+" "+(r.MathJax.xypic.measure.em2px(.489*t)+a)+","+r.MathJax.xypic.measure.em2px(-.147*t)}),e.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(.222*t)+","+r.MathJax.xypic.measure.em2px(-.02*t)+" "+r.MathJax.xypic.measure.em2px(.489*t)+","+r.MathJax.xypic.measure.em2px(-.147*t)})}}]),n}(ft.ArrowheadShape),ft.LowerLTLTArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){var e=r.MathJax.xypic.measure.oneem;return{l:0,r:.489*e+2*r.MathJax.xypic.measure.thickness,d:.147*e,u:0}}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.oneem,n=r.MathJax.xypic.measure.thickness,a=r.MathJax.xypic.measure.em2px(2*n);e.createSVGElement("path",{d:"M"+a+",0 Q"+(r.MathJax.xypic.measure.em2px(.222*t)+a)+","+r.MathJax.xypic.measure.em2px(.02*t)+" "+(r.MathJax.xypic.measure.em2px(.489*t)+a)+","+r.MathJax.xypic.measure.em2px(.147*t)}),e.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(.222*t)+","+r.MathJax.xypic.measure.em2px(.02*t)+" "+r.MathJax.xypic.measure.em2px(.489*t)+","+r.MathJax.xypic.measure.em2px(.147*t)})}}]),n}(ft.ArrowheadShape),ft.LTLT2ArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){var e=r.MathJax.xypic.measure.oneem;return{l:0,r:.456+e+2*r.MathJax.xypic.measure.thickness,d:.229*e,u:.229*e}}},{key:"getRadius",value:function(){return.213*r.MathJax.xypic.measure.oneem}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.oneem,n=r.MathJax.xypic.measure.thickness,a=e.createGroup(e.transformBuilder().translate(2*n,0).rotateDegree(10)),i=e.createGroup(e.transformBuilder().translate(2*n,0).rotateDegree(-10));a.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(.222*t)+","+r.MathJax.xypic.measure.em2px(-.02*t)+" "+r.MathJax.xypic.measure.em2px(.489*t)+","+r.MathJax.xypic.measure.em2px(-.147*t)}),i.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(.222*t)+","+r.MathJax.xypic.measure.em2px(.02*t)+" "+r.MathJax.xypic.measure.em2px(.489*t)+","+r.MathJax.xypic.measure.em2px(.147*t)});var o=e.createGroup(e.transformBuilder().rotateDegree(10)),u=e.createGroup(e.transformBuilder().rotateDegree(-10));o.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(.222*t)+","+r.MathJax.xypic.measure.em2px(-.02*t)+" "+r.MathJax.xypic.measure.em2px(.489*t)+","+r.MathJax.xypic.measure.em2px(-.147*t)}),u.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(.222*t)+","+r.MathJax.xypic.measure.em2px(.02*t)+" "+r.MathJax.xypic.measure.em2px(.489*t)+","+r.MathJax.xypic.measure.em2px(.147*t)})}}]),n}(ft.ArrowheadShape),ft.LTLT3ArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){var e=r.MathJax.xypic.measure.oneem;return{l:0,r:.507*e+2*r.MathJax.xypic.measure.thickness,d:.268*e,u:.268*e}}},{key:"getRadius",value:function(){return.325*r.MathJax.xypic.measure.oneem}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.oneem,n=r.MathJax.xypic.measure.thickness,a=e.createGroup(e.transformBuilder().translate(2*n,0).rotateDegree(15)),i=e.createGroup(e.transformBuilder().translate(2*n,0).rotateDegree(-15));a.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(.222*t)+","+r.MathJax.xypic.measure.em2px(-.02*t)+" "+r.MathJax.xypic.measure.em2px(.489*t)+","+r.MathJax.xypic.measure.em2px(-.147*t)}),i.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(.222*t)+","+r.MathJax.xypic.measure.em2px(.02*t)+" "+r.MathJax.xypic.measure.em2px(.489*t)+","+r.MathJax.xypic.measure.em2px(.147*t)});var o=e.createGroup(e.transformBuilder().rotateDegree(15)),u=e.createGroup(e.transformBuilder().rotateDegree(-15));o.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(.222*t)+","+r.MathJax.xypic.measure.em2px(-.02*t)+" "+r.MathJax.xypic.measure.em2px(.489*t)+","+r.MathJax.xypic.measure.em2px(-.147*t)}),u.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(.222*t)+","+r.MathJax.xypic.measure.em2px(.02*t)+" "+r.MathJax.xypic.measure.em2px(.489*t)+","+r.MathJax.xypic.measure.em2px(.147*t)}),e.createSVGElement("line",{x1:0,y1:0,x2:r.MathJax.xypic.measure.em2px(.507*t+2*n),y2:0})}}]),n}(ft.ArrowheadShape),ft.ColumnColumnArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:r.MathJax.xypic.measure.thickness,r:0,u:.5*r.MathJax.xypic.measure.lineElementLength,d:.5*r.MathJax.xypic.measure.lineElementLength}}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.thickness,n=r.MathJax.xypic.measure.em2px(.5*r.MathJax.xypic.measure.lineElementLength);e.createSVGElement("line",{x1:0,y1:n,x2:0,y2:-n}),e.createSVGElement("line",{x1:-r.MathJax.xypic.measure.em2px(t),y1:n,x2:-r.MathJax.xypic.measure.em2px(t),y2:-n})}}]),n}(ft.ArrowheadShape),ft.UpperColumnColumnArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:r.MathJax.xypic.measure.thickness,r:0,u:r.MathJax.xypic.measure.lineElementLength,d:0}}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.thickness,n=r.MathJax.xypic.measure.em2px(r.MathJax.xypic.measure.lineElementLength);e.createSVGElement("line",{x1:0,y1:0,x2:0,y2:-n}),e.createSVGElement("line",{x1:-r.MathJax.xypic.measure.em2px(t),y1:0,x2:-r.MathJax.xypic.measure.em2px(t),y2:-n})}}]),n}(ft.ArrowheadShape),ft.LowerColumnColumnArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:r.MathJax.xypic.measure.thickness,r:0,u:0,d:r.MathJax.xypic.measure.lineElementLength}}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.thickness,n=r.MathJax.xypic.measure.em2px(r.MathJax.xypic.measure.lineElementLength);e.createSVGElement("line",{x1:0,y1:0,x2:0,y2:n}),e.createSVGElement("line",{x1:-r.MathJax.xypic.measure.em2px(t),y1:0,x2:-r.MathJax.xypic.measure.em2px(t),y2:n})}}]),n}(ft.ArrowheadShape),ft.ColumnColumn2ArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:r.MathJax.xypic.measure.thickness,r:0,u:.5*(r.MathJax.xypic.measure.lineElementLength+r.MathJax.xypic.measure.thickness),d:.5*(r.MathJax.xypic.measure.lineElementLength+r.MathJax.xypic.measure.thickness)}}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.thickness,n=r.MathJax.xypic.measure.em2px(.5*(r.MathJax.xypic.measure.lineElementLength+r.MathJax.xypic.measure.thickness));e.createSVGElement("line",{x1:0,y1:n,x2:0,y2:-n}),e.createSVGElement("line",{x1:-r.MathJax.xypic.measure.em2px(t),y1:n,x2:-r.MathJax.xypic.measure.em2px(t),y2:-n})}}]),n}(ft.ArrowheadShape),ft.ColumnColumn3ArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:r.MathJax.xypic.measure.thickness,r:0,u:.5*r.MathJax.xypic.measure.lineElementLength+r.MathJax.xypic.measure.thickness,d:.5*r.MathJax.xypic.measure.lineElementLength+r.MathJax.xypic.measure.thickness}}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.thickness,n=(t=r.MathJax.xypic.measure.thickness,r.MathJax.xypic.measure.em2px(.5*r.MathJax.xypic.measure.lineElementLength+r.MathJax.xypic.measure.thickness));e.createSVGElement("line",{x1:0,y1:n,x2:0,y2:-n}),e.createSVGElement("line",{x1:-r.MathJax.xypic.measure.em2px(t),y1:n,x2:-r.MathJax.xypic.measure.em2px(t),y2:-n})}}]),n}(ft.ArrowheadShape),ft.ColumnLineArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:0,r:r.MathJax.xypic.measure.lineElementLength,u:.5*r.MathJax.xypic.measure.lineElementLength,d:.5*r.MathJax.xypic.measure.lineElementLength}}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.em2px(.5*r.MathJax.xypic.measure.lineElementLength);e.createSVGElement("line",{x1:0,y1:t,x2:0,y2:-t});var n=r.MathJax.xypic.measure.em2px(r.MathJax.xypic.measure.lineElementLength);e.createSVGElement("line",{x1:0,y1:0,x2:n,y2:0})}}]),n}(ft.ArrowheadShape),ft.UpperColumnLineArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:0,r:r.MathJax.xypic.measure.lineElementLength,u:r.MathJax.xypic.measure.lineElementLength,d:0}}},{key:"drawDelegate",value:function(e){r.MathJax.xypic.measure.thickness;var t=r.MathJax.xypic.measure.em2px(r.MathJax.xypic.measure.lineElementLength);e.createSVGElement("line",{x1:0,y1:0,x2:0,y2:-t});var n=r.MathJax.xypic.measure.em2px(r.MathJax.xypic.measure.lineElementLength);e.createSVGElement("line",{x1:0,y1:0,x2:n,y2:0})}}]),n}(ft.ArrowheadShape),ft.LowerColumnLineArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:0,r:r.MathJax.xypic.measure.lineElementLength,u:0,d:r.MathJax.xypic.measure.lineElementLength}}},{key:"drawDelegate",value:function(e){r.MathJax.xypic.measure.thickness;var t=r.MathJax.xypic.measure.em2px(r.MathJax.xypic.measure.lineElementLength);e.createSVGElement("line",{x1:0,y1:0,x2:0,y2:t});var n=r.MathJax.xypic.measure.em2px(r.MathJax.xypic.measure.lineElementLength);e.createSVGElement("line",{x1:0,y1:0,x2:n,y2:0})}}]),n}(ft.ArrowheadShape),ft.ColumnLine2ArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:0,r:r.MathJax.xypic.measure.lineElementLength,u:.5*(r.MathJax.xypic.measure.lineElementLength+r.MathJax.xypic.measure.thickness),d:.5*(r.MathJax.xypic.measure.lineElementLength+r.MathJax.xypic.measure.thickness)}}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.thickness,n=r.MathJax.xypic.measure.em2px(.5*(r.MathJax.xypic.measure.lineElementLength+r.MathJax.xypic.measure.thickness));e.createSVGElement("line",{x1:0,y1:-n,x2:0,y2:n});var a=r.MathJax.xypic.measure.em2px(.5*t),i=r.MathJax.xypic.measure.em2px(r.MathJax.xypic.measure.lineElementLength);e.createSVGElement("line",{x1:0,y1:a,x2:i,y2:a}),e.createSVGElement("line",{x1:0,y1:-a,x2:i,y2:-a})}}]),n}(ft.ArrowheadShape),ft.ColumnLine3ArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:0,r:r.MathJax.xypic.measure.lineElementLength,u:.5*r.MathJax.xypic.measure.lineElementLength+r.MathJax.xypic.measure.thickness,d:.5*r.MathJax.xypic.measure.lineElementLength+r.MathJax.xypic.measure.thickness}}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.thickness,n=r.MathJax.xypic.measure.em2px(.5*r.MathJax.xypic.measure.lineElementLength+r.MathJax.xypic.measure.thickness);e.createSVGElement("line",{x1:0,y1:-n,x2:0,y2:n});var a=r.MathJax.xypic.measure.em2px(r.MathJax.xypic.measure.lineElementLength),i=r.MathJax.xypic.measure.em2px(t);e.createSVGElement("line",{x1:0,y1:i,x2:a,y2:i}),e.createSVGElement("line",{x1:0,y1:0,x2:a,y2:0}),e.createSVGElement("line",{x1:0,y1:-i,x2:a,y2:-i})}}]),n}(ft.ArrowheadShape),ft.GTColumnArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:.489*r.MathJax.xypic.measure.oneem,r:0,u:.5*r.MathJax.xypic.measure.lineElementLength,d:.5*r.MathJax.xypic.measure.lineElementLength}}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.oneem,n=r.MathJax.xypic.measure.em2px(.5*r.MathJax.xypic.measure.lineElementLength);e.createSVGElement("line",{x1:0,y1:n,x2:0,y2:-n}),e.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(-.222*t)+","+r.MathJax.xypic.measure.em2px(.02*t)+" "+r.MathJax.xypic.measure.em2px(-.489*t)+","+r.MathJax.xypic.measure.em2px(.147*t)}),e.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(-.222*t)+","+r.MathJax.xypic.measure.em2px(-.02*t)+" "+r.MathJax.xypic.measure.em2px(-.489*t)+","+r.MathJax.xypic.measure.em2px(-.147*t)})}}]),n}(ft.ArrowheadShape),ft.GTGTColumnArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:.489*r.MathJax.xypic.measure.oneem+2*r.MathJax.xypic.measure.thickness,r:0,u:.5*r.MathJax.xypic.measure.lineElementLength,d:.5*r.MathJax.xypic.measure.lineElementLength}}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.oneem,n=r.MathJax.xypic.measure.thickness,a=r.MathJax.xypic.measure.em2px(.5*r.MathJax.xypic.measure.lineElementLength);e.createSVGElement("line",{x1:0,y1:a,x2:0,y2:-a});var i=r.MathJax.xypic.measure.em2px(2*n);e.createSVGElement("path",{d:"M"+-i+",0 Q"+(r.MathJax.xypic.measure.em2px(-.222*t)-i)+","+r.MathJax.xypic.measure.em2px(.02*t)+" "+(r.MathJax.xypic.measure.em2px(-.489*t)-i)+","+r.MathJax.xypic.measure.em2px(.147*t)}),e.createSVGElement("path",{d:"M"+-i+",0 Q"+(r.MathJax.xypic.measure.em2px(-.222*t)-i)+","+r.MathJax.xypic.measure.em2px(-.02*t)+" "+(r.MathJax.xypic.measure.em2px(-.489*t)-i)+","+r.MathJax.xypic.measure.em2px(-.147*t)}),e.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(-.222*t)+","+r.MathJax.xypic.measure.em2px(.02*t)+" "+r.MathJax.xypic.measure.em2px(-.489*t)+","+r.MathJax.xypic.measure.em2px(.147*t)}),e.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(-.222*t)+","+r.MathJax.xypic.measure.em2px(-.02*t)+" "+r.MathJax.xypic.measure.em2px(-.489*t)+","+r.MathJax.xypic.measure.em2px(-.147*t)})}}]),n}(ft.ArrowheadShape),ft.ColumnLTArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:0,r:.489*r.MathJax.xypic.measure.oneem,u:.5*r.MathJax.xypic.measure.lineElementLength,d:.5*r.MathJax.xypic.measure.lineElementLength}}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.oneem,n=(r.MathJax.xypic.measure.thickness,r.MathJax.xypic.measure.em2px(.5*r.MathJax.xypic.measure.lineElementLength));e.createSVGElement("line",{x1:0,y1:n,x2:0,y2:-n}),e.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(.222*t)+","+r.MathJax.xypic.measure.em2px(-.02*t)+" "+r.MathJax.xypic.measure.em2px(.489*t)+","+r.MathJax.xypic.measure.em2px(-.147*t)}),e.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(.222*t)+","+r.MathJax.xypic.measure.em2px(.02*t)+" "+r.MathJax.xypic.measure.em2px(.489*t)+","+r.MathJax.xypic.measure.em2px(.147*t)})}}]),n}(ft.ArrowheadShape),ft.ColumnLTLTArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:0,r:.489*r.MathJax.xypic.measure.oneem+2*r.MathJax.xypic.measure.thickness,u:.5*r.MathJax.xypic.measure.lineElementLength,d:.5*r.MathJax.xypic.measure.lineElementLength}}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.oneem,n=r.MathJax.xypic.measure.thickness,a=r.MathJax.xypic.measure.em2px(.5*r.MathJax.xypic.measure.lineElementLength);e.createSVGElement("line",{x1:0,y1:a,x2:0,y2:-a});var i=r.MathJax.xypic.measure.em2px(2*n);e.createSVGElement("path",{d:"M"+i+",0 Q"+(r.MathJax.xypic.measure.em2px(.222*t)+i)+","+r.MathJax.xypic.measure.em2px(-.02*t)+" "+(r.MathJax.xypic.measure.em2px(.489*t)+i)+","+r.MathJax.xypic.measure.em2px(-.147*t)}),e.createSVGElement("path",{d:"M"+i+",0 Q"+(r.MathJax.xypic.measure.em2px(.222*t)+i)+","+r.MathJax.xypic.measure.em2px(.02*t)+" "+(r.MathJax.xypic.measure.em2px(.489*t)+i)+","+r.MathJax.xypic.measure.em2px(.147*t)}),e.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(.222*t)+","+r.MathJax.xypic.measure.em2px(-.02*t)+" "+r.MathJax.xypic.measure.em2px(.489*t)+","+r.MathJax.xypic.measure.em2px(-.147*t)}),e.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(.222*t)+","+r.MathJax.xypic.measure.em2px(.02*t)+" "+r.MathJax.xypic.measure.em2px(.489*t)+","+r.MathJax.xypic.measure.em2px(.147*t)})}}]),n}(ft.ArrowheadShape),ft.SlashSlashArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r-Math.PI/10,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){return{l:r.MathJax.xypic.measure.thickness,r:0,u:.5*r.MathJax.xypic.measure.lineElementLength,d:.5*r.MathJax.xypic.measure.lineElementLength}}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.em2px(r.MathJax.xypic.measure.thickness),n=r.MathJax.xypic.measure.em2px(.5*r.MathJax.xypic.measure.lineElementLength);e.createSVGElement("line",{x1:0,y1:n,x2:0,y2:-n}),e.createSVGElement("line",{x1:-t,y1:n,x2:-t,y2:-n})}}]),n}(ft.ArrowheadShape),ft.LineGT2ArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){var e=r.MathJax.xypic.measure.oneem;return{l:r.MathJax.xypic.measure.lineElementLength,r:r.MathJax.xypic.measure.lineElementLength,d:.229*e,u:.229*e}}},{key:"getRadius",value:function(){return.213*r.MathJax.xypic.measure.oneem}},{key:"drawDelegate",value:function(e){var t=r.MathJax.xypic.measure.oneem,n=r.MathJax.xypic.measure.lineElementLength,a=r.MathJax.xypic.measure.em2px(n),i=.5*r.MathJax.xypic.measure.thickness,o=r.MathJax.xypic.measure.em2px(i),u=this.getRadius(),c=r.MathJax.xypic.measure.em2px(Math.sqrt(u*u-i*i)),s=e.createGroup(e.transformBuilder().translate(n,0).rotateDegree(-10)),h=e.createGroup(e.transformBuilder().translate(n,0).rotateDegree(10));s.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(-.222*t)+","+r.MathJax.xypic.measure.em2px(-.02*t)+" "+r.MathJax.xypic.measure.em2px(-.489*t)+","+r.MathJax.xypic.measure.em2px(-.147*t)}),h.createSVGElement("path",{d:"M0,0 Q"+r.MathJax.xypic.measure.em2px(-.222*t)+","+r.MathJax.xypic.measure.em2px(.02*t)+" "+r.MathJax.xypic.measure.em2px(-.489*t)+","+r.MathJax.xypic.measure.em2px(.147*t)}),e.createSVGElement("path",{d:"M"+-a+","+o+" L"+(a-c)+","+o+" M"+-a+","+-o+" L"+(a-c)+","+-o})}}]),n}(ft.ArrowheadShape),ft.TwocellEqualityArrowheadShape=function(e){ot(n,e);var t=ct(n);function n(e,r){var a;return lt(this,n),(a=t.call(this)).c=e,a.angle=r,We(ht(a),"getBoundingBox"),a}return mt(n,[{key:"getBox",value:function(){r.MathJax.xypic.measure.oneem;return{l:r.MathJax.xypic.measure.lineElementLength,r:r.MathJax.xypic.measure.lineElementLength,d:.5*r.MathJax.xypic.measure.thickness,u:.5*r.MathJax.xypic.measure.thickness}}},{key:"drawDelegate",value:function(e){r.MathJax.xypic.measure.oneem;var t=r.MathJax.xypic.measure.em2px(r.MathJax.xypic.measure.lineElementLength),n=r.MathJax.xypic.measure.em2px(.5*r.MathJax.xypic.measure.thickness);e.createSVGElement("path",{d:"M"+-t+","+n+" L"+t+","+n+" M"+-t+","+-n+" L"+t+","+-n})}}]),n}(ft.ArrowheadShape),ft.LineShape=function(e){ot(n,e);var t=ct(n);function n(e,r,a,i,o){var u;return lt(this,n),(u=t.call(this)).line=e,u.object=r,u.main=a,u.variant=i,u.bbox=o,u.holeRanges=F.empty,u}return mt(n,[{key:"sliceHole",value:function(e){this.holeRanges=this.holeRanges.prepend(e)}},{key:"draw",value:function(e){this.line.drawLine(e,this.object,this.main,this.variant,this.holeRanges)}},{key:"getBoundingBox",value:function(){return this.bbox}},{key:"toString",value:function(){return"LineShape[line:"+this.line+", object:"+this.object+", main:"+this.main+", variant:"+this.variant+"]"}}]),n}(ft),ft.CurveShape=function(e){ot(n,e);var t=ct(n);function n(e,r,a,i){var o;return lt(this,n),(o=t.call(this)).curve=e,o.objectForDrop=r,o.objectForConnect=a,o.bbox=i,o.holeRanges=F.empty,o}return mt(n,[{key:"sliceHole",value:function(e){this.holeRanges=this.holeRanges.prepend(e)}},{key:"draw",value:function(e){this.curve.drawCurve(e,this.objectForDrop,this.objectForConnect,this.holeRanges)}},{key:"getBoundingBox",value:function(){return this.bbox}},{key:"toString",value:function(){return"CurveShape[curve"+this.curve+", objectForDrop:"+(void 0!==this.objectForDrop?this.objectForDrop.toString():"null")+", objectForConnect:"+(void 0!==this.objectForConnect?this.objectForConnect.toString():"null")+"]"}}]),n}(ft);var Jt=He,Pt=function(){function e(){bt(this,e)}return kt(e,null,[{key:"createSVG",value:function(e,t,n,r,a,i,o){return new Bt(e,t,n,r,a,i,o)}}]),e}(),Ot=function(){function e(t){bt(this,e),this.xypicWrapper=t}return kt(e,[{key:"createElement",value:function(e){return this.xypicWrapper.svg(e)}},{key:"createGroup",value:function(e){return new jt(this,e)}},{key:"createChangeColorGroup",value:function(e){return new Dt(this,e)}},{key:"createSVGElement",value:function(e,t){var n=this.createElement(e);if(t)for(var r in t)if(t.hasOwnProperty(r)){var a=t[r].toString();"xlink:href"===r?this.xypicWrapper.setAttribute(n,r,a,"http://www.w3.org/1999/xlink"):this.xypicWrapper.setAttribute(n,r,a)}return this.appendChild(n),n}},{key:"appendChild",value:function(e){return this.xypicWrapper.adaptor.append(this.drawArea,e),e}},{key:"transformBuilder",value:function(){return new Et}}]),e}(),Bt=function(e){yt(n,e);var t=gt(n);function n(e,r,a,i,o,u,c){var s;bt(this,n);var h=(s=t.call(this,e)).createElement("svg");if(s.xypicWrapper.setAttribute(h,"xmlns","http://www.w3.org/2000/svg"),s.xypicWrapper.setAttribute(h,"version","1.1"),c)for(var p in c)c.hasOwnProperty(p)&&s.xypicWrapper.setAttribute(h,p,c[p].toString());h.style&&(h.style.width=MathJax.xypic.measure.Em(i),h.style.height=MathJax.xypic.measure.Em(r+a));c={fill:"none",stroke:u,"stroke-linecap":"round","stroke-width":MathJax.xypic.measure.em2px(o)};for(var l in s.drawArea=s.createElement("g"),c)c.hasOwnProperty(l)&&s.xypicWrapper.setAttribute(s.drawArea,l,c[l].toString());return s.xypicWrapper.append(h,s.drawArea),s.svg=h,s.boundingBox=void 0,s.color=u,s}return kt(n,[{key:"setHeight",value:function(e){this.xypicWrapper.setStyle(this.svg,"height",MathJax.xypic.measure.Em(e))}},{key:"setWidth",value:function(e){this.xypicWrapper.setStyle(this.svg,"width",MathJax.xypic.measure.Em(e))}},{key:"setAttribute",value:function(e,t){this.xypicWrapper.setAttribute(this.svg,e,t.toString())}},{key:"extendBoundingBox",value:function(e){this.boundingBox=at.combineRect(this.boundingBox,e)}},{key:"getOrigin",value:function(){return{x:0,y:0}}},{key:"getCurrentColor",value:function(){return this.color}}]),n}(Ot),Et=function(){function e(t){bt(this,e),this.transform=t||F.empty}return kt(e,[{key:"translate",value:function(t,n){return new e(this.transform.append(new At(t,n)))}},{key:"rotateDegree",value:function(t){return new e(this.transform.append(new Lt(t/180*Math.PI)))}},{key:"rotateRadian",value:function(t){return new e(this.transform.append(new Lt(t)))}},{key:"toString",value:function(){var e="";return this.transform.foreach((function(t){e+=t.toTranslateForm()})),e}},{key:"apply",value:function(e,t){var n={x:e,y:t};return this.transform.foreach((function(e){n=e.apply(n.x,n.y)})),n}}]),e}(),At=function(){function e(t,n){bt(this,e),this.dx=t,this.dy=n}return kt(e,[{key:"apply",value:function(e,t){return{x:e-this.dx,y:t+this.dy}}},{key:"toTranslateForm",value:function(){return"translate("+MathJax.xypic.measure.em2px(this.dx)+","+MathJax.xypic.measure.em2px(-this.dy)+") "}}]),e}(),Lt=function(){function e(t){bt(this,e),this.radian=t}return kt(e,[{key:"apply",value:function(e,t){var n=Math.cos(this.radian),r=Math.sin(this.radian);return{x:n*e+r*t,y:-r*e+n*t}}},{key:"toTranslateForm",value:function(){return"rotate("+Jt(-180*this.radian/Math.PI)+") "}}]),e}(),jt=function(e){yt(n,e);var t=gt(n);function n(e,r){var a;bt(this,n),(a=t.call(this,e.xypicWrapper)).parent=e,a.drawArea=e.createSVGElement("g",void 0===r?{}:{transform:r.toString()});var i=e.getOrigin();return a.origin=void 0===r?i:r.apply(i.x,i.y),We(wt(a),"getCurrentColor"),a}return kt(n,[{key:"remove",value:function(){this.xypicWrapper.remove(this.drawArea)}},{key:"extendBoundingBox",value:function(e){this.parent.extendBoundingBox(e)}},{key:"getOrigin",value:function(){return this.origin}},{key:"getCurrentColor",value:function(){return this.parent.getCurrentColor()}}]),n}(Ot),Dt=function(e){yt(n,e);var t=gt(n);function n(e,r){var a;return bt(this,n),(a=t.call(this,e.xypicWrapper)).parent=e,a.drawArea=e.createSVGElement("g",{stroke:r}),a.color=r,We(wt(a),"getOrigin"),a}return kt(n,[{key:"remove",value:function(){this.xypicWrapper.remove(this.drawArea)}},{key:"extendBoundingBox",value:function(e){this.parent.extendBoundingBox(e)}},{key:"getOrigin",value:function(){return this.parent.getOrigin()}},{key:"getCurrentColor",value:function(){return this.color}}]),n}(Ot);function Tt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Rt=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.shape=t,this.env=n}var t,n,r;return t=e,(n=[{key:"duplicateEnv",value:function(){var t=this.env.duplicate();return new e(this.shape,t)}},{key:"appendShapeToFront",value:function(e){e.isNone||(this.shape.isNone?this.shape=e:this.shape=new ft.CompositeShape(e,this.shape))}},{key:"appendShapeToBack",value:function(e){e.isNone||(this.shape.isNone?this.shape=e:this.shape=new ft.CompositeShape(this.shape,e))}}])&&Tt(t.prototype,n),r&&Tt(t,r),e}();function Ft(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Gt=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t>n?(this.start=n,this.end=t):(this.start=t,this.end=n)}var t,n,r;return t=e,(n=[{key:"difference",value:function(t){var n=F.empty,r=this.start,a=this.end,i=t.start,o=t.end;return a<=i||o<=r?n=n.prepend(this):r<i?n=a<=o?n.prepend(new e(r,i)):(n=n.prepend(new e(r,i))).prepend(new e(o,a)):o<a&&(n=n.prepend(new e(o,a))),n}},{key:"differenceRanges",value:function(e){var t=F.empty.prepend(this);return e.foreach((function(e){t=t.flatMap((function(t){return t.difference(e)}))})),t}},{key:"toString",value:function(){return"["+this.start+", "+this.end+"]"}}])&&Ft(t.prototype,n),r&&Ft(t,r),e}();function Vt(e){return(Vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _t(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&It(e,t)}function It(e,t){return(It=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function zt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Nt(e);if(t){var a=Nt(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Qt(this,n)}}function Qt(e,t){return!t||"object"!==Vt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Nt(e){return(Nt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ut(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wt(e,t,n){return t&&Ut(e.prototype,t),n&&Ut(e,n),e}var Ht=function(){function e(){Xt(this,e);var t=r.MathJax.xypic.measure.length2em("1mm");this.origin={x:0,y:0},this.xBase={x:t,y:0},this.yBase={x:0,y:t},this.savedPosition={},this.stateStack=F.empty,this.stackFrames=F.empty,this.stack=F.empty,this.angle=0,this.lastCurve=Yt.none,this.p=this.c=e.originPosition,this.shouldCapturePos=!1,this.capturedPositions=F.empty,this.objectmargin=r.MathJax.xypic.measure.objectmargin,this.objectheight=r.MathJax.xypic.measure.objectheight,this.objectwidth=r.MathJax.xypic.measure.objectwidth,this.labelmargin=r.MathJax.xypic.measure.labelmargin}return Wt(e,[{key:"duplicate",value:function(){var t=new e;return e.copyFields(this,t),t}},{key:"saveState",value:function(){var e=this.duplicate();this.stateStack=this.stateStack.prepend(e)}},{key:"restoreState",value:function(){if(!this.stateStack.isEmpty){var t=this.stateStack.head;this.stateStack=this.stateStack.tail,e.copyFields(t,this)}}},{key:"absVector",value:function(e,t){return{x:this.origin.x+e*this.xBase.x+t*this.yBase.x,y:this.origin.y+e*this.xBase.y+t*this.yBase.y}}},{key:"inverseAbsVector",value:function(e,t){var n=this.xBase.x,r=this.xBase.y,a=this.yBase.x,i=this.yBase.y,o=n*i-r*a,u=e-this.origin.x,c=t-this.origin.y;return{x:(i*u-a*c)/o,y:(-r*u+n*c)/o}}},{key:"setOrigin",value:function(e,t){this.origin={x:e,y:t}}},{key:"setXBase",value:function(e,t){this.xBase={x:e,y:t}}},{key:"setYBase",value:function(e,t){this.yBase={x:e,y:t}}},{key:"swapPAndC",value:function(){var e=this.p;this.p=this.c,this.c=e}},{key:"enterStackFrame",value:function(){this.stackFrames=this.stackFrames.prepend(this.stack),this.initStack()}},{key:"leaveStackFrame",value:function(){this.stackFrames.isEmpty?this.initStack():(this.stack=this.stackFrames.head,this.stackFrames=this.stackFrames.tail)}},{key:"savePos",value:function(e,t){this.savedPosition[e]=t}},{key:"startCapturePositions",value:function(){this.shouldCapturePos=!0,this.capturedPositions=F.empty}},{key:"endCapturePositions",value:function(){this.shouldCapturePos=!1;var e=this.capturedPositions;return this.capturedPositions=F.empty,e}},{key:"capturePosition",value:function(e){this.shouldCapturePos&&void 0!==e&&(this.capturedPositions=this.capturedPositions.prepend(e))}},{key:"pushPos",value:function(e){void 0!==e&&(this.stack=this.stack.prepend(e))}},{key:"popPos",value:function(){if(this.stack.isEmpty)throw new m.a("ExecutionError","cannot pop from the empty stack");var e=this.stack.head;return this.stack=this.stack.tail,e}},{key:"initStack",value:function(){this.stack=F.empty}},{key:"setStack",value:function(e){this.stack=e}},{key:"stackAt",value:function(e){return this.stack.at(e)}},{key:"lookupPos",value:function(e,t){var n=this.savedPosition[e];if(void 0===n)throw void 0!==t?new m.a("ExecutionError",t):new m.a("ExecutionError",'<pos> "'+e+'" not defined.');return n}},{key:"toString",value:function(){var e="";for(var t in this.savedPosition)this.savedPosition.hasOwnProperty(t)&&(e.length>0&&(e+=", "),e+=t.toString()+":"+this.savedPosition[t]);return"Env\n  p:"+this.p+"\n  c:"+this.c+"\n  angle:"+this.angle+"\n  lastCurve:"+this.lastCurve+"\n  savedPosition:{"+e+"}\n  origin:{x:"+this.origin.x+", y:"+this.origin.y+"}\n  xBase:{x:"+this.xBase.x+", y:"+this.xBase.y+"}\n  yBase:{x:"+this.yBase.x+", y:"+this.yBase.y+"}\n  stackFrames:"+this.stackFrames+"\n  stack:"+this.stack+"\n  shouldCapturePos:"+this.shouldCapturePos+"\n  capturedPositions:"+this.capturedPositions}}],[{key:"copyFields",value:function(e,t){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);for(var r in t.savedPosition={},e.savedPosition)e.savedPosition.hasOwnProperty(r)&&(t.savedPosition[r]=e.savedPosition[r])}}]),e}();Ht.originPosition=new at.Point(0,0);var qt=function(){function e(){Xt(this,e)}return Wt(e,[{key:"velocity",value:function(e){var t=this.dpx(e),n=this.dpy(e);return Math.sqrt(t*t+n*n)}},{key:"length",value:function(e){if(e<0||e>1)throw new m.a("ExecutionError","illegal cubic Bezier parameter t:"+e);this.buildLengthArray();var t=e*f.lengthResolution,n=Math.floor(t),r=Math.ceil(t);if(n===r)return this.lengthArray[n];var a=this.lengthArray[n];return a+(this.lengthArray[r]-a)/(r-n)*(t-n)}},{key:"tOfLength",value:function(e){this.buildLengthArray();var t,n,r,a=this.lengthArray;if(e<a[0])return 0;if(e>a[a.length-1])return 1;for(var i=0,o=a.length-2;i<=o&&(n=a[t=i+o>>1],r=a[t+1],!(e>=n&&e<=r));)e<n?o=t-1:i=t+1;var u=f.lengthResolution;return n===r?t/u:(t+(e-n)/(r-n))/u}},{key:"tOfShavedStart",value:function(e){if(e.isPoint())return 0;var t=this.tOfIntersections(e);return 0!=t.length?Math.min.apply(Math,t):void 0}},{key:"tOfShavedEnd",value:function(e){if(e.isPoint())return 1;var t=this.tOfIntersections(e);return 0!=t.length?Math.max.apply(Math,t):void 0}},{key:"shaveStart",value:function(e){if(e.isPoint())return this;var t=this.tOfIntersections(e);if(0!=t.length){var n=Math.min.apply(Math,t);return this.divide(n)[1]}}},{key:"shaveEnd",value:function(e){if(e.isPoint())return this;var t=this.tOfIntersections(e);if(0!=t.length){var n=Math.max.apply(Math,t);return this.divide(n)[0]}}},{key:"buildLengthArray",value:function(){if(void 0===this.lengthArray){var e=f.lengthResolution,t=new Array(e+1),n=0,r=.5/e,a=0,i=r/3;t[0]=0,n=this.velocity(0)+4*this.velocity(r);var o=this.velocity(2*r);for(t[1]=i*(n+o),a=2;a<=e;a++)n+=2*o+4*this.velocity((2*a-1)*r),o=this.velocity(2*a*r),t[a]=i*(n+o);this.lengthArray=t}}},{key:"drawParallelCurve",value:function(t,n){var r,a,i,o,u,c,s,h,p=this.countOfSegments()*f.interpolationResolution,l=new Array(p+1),x=new Array(p+1),m=new Array(p+1),d=new Array(p+1),y=new Array(p+1),v=Math.PI/2,g=n;for(r=0;r<=p;r++)a=r/p,l[r]=a,i=this.angle(a),u=(o=this.position(a)).x,c=o.y,s=g*Math.cos(i+v),h=g*Math.sin(i+v),x[r]=u+s,m[r]=c+h,d[r]=u-s,y[r]=c-h;e.CubicBeziers.interpolation(l,x,m).drawPrimitive(t,"none"),e.CubicBeziers.interpolation(l,d,y).drawPrimitive(t,"none")}},{key:"drawParallelDottedCurve",value:function(e,t,n){var a=1/r.MathJax.xypic.measure.em,i=a/2,o=a+t,u=this.length(1),c=Math.floor((u-a)/o),s=n;if(c>=0){var h,p=Math.PI/2,l=this.startPosition();this.endPosition();for(h=0;h<=c;h++){l=i+h*o;var x=this.tOfLength(l),m=this.angle(x),f=this.position(x),d=f.x,y=f.y,v=s*Math.cos(m+p),g=s*Math.sin(m+p);e.createSVGElement("circle",{cx:r.MathJax.xypic.measure.em2px(d+v),cy:-r.MathJax.xypic.measure.em2px(y+g),r:.12,fill:"currentColor"}),e.createSVGElement("circle",{cx:r.MathJax.xypic.measure.em2px(d-v),cy:-r.MathJax.xypic.measure.em2px(y-g),r:.12,fill:"currentColor"})}}}},{key:"drawParallelDashedCurve",value:function(t,n,r){var a,i,o,u,c,s,h,p,l=this.length(1),x=Math.floor((l-n)/(2*n)),m=2*x+1,f=(l-n)/2-x*n,d=new Array(x+1),y=new Array(x+1),v=new Array(x+1),g=new Array(x+1),M=new Array(x+1),w=Math.PI/2,S=r;for(a=0;a<=m;a++)i=this.tOfLength(f+a*n),d[a]=i,o=this.angle(i),c=(u=this.position(i)).x,s=u.y,h=S*Math.cos(o+w),p=S*Math.sin(o+w),y[a]=c+h,v[a]=s+p,g[a]=c-h,M[a]=s-p;e.CubicBeziers.interpolation(d,y,v).drawSkipped(t),e.CubicBeziers.interpolation(d,g,M).drawSkipped(t)}},{key:"drawSquigCurve",value:function(e,t){var n=r.MathJax.xypic.measure.length2em("0.15em"),a=this.length(1),i=4*n,o=n;if(a>=i){var u,c,s,h,p,l,x,m,f,d=Math.floor(a/i),y=(a-d*i)/2,v=Math.PI/2;switch(t){case"3":u=y,c=this.tOfLength(u),s=this.position(c),h=this.angle(c),p=o*Math.cos(h+v),l=o*Math.sin(h+v),x="M"+r.MathJax.xypic.measure.em2px(s.x+p)+","+r.MathJax.xypic.measure.em2px(-s.y-l),m="M"+r.MathJax.xypic.measure.em2px(s.x)+","+r.MathJax.xypic.measure.em2px(-s.y),f="M"+r.MathJax.xypic.measure.em2px(s.x-p)+","+r.MathJax.xypic.measure.em2px(-s.y+l);for(var g=0;g<d;g++)u=y+i*g+n,c=this.tOfLength(u),s=this.position(c),h=this.angle(c),p=o*Math.cos(h+v),l=o*Math.sin(h+v),x+=" Q"+r.MathJax.xypic.measure.em2px(s.x+2*p)+","+r.MathJax.xypic.measure.em2px(-s.y-2*l),m+=" Q"+r.MathJax.xypic.measure.em2px(s.x+p)+","+r.MathJax.xypic.measure.em2px(-s.y-l),f+=" Q"+r.MathJax.xypic.measure.em2px(s.x)+","+r.MathJax.xypic.measure.em2px(-s.y),u=y+i*g+2*n,c=this.tOfLength(u),s=this.position(c),h=this.angle(c),p=o*Math.cos(h+v),l=o*Math.sin(h+v),x+=" "+r.MathJax.xypic.measure.em2px(s.x+p)+","+r.MathJax.xypic.measure.em2px(-s.y-l),m+=" "+r.MathJax.xypic.measure.em2px(s.x)+","+r.MathJax.xypic.measure.em2px(-s.y),f+=" "+r.MathJax.xypic.measure.em2px(s.x-p)+","+r.MathJax.xypic.measure.em2px(-s.y+l),u=y+i*g+3*n,c=this.tOfLength(u),s=this.position(c),h=this.angle(c),p=o*Math.cos(h+v),l=o*Math.sin(h+v),x+=" Q"+r.MathJax.xypic.measure.em2px(s.x)+","+r.MathJax.xypic.measure.em2px(-s.y),m+=" Q"+r.MathJax.xypic.measure.em2px(s.x-p)+","+r.MathJax.xypic.measure.em2px(-s.y+l),f+=" "+r.MathJax.xypic.measure.em2px(s.x-2*p)+","+r.MathJax.xypic.measure.em2px(-s.y+2*l),u=y+i*(g+1),c=this.tOfLength(u),s=this.position(c),h=this.angle(c),p=o*Math.cos(h+v),l=o*Math.sin(h+v),x+=" "+r.MathJax.xypic.measure.em2px(s.x+p)+","+r.MathJax.xypic.measure.em2px(-s.y-l),m+=" "+r.MathJax.xypic.measure.em2px(s.x)+","+r.MathJax.xypic.measure.em2px(-s.y),f+=" "+r.MathJax.xypic.measure.em2px(s.x-p)+","+r.MathJax.xypic.measure.em2px(-s.y+l);e.createSVGElement("path",{d:x}),e.createSVGElement("path",{d:m}),e.createSVGElement("path",{d:f});break;case"2":u=y,c=this.tOfLength(u),s=this.position(c),h=this.angle(c),p=o*Math.cos(h+v)/2,l=o*Math.sin(h+v)/2,x="M"+r.MathJax.xypic.measure.em2px(s.x+p)+","+r.MathJax.xypic.measure.em2px(-s.y-l),m="M"+r.MathJax.xypic.measure.em2px(s.x-p)+","+r.MathJax.xypic.measure.em2px(-s.y+l);for(g=0;g<d;g++)u=y+i*g+n,c=this.tOfLength(u),s=this.position(c),h=this.angle(c),p=o*Math.cos(h+v)/2,l=o*Math.sin(h+v)/2,x+=" Q"+r.MathJax.xypic.measure.em2px(s.x+3*p)+","+r.MathJax.xypic.measure.em2px(-s.y-3*l),m+=" Q"+r.MathJax.xypic.measure.em2px(s.x+p)+","+r.MathJax.xypic.measure.em2px(-s.y-l),u=y+i*g+2*n,c=this.tOfLength(u),s=this.position(c),h=this.angle(c),p=o*Math.cos(h+v)/2,l=o*Math.sin(h+v)/2,x+=" "+r.MathJax.xypic.measure.em2px(s.x+p)+","+r.MathJax.xypic.measure.em2px(-s.y-l),m+=" "+r.MathJax.xypic.measure.em2px(s.x-p)+","+r.MathJax.xypic.measure.em2px(-s.y+l),u=y+i*g+3*n,c=this.tOfLength(u),s=this.position(c),h=this.angle(c),p=o*Math.cos(h+v)/2,l=o*Math.sin(h+v)/2,x+=" Q"+r.MathJax.xypic.measure.em2px(s.x-p)+","+r.MathJax.xypic.measure.em2px(-s.y+l),m+=" Q"+r.MathJax.xypic.measure.em2px(s.x-3*p)+","+r.MathJax.xypic.measure.em2px(-s.y+3*l),u=y+i*(g+1),c=this.tOfLength(u),s=this.position(c),h=this.angle(c),p=o*Math.cos(h+v)/2,l=o*Math.sin(h+v)/2,x+=" "+r.MathJax.xypic.measure.em2px(s.x+p)+","+r.MathJax.xypic.measure.em2px(-s.y-l),m+=" "+r.MathJax.xypic.measure.em2px(s.x-p)+","+r.MathJax.xypic.measure.em2px(-s.y+l);e.createSVGElement("path",{d:x}),e.createSVGElement("path",{d:m});break;default:u=y,c=this.tOfLength(u),s=this.position(c),x="M"+r.MathJax.xypic.measure.em2px(s.x)+","+r.MathJax.xypic.measure.em2px(-s.y);for(g=0;g<d;g++)u=y+i*g+n,c=this.tOfLength(u),s=this.position(c),h=this.angle(c),p=o*Math.cos(h+v),l=o*Math.sin(h+v),x+=" Q"+r.MathJax.xypic.measure.em2px(s.x+p)+","+r.MathJax.xypic.measure.em2px(-s.y-l),u=y+i*g+2*n,c=this.tOfLength(u),s=this.position(c),x+=" "+r.MathJax.xypic.measure.em2px(s.x)+","+r.MathJax.xypic.measure.em2px(-s.y),u=y+i*g+3*n,c=this.tOfLength(u),s=this.position(c),h=this.angle(c),p=o*Math.cos(h+v),l=o*Math.sin(h+v),x+=" Q"+r.MathJax.xypic.measure.em2px(s.x-p)+","+r.MathJax.xypic.measure.em2px(-s.y+l),u=y+i*(g+1),c=this.tOfLength(u),s=this.position(c),x+=" "+r.MathJax.xypic.measure.em2px(s.x)+","+r.MathJax.xypic.measure.em2px(-s.y);e.createSVGElement("path",{d:x})}}}},{key:"drawDashSquigCurve",value:function(e,t){var n=r.MathJax.xypic.measure.thickness,a=this.length(1),i=4*n,o=n;if(a>=i){var u,c,s,h,p,l,x,m,f,d=Math.floor((a-i)/2/i),y=(a-i)/2-d*i,v=Math.PI/2;switch(t){case"3":x=m=f="";for(var g=0;g<=d;g++)u=y+i*g*2,c=this.tOfLength(u),s=this.position(c),h=this.angle(c),p=o*Math.cos(h+v),l=o*Math.sin(h+v),x+=" M"+r.MathJax.xypic.measure.em2px(s.x+p)+","+r.MathJax.xypic.measure.em2px(-s.y-l),m+=" M"+r.MathJax.xypic.measure.em2px(s.x)+","+r.MathJax.xypic.measure.em2px(-s.y),f+=" M"+r.MathJax.xypic.measure.em2px(s.x-p)+","+r.MathJax.xypic.measure.em2px(-s.y+l),u=y+i*g*2+n,c=this.tOfLength(u),s=this.position(c),h=this.angle(c),p=o*Math.cos(h+v),l=o*Math.sin(h+v),x+=" Q"+r.MathJax.xypic.measure.em2px(s.x+2*p)+","+r.MathJax.xypic.measure.em2px(-s.y-2*l),m+=" Q"+r.MathJax.xypic.measure.em2px(s.x+p)+","+r.MathJax.xypic.measure.em2px(-s.y-l),f+=" Q"+r.MathJax.xypic.measure.em2px(s.x)+","+r.MathJax.xypic.measure.em2px(-s.y),u=y+i*g*2+2*n,c=this.tOfLength(u),s=this.position(c),h=this.angle(c),p=o*Math.cos(h+v),l=o*Math.sin(h+v),x+=" "+r.MathJax.xypic.measure.em2px(s.x+p)+","+r.MathJax.xypic.measure.em2px(-s.y-l),m+=" "+r.MathJax.xypic.measure.em2px(s.x)+","+r.MathJax.xypic.measure.em2px(-s.y),f+=" "+r.MathJax.xypic.measure.em2px(s.x-p)+","+r.MathJax.xypic.measure.em2px(-s.y+l),u=y+i*g*2+3*n,c=this.tOfLength(u),s=this.position(c),h=this.angle(c),p=o*Math.cos(h+v),l=o*Math.sin(h+v),x+=" Q"+r.MathJax.xypic.measure.em2px(s.x)+","+r.MathJax.xypic.measure.em2px(-s.y),m+=" Q"+r.MathJax.xypic.measure.em2px(s.x-p)+","+r.MathJax.xypic.measure.em2px(-s.y+l),f+=" "+r.MathJax.xypic.measure.em2px(s.x-2*p)+","+r.MathJax.xypic.measure.em2px(-s.y+2*l),u=y+i*(2*g+1),c=this.tOfLength(u),s=this.position(c),h=this.angle(c),p=o*Math.cos(h+v),l=o*Math.sin(h+v),x+=" "+r.MathJax.xypic.measure.em2px(s.x+p)+","+r.MathJax.xypic.measure.em2px(-s.y-l),m+=" "+r.MathJax.xypic.measure.em2px(s.x)+","+r.MathJax.xypic.measure.em2px(-s.y),f+=" "+r.MathJax.xypic.measure.em2px(s.x-p)+","+r.MathJax.xypic.measure.em2px(-s.y+l);e.createSVGElement("path",{d:x}),e.createSVGElement("path",{d:m}),e.createSVGElement("path",{d:f});break;case"2":x=m="";for(g=0;g<=d;g++)u=y+i*g*2,c=this.tOfLength(u),s=this.position(c),h=this.angle(c),p=o*Math.cos(h+v)/2,l=o*Math.sin(h+v)/2,x+=" M"+r.MathJax.xypic.measure.em2px(s.x+p)+","+r.MathJax.xypic.measure.em2px(-s.y-l),m+=" M"+r.MathJax.xypic.measure.em2px(s.x-p)+","+r.MathJax.xypic.measure.em2px(-s.y+l),u=y+i*g*2+n,c=this.tOfLength(u),s=this.position(c),h=this.angle(c),p=o*Math.cos(h+v)/2,l=o*Math.sin(h+v)/2,x+=" Q"+r.MathJax.xypic.measure.em2px(s.x+3*p)+","+r.MathJax.xypic.measure.em2px(-s.y-3*l),m+=" Q"+r.MathJax.xypic.measure.em2px(s.x+p)+","+r.MathJax.xypic.measure.em2px(-s.y-l),u=y+i*g*2+2*n,c=this.tOfLength(u),s=this.position(c),h=this.angle(c),p=o*Math.cos(h+v)/2,l=o*Math.sin(h+v)/2,x+=" "+r.MathJax.xypic.measure.em2px(s.x+p)+","+r.MathJax.xypic.measure.em2px(-s.y-l),m+=" "+r.MathJax.xypic.measure.em2px(s.x-p)+","+r.MathJax.xypic.measure.em2px(-s.y+l),u=y+i*g*2+3*n,c=this.tOfLength(u),s=this.position(c),h=this.angle(c),p=o*Math.cos(h+v)/2,l=o*Math.sin(h+v)/2,x+=" Q"+r.MathJax.xypic.measure.em2px(s.x-p)+","+r.MathJax.xypic.measure.em2px(-s.y+l),m+=" Q"+r.MathJax.xypic.measure.em2px(s.x-3*p)+","+r.MathJax.xypic.measure.em2px(-s.y+3*l),u=y+i*(2*g+1),c=this.tOfLength(u),s=this.position(c),h=this.angle(c),p=o*Math.cos(h+v)/2,l=o*Math.sin(h+v)/2,x+=" "+r.MathJax.xypic.measure.em2px(s.x+p)+","+r.MathJax.xypic.measure.em2px(-s.y-l),m+=" "+r.MathJax.xypic.measure.em2px(s.x-p)+","+r.MathJax.xypic.measure.em2px(-s.y+l);e.createSVGElement("path",{d:x}),e.createSVGElement("path",{d:m});break;default:x="";for(g=0;g<=d;g++)u=y+i*g*2,c=this.tOfLength(u),s=this.position(c),x+=" M"+r.MathJax.xypic.measure.em2px(s.x)+","+r.MathJax.xypic.measure.em2px(-s.y),u=y+i*g*2+n,c=this.tOfLength(u),s=this.position(c),h=this.angle(c),p=o*Math.cos(h+v),l=o*Math.sin(h+v),x+=" Q"+r.MathJax.xypic.measure.em2px(s.x+p)+","+r.MathJax.xypic.measure.em2px(-s.y-l),u=y+i*g*2+2*n,c=this.tOfLength(u),s=this.position(c),x+=" "+r.MathJax.xypic.measure.em2px(s.x)+","+r.MathJax.xypic.measure.em2px(-s.y),u=y+i*g*2+3*n,c=this.tOfLength(u),s=this.position(c),h=this.angle(c),p=o*Math.cos(h+v),l=o*Math.sin(h+v),x+=" Q"+r.MathJax.xypic.measure.em2px(s.x-p)+","+r.MathJax.xypic.measure.em2px(-s.y+l),u=y+i*(2*g+1),c=this.tOfLength(u),s=this.position(c),x+=" "+r.MathJax.xypic.measure.em2px(s.x)+","+r.MathJax.xypic.measure.em2px(-s.y);e.createSVGElement("path",{d:x})}}}},{key:"drawCurve",value:function(e,t,n,r){if(r.isEmpty)this._drawCurve(e,t,n);else{var a=new Gt(0,1).differenceRanges(r),i=this;a.foreach((function(r){i.slice(r.start,r.end)._drawCurve(e,t,n)}))}}},{key:"_drawCurve",value:function(e,t,n){var a,i=r.MathJax.xypic.measure.length2em("0.15em");if(void 0!==n){var o=n.dirMain(),u=n.dirVariant();switch(o){case"=":o="-",u="2";break;case"==":o="--",u="2";break;case":":case"::":o=".",u="2"}switch(o){case"":break;case"-":switch(u){case"2":a=i/2,this.drawParallelCurve(e,a);break;case"3":a=i,this.drawParallelCurve(e,a),this.drawPrimitive(e,"none");break;default:a=0,this.drawPrimitive(e,"none")}break;case".":case"..":switch(u){case"2":a=i/2,this.drawParallelDottedCurve(e,i,a);break;case"3":a=i,this.drawParallelDottedCurve(e,i,a),this.drawPrimitive(e,r.MathJax.xypic.measure.dottedDasharray);break;default:a=0,this.drawPrimitive(e,r.MathJax.xypic.measure.dottedDasharray)}break;case"--":var c=3*i;if((g=this.length(1))>=c)switch(u){case"2":a=i/2,this.drawParallelDashedCurve(e,c,a);break;case"3":a=i,this.drawParallelDashedCurve(e,c,a);var s=(g-c)/2-Math.floor((g-c)/2/c)*c,h=this.tOfLength(s);this.divide(h)[1].drawPrimitive(e,r.MathJax.xypic.measure.em2px(c)+" "+r.MathJax.xypic.measure.em2px(c));break;default:a=0;s=(g-c)/2-Math.floor((g-c)/2/c)*c,h=this.tOfLength(s);this.divide(h)[1].drawPrimitive(e,r.MathJax.xypic.measure.em2px(c)+" "+r.MathJax.xypic.measure.em2px(c))}break;case"~":switch(this.drawSquigCurve(e,u),u){case"2":a=1.5*i;break;case"3":a=2*i;break;default:a=0}break;case"~~":switch(this.drawDashSquigCurve(e,u),u){case"2":a=1.5*i;break;case"3":a=2*i;break;default:a=0}break;default:(w=new Ht).c=Ht.originPosition;var p=new Rt(ft.none,w),l=n.boundingBox(p);if(null==l)return;var x,m,f=l.l,d=f+l.r;if(void 0!==t){var y=t.boundingBox(p);void 0!==y&&(x=(m=y.l)+y.r)}else x=0;var v=d+x;0==v&&(v=r.MathJax.xypic.measure.strokeWidth);var g=this.length(1);if(0==(J=Math.floor(g/v)))return;s=(g-J*v)/2,p=new Rt(ft.none,w);for(var M=0;M<J;M++){P=s+M*v,void 0!==t&&(O=this.tOfLength(P+m),w.c=this.position(O),w.angle=this.angle(O),t.toDropShape(p).draw(e)),O=this.tOfLength(P+x+f),w.c=this.position(O),w.angle=this.angle(O);n.toDropShape(p).draw(e)}}}else{var w;(w=new Ht).c=Ht.originPosition;p=new Rt(ft.none,w);var S=t,b=S.boundingBox(p);if(void 0===b)return;var C=b.l+b.r,k=C;0==k&&(k=r.MathJax.xypic.measure.strokeWidth);var J;g=this.length(1);if(0==(J=Math.floor(g/k)))return;for(s=(g-J*k+k-C)/2+b.l,p=new Rt(ft.none,w),M=0;M<J;M++){var P=s+M*k,O=this.tOfLength(P);w.c=this.position(O),w.angle=0,S.toDropShape(p).draw(e)}}}},{key:"toShape",value:function(e,t,n){var a,i=e.env,o=r.MathJax.xypic.measure.length2em("0.15em"),u=ft.none;if(void 0!==n){var c=n.dirMain(),s=n.dirVariant();switch(c){case"=":c="-",s="2";break;case"==":c="--",s="2";break;case":":case"::":c=".",s="2"}switch(c){case"":a=0;break;case"-":case".":case"..":switch(s){case"2":a=o/2;break;case"3":a=o;break;default:a=0}break;case"--":var h=3*o;if((d=this.length(1))>=h)switch(s){case"2":a=o/2;break;case"3":a=o;break;default:a=0}break;case"~":case"~~":switch(s){case"2":a=1.5*o;break;case"3":a=2*o;break;default:a=0}break;default:var p=n.boundingBox(e);if(null==p)return i.angle=0,i.lastCurve=Yt.none,ft.none;a=Math.max(p.u,p.d);var l,x=p.l+p.r;if(void 0!==t){var m=t.boundingBox(e);void 0!==m&&(l=m.l+m.r,a=Math.max(a,m.u,m.d))}else l=0;var f=x+l;0==f&&(f=r.MathJax.xypic.measure.strokeWidth);var d=this.length(1);return 0==Math.floor(d/f)?(i.angle=0,i.lastCurve=Yt.none,ft.none):(u=new ft.CurveShape(this,t,n,this.boundingBox(a)),e.appendShapeToFront(u),u)}return void 0===a?ft.none:(u=new ft.CurveShape(this,t,n,this.boundingBox(a)),e.appendShapeToFront(u),u)}if(void 0!==t){var y=t.boundingBox(e);if(null==y)return i.angle=0,i.lastCurve=Yt.none,ft.none;var v=y.l+y.r;0==v&&(v=r.MathJax.xypic.measure.strokeWidth);d=this.length(1);return 0==Math.floor(d/v)?(i.angle=0,i.lastCurve=Yt.none,ft.none):(a=Math.max(y.u,y.d),u=new ft.CurveShape(this,t,n,this.boundingBox(a)),e.appendShapeToFront(u),u)}return u}}],[{key:"sign",value:function(e){return e>0?1:0===e?0:-1}},{key:"solutionsOfCubicEq",value:function(t,n,r,a){if(0===t)return e.solutionsOfQuadEq(n,r,a);var i=n/3/t,o=r/t,u=i*i-o/3,c=-(a/t)/2+o*i/2-i*i*i,s=c*c-u*u*u;if(0===s){var h=2*(f=Math.pow(c,1/3))-i,p=-f-i;return e.filterByIn0to1([h,p])}if(s>0){var l=c+e.sign(c)*Math.sqrt(s),x=(m=e.sign(l)*Math.pow(Math.abs(l),1/3))+(f=u/m)-i;return e.filterByIn0to1([x])}var m=2*Math.sqrt(u),f=Math.acos(2*c/u/m),d=(h=m*Math.cos(f/3)-i,p=m*Math.cos((f+2*Math.PI)/3)-i,m*Math.cos((f+4*Math.PI)/3)-i);return e.filterByIn0to1([h,p,d])}},{key:"solutionsOfQuadEq",value:function(t,n,r){if(0===t)return e.solutionsOfLinearEq(n,r);var a=n*n-4*r*t;if(a>=0){var i=Math.sqrt(a),o=(-n+i)/2/t,u=(-n-i)/2/t;return e.filterByIn0to1([o,u])}return[]}},{key:"solutionsOfLinearEq",value:function(t,n){return 0===t?0===n?0:[]:e.filterByIn0to1([-n/t])}},{key:"filterByIn0to1",value:function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];r>=0&&r<=1&&t.push(r)}return t}}]),e}();qt.QuadBezier=function(e){_t(n,e);var t=zt(n);function n(e,r,a){var i;Xt(this,n),(i=t.call(this)).cp0=e,i.cp1=r,i.cp2=a;var o=e.x,u=2*(r.x-e.x),c=a.x-2*r.x+e.x;i.px=function(e){return o+e*u+e*e*c},i.dpx=function(e){return u+2*e*c};var s=e.y,h=2*(r.y-e.y),p=a.y-2*r.y+e.y;return i.py=function(e){return s+e*h+e*e*p},i.dpy=function(e){return h+2*e*p},i}return Wt(n,[{key:"startPosition",value:function(){return this.cp0}},{key:"endPosition",value:function(){return this.cp2}},{key:"position",value:function(e){return new at.Point(this.px(e),this.py(e))}},{key:"derivative",value:function(e){return new at.Point(this.dpx(e),this.dpy(e))}},{key:"angle",value:function(e){return Math.atan2(this.dpy(e),this.dpx(e))}},{key:"boundingBox",value:function(e){var t=this.maxMin(this.cp0.x,this.cp1.x,this.cp2.x,e),n=this.maxMin(this.cp0.y,this.cp1.y,this.cp2.y,e);if(0===e)return new at.Rect(this.cp0.x,this.cp0.y,{l:this.cp0.x-t.min,r:t.max-this.cp0.x,u:n.max-this.cp0.y,d:this.cp0.y-n.min});var r=Math.PI/2,a=this.cp0.x,i=this.cp0.y,o=this.cp2.x,u=this.cp2.y,c=this.angle(0)+r,s=this.angle(1)+r,h=e*Math.cos(c),p=e*Math.sin(c),l=e*Math.cos(s),x=e*Math.sin(s),m=Math.min(t.min,a+h,a-h,o+l,o-l),f=Math.max(t.max,a+h,a-h,o+l,o-l),d=Math.min(n.min,i+p,i-p,u+x,u-x),y=Math.max(n.max,i+p,i-p,u+x,u-x);return new at.Rect(a,i,{l:a-m,r:f-a,u:y-i,d:i-d})}},{key:"maxMin",value:function(e,t,n,r){var a,i;e>n?(a=e,i=n):(a=n,i=e);var o,u,c=Ue,s=c(e),h=c(t-e),p=c(n-2*t+e);return 0!=p&&(u=-h/p)>0&&u<1&&(o=function(e){return s+2*e*h+e*e*p}(u),a=Math.max(a,o+r,o-r),i=Math.min(i,o+r,o-r)),{min:i,max:a}}},{key:"divide",value:function(e){if(e<0||e>1)throw new m.a("ExecutionError","illegal quadratic Bezier parameter t:"+e);var t=this.cp0.x,n=this.cp1.x,r=this.cp2.x,a=this.cp0.y,i=this.cp1.y,o=this.cp2.y,u=this.px(e),c=this.py(e),s=this.cp0,h=new at.Point(t+e*(n-t),a+e*(i-a)),p=new at.Point(u,c),l=p,x=new at.Point(n+e*(r-n),i+e*(o-i)),f=this.cp2;return[new qt.QuadBezier(s,h,p),new qt.QuadBezier(l,x,f)]}},{key:"slice",value:function(e,t){if(!(e>=t)){if(e<0&&(e=0),t>1&&(t=1),0===e&&1===t)return this;this.cp0.x;var n=this.cp1.x,r=this.cp2.x,a=(this.cp0.y,this.cp1.y),i=this.cp2.y,o=this.px(e),u=this.py(e),c=n+e*(r-n),s=a+e*(i-a),h=new at.Point(o,u),p=new at.Point(o+t*(c-o),u+t*(s-u)),l=new at.Point(this.px(t),this.py(t));return new qt.QuadBezier(h,p,l)}}},{key:"tOfIntersections",value:function(e){if(e.isPoint())return[];if(e.isRect()){var t,n=e.x+e.r,r=e.x-e.l,a=e.y+e.u,i=e.y-e.d,o=Ue,u=this.cp0.x,c=this.cp1.x,s=this.cp2.x,h=o(u),p=o(2*(c-u)),l=o(s-2*c+u),x=function(e){return h+e*p+e*e*l},m=this.cp0.y,f=this.cp1.y,d=this.cp2.y,y=o(m),v=o(2*(f-m)),g=o(d-2*f+m),M=function(e){return y+e*v+e*e*g},w=[];t=(t=qt.solutionsOfQuadEq(l,p,h-n)).concat(qt.solutionsOfQuadEq(l,p,h-r));for(var S=0;S<t.length;S++){(k=M(_=t[S]))>=i&&k<=a&&w.push(_)}t=(t=qt.solutionsOfQuadEq(g,v,y-a)).concat(qt.solutionsOfQuadEq(g,v,y-i));for(S=0;S<t.length;S++){(C=x(_=t[S]))>=r&&C<=n&&w.push(_)}return w}if(e.isCircle()){var b=Math.PI,C=e.x,k=e.y,J=e.l,P=e.r,O=e.u,B=e.d,E=C+(P-J)/2,A=k+(O-B)/2,L=(n=(J+P)/2,(O+B)/2),j=b/180,D=new Zt.Arc(E,A,n,L,-b-j,-b/2+j),T=new Zt.Arc(E,A,n,L,-b/2-j,0+j),R=new Zt.Arc(E,A,n,L,0-j,b/2+j),F=new Zt.Arc(E,A,n,L,b/2-j,b+j),G=new Zt.QuadBezier(this,0,1),V=[];V=(V=(V=(V=V.concat(Zt.findIntersections(D,G))).concat(Zt.findIntersections(T,G))).concat(Zt.findIntersections(R,G))).concat(Zt.findIntersections(F,G));for(w=[],S=0;S<V.length;S++){var _=(V[S][1].min+V[S][1].max)/2;w.push(_)}return w}}},{key:"countOfSegments",value:function(){return 1}},{key:"drawPrimitive",value:function(e,t){var n=this.cp0,a=this.cp1,i=this.cp2;e.createSVGElement("path",{d:"M"+r.MathJax.xypic.measure.em2px(n.x)+","+r.MathJax.xypic.measure.em2px(-n.y)+" Q"+r.MathJax.xypic.measure.em2px(a.x)+","+r.MathJax.xypic.measure.em2px(-a.y)+" "+r.MathJax.xypic.measure.em2px(i.x)+","+r.MathJax.xypic.measure.em2px(-i.y),"stroke-dasharray":t})}},{key:"toString",value:function(){return"QuadBezier("+this.cp0.x+", "+this.cp0.y+")-("+this.cp1.x+", "+this.cp1.y+")-("+this.cp2.x+", "+this.cp2.y+")"}}]),n}(qt),qt.CubicBezier=function(e){_t(n,e);var t=zt(n);function n(e,r,a,i){var o;Xt(this,n),(o=t.call(this)).cp0=e,o.cp1=r,o.cp2=a,o.cp3=i;var u=e.x,c=3*(r.x-e.x),s=3*(a.x-2*r.x+e.x),h=i.x-3*a.x+3*r.x-e.x;o.px=function(e){return u+e*c+e*e*s+e*e*e*h},o.dpx=function(e){return c+2*e*s+3*e*e*h};var p=e.y,l=3*(r.y-e.y),x=3*(a.y-2*r.y+e.y),m=i.y-3*a.y+3*r.y-e.y;return o.py=function(e){return p+e*l+e*e*x+e*e*e*m},o.dpy=function(e){return l+2*e*x+3*e*e*m},o}return Wt(n,[{key:"startPosition",value:function(){return this.cp0}},{key:"endPosition",value:function(){return this.cp3}},{key:"position",value:function(e){return new at.Point(this.px(e),this.py(e))}},{key:"derivative",value:function(e){return new at.Point(this.dpx(e),this.dpy(e))}},{key:"angle",value:function(e){return Math.atan2(this.dpy(e),this.dpx(e))}},{key:"boundingBox",value:function(e){var t=this.maxMin(this.cp0.x,this.cp1.x,this.cp2.x,this.cp3.x,e),n=this.maxMin(this.cp0.y,this.cp1.y,this.cp2.y,this.cp3.y,e);if(0===e)return new at.Rect(this.cp0.x,this.cp0.y,{l:this.cp0.x-t.min,r:t.max-this.cp0.x,u:n.max-this.cp0.y,d:this.cp0.y-n.min});var r=Math.PI/2,a=this.cp0.x,i=this.cp0.y,o=this.cp3.x,u=this.cp3.y,c=this.angle(0)+r,s=this.angle(1)+r,h=e*Math.cos(c),p=e*Math.sin(c),l=e*Math.cos(s),x=e*Math.sin(s),m=Math.min(t.min,a+h,a-h,o+l,o-l),f=Math.max(t.max,a+h,a-h,o+l,o-l),d=Math.min(n.min,i+p,i-p,u+x,u-x),y=Math.max(n.max,i+p,i-p,u+x,u-x);return new at.Rect(a,i,{l:a-m,r:f-a,u:y-i,d:i-d})}},{key:"maxMin",value:function(e,t,n,r,a){var i,o;e>r?(i=e,o=r):(i=r,o=e);var u,c=Ue,s=c(e),h=c(t-e),p=c(n-2*t+e),l=c(r-3*n+3*t-e),x=function(e){e>0&&e<1&&(u=function(e){return s+3*e*h+3*e*e*p+e*e*e*l}(e),i=Math.max(i,u+a,u-a),o=Math.min(o,u+a,u-a))};if(0==l)0!=p&&x(-h/p/2);else{var m=p*p-h*l;m>0?(x((-p+Math.sqrt(m))/l),x((-p-Math.sqrt(m))/l)):0==m&&x(-p/l)}return{min:o,max:i}}},{key:"divide",value:function(e){if(e<0||e>1)throw new m.a("ExecutionError","illegal cubic Bezier parameter t:"+e);var t=this.cp0.x,n=this.cp1.x,r=this.cp2.x,a=this.cp3.x,i=this.cp0.y,o=this.cp1.y,u=this.cp2.y,c=this.cp3.y,s=this.px(e),h=this.py(e),p=this.cp0,l=new at.Point(t+e*(n-t),i+e*(o-i)),x=new at.Point(t+2*e*(n-t)+e*e*(r-2*n+t),i+2*e*(o-i)+e*e*(u-2*o+i)),f=new at.Point(s,h),d=f,y=new at.Point(n+2*e*(r-n)+e*e*(a-2*r+n),o+2*e*(u-o)+e*e*(c-2*u+o)),v=new at.Point(r+e*(a-r),u+e*(c-u)),g=this.cp3;return[new qt.CubicBezier(p,l,x,f),new qt.CubicBezier(d,y,v,g)]}},{key:"slice",value:function(e,t){if(!(e>=t)){if(e<0&&(e=0),t>1&&(t=1),0===e&&1===t)return this;this.cp0.x;var n=this.cp1.x,r=this.cp2.x,a=this.cp3.x,i=(this.cp0.y,this.cp1.y),o=this.cp2.y,u=this.cp3.y,c=this.px(e),s=this.py(e),h=n+2*e*(r-n)+e*e*(a-2*r+n),p=i+2*e*(o-i)+e*e*(u-2*o+i),l=r+e*(a-r),x=o+e*(u-o),m=new at.Point(c,s),f=new at.Point(c+t*(h-c),s+t*(p-s)),d=new at.Point(c+2*t*(h-c)+t*t*(l-2*h+c),s+2*t*(p-s)+t*t*(x-2*p+s)),y=new at.Point(this.px(t),this.py(t));return new qt.CubicBezier(m,f,d,y)}}},{key:"tOfIntersections",value:function(e){if(e.isPoint())return[];if(e.isRect()){var t,n=e.x+e.r,r=e.x-e.l,a=e.y+e.u,i=e.y-e.d,o=Ue,u=this.cp0.x,c=this.cp1.x,s=this.cp2.x,h=this.cp3.x,p=this.cp0.y,l=this.cp1.y,x=this.cp2.y,m=this.cp3.y,f=o(u),d=o(3*(c-u)),y=o(3*(s-2*c+u)),v=o(h-3*s+3*c-u),g=function(e){return f+e*d+e*e*y+e*e*e*v},M=o(p),w=o(3*(l-p)),S=o(3*(x-2*l+p)),b=o(m-3*x+3*l-p),C=function(e){return M+e*w+e*e*S+e*e*e*b},k=[];t=(t=qt.solutionsOfCubicEq(v,y,d,f-n)).concat(qt.solutionsOfCubicEq(v,y,d,f-r));for(var J=0;J<t.length;J++){(B=C(N=t[J]))>=i&&B<=a&&k.push(N)}t=(t=qt.solutionsOfCubicEq(b,S,w,M-a)).concat(qt.solutionsOfCubicEq(b,S,w,M-i));for(J=0;J<t.length;J++){(O=g(N=t[J]))>=r&&O<=n&&k.push(N)}return k}if(e.isCircle()){var P=Math.PI,O=e.x,B=e.y,E=e.l,A=e.r,L=e.u,j=e.d,D=O+(A-E)/2,T=B+(L-j)/2,R=(n=(E+A)/2,(L+j)/2),F=P/180,G=new Zt.Arc(D,T,n,R,-P-F,-P/2+F),V=new Zt.Arc(D,T,n,R,-P/2-F,0+F),_=new Zt.Arc(D,T,n,R,0-F,P/2+F),I=new Zt.Arc(D,T,n,R,P/2-F,P+F),z=new Zt.CubicBezier(this,0,1),Q=[];Q=(Q=(Q=(Q=Q.concat(Zt.findIntersections(G,z))).concat(Zt.findIntersections(V,z))).concat(Zt.findIntersections(_,z))).concat(Zt.findIntersections(I,z));for(k=[],J=0;J<Q.length;J++){var N=(Q[J][1].min+Q[J][1].max)/2;k.push(N)}return k}}},{key:"countOfSegments",value:function(){return 1}},{key:"drawPrimitive",value:function(e,t){var n=this.cp0,a=this.cp1,i=this.cp2,o=this.cp3;e.createSVGElement("path",{d:"M"+r.MathJax.xypic.measure.em2px(n.x)+","+r.MathJax.xypic.measure.em2px(-n.y)+" C"+r.MathJax.xypic.measure.em2px(a.x)+","+r.MathJax.xypic.measure.em2px(-a.y)+" "+r.MathJax.xypic.measure.em2px(i.x)+","+r.MathJax.xypic.measure.em2px(-i.y)+" "+r.MathJax.xypic.measure.em2px(o.x)+","+r.MathJax.xypic.measure.em2px(-o.y),"stroke-dasharray":t})}},{key:"toString",value:function(){return"CubicBezier("+this.cp0.x+", "+this.cp0.y+")-("+this.cp1.x+", "+this.cp1.y+")-("+this.cp2.x+", "+this.cp2.y+")-("+this.cp3.x+", "+this.cp3.y+")"}}]),n}(qt),qt.CubicBeziers=function(e){_t(n,e);var t=zt(n);function n(e){var r;Xt(this,n),(r=t.call(this)).cbs=e;var a=r.cbs.length;return r.delegate=0==a?function(e,t,n){return n}:function(t,n,r){var i=t*a,o=Math.floor(i);o<0&&(o=0),o>=a&&(o=a-1);var u=i-o;return n(e[o],u)},r}return Wt(n,[{key:"startPosition",value:function(){return this.cbs[0].cp0}},{key:"endPosition",value:function(){return this.cbs[this.cbs.length-1].cp3}},{key:"position",value:function(e){return this.delegate(e,(function(e,t){return e.position(t)}),void 0)}},{key:"derivative",value:function(e){return this.delegate(e,(function(e,t){return e.derivative(t)}),void 0)}},{key:"angle",value:function(e){return this.delegate(e,(function(e,t){return e.angle(t)}),0)}},{key:"velocity",value:function(e){var t=this.cbs.length;return this.delegate(e,(function(e,n){return t*e.velocity(n)}),0)}},{key:"boundingBox",value:function(e){if(0!=this.cbs.length){var t,n=this.cbs[0].boundingBox(e),r=this.cbs.length;for(t=1;t<r;t++)n=n.combineRect(this.cbs[t].boundingBox(e));return n}}},{key:"tOfIntersections",value:function(e){var t=[],n=0,r=this.cbs.length;for(n=0;n<r;n++)for(var a=this.cbs[n].tOfIntersections(e),i=0;i<a.length;i++)t.push((a[i]+n)/r);return t}},{key:"divide",value:function(e){if(e<0||e>1)throw new m.a("ExecutionError","illegal cubic Bezier parameter t:"+e);if(0===e)return[new qt.CubicBeziers([]),this];if(1===e)return[this,new qt.CubicBeziers([])];var t=this.cbs.length,n=e*t,r=Math.floor(n);r===t&&(r=t-1);var a=n-r,i=this.cbs.slice(0,r),o=this.cbs.slice(r+1),u=this.cbs[r].divide(a);return i.push(u[0]),o.unshift(u[1]),[new qt.CubicBeziers(i),new qt.CubicBeziers(o)]}},{key:"slice",value:function(e,t){if(!(e>=t)){if(e<0&&(e=0),t>1&&(t=1),0===e&&1===t)return this;var n=this.cbs.length,r=e*n,a=t*n,i=Math.floor(r),o=Math.floor(a);i===n&&(i=n-1),o===n&&(o=n-1);var u,c=r-i,s=a-o;return i===o?u=[this.cbs[i].slice(c,s)]:((u=this.cbs.slice(i+1,o)).push(this.cbs[o].slice(0,s)),u.unshift(this.cbs[i].slice(c,1))),new qt.CubicBeziers(u)}}},{key:"countOfSegments",value:function(){return this.cbs.length}},{key:"drawPrimitive",value:function(e,t){for(var n=this.cbs.length,a=this.cbs,i=a[0],o=i.cp0,u=i.cp1,c=i.cp2,s=i.cp3,h="M"+r.MathJax.xypic.measure.em2px(o.x)+","+r.MathJax.xypic.measure.em2px(-o.y)+" C"+r.MathJax.xypic.measure.em2px(u.x)+","+r.MathJax.xypic.measure.em2px(-u.y)+" "+r.MathJax.xypic.measure.em2px(c.x)+","+r.MathJax.xypic.measure.em2px(-c.y)+" "+r.MathJax.xypic.measure.em2px(s.x)+","+r.MathJax.xypic.measure.em2px(-s.y),p=1;p<n;p++)c=(i=a[p]).cp2,s=i.cp3,h+=" S"+r.MathJax.xypic.measure.em2px(c.x)+","+r.MathJax.xypic.measure.em2px(-c.y)+" "+r.MathJax.xypic.measure.em2px(s.x)+","+r.MathJax.xypic.measure.em2px(-s.y);e.createSVGElement("path",{d:h,"stroke-dasharray":t})}},{key:"drawSkipped",value:function(e){for(var t=this.cbs.length,n=this.cbs,a="",i=0;i<t;i+=2){var o=n[i],u=o.cp0,c=o.cp1,s=o.cp2,h=o.cp3;a+="M"+r.MathJax.xypic.measure.em2px(u.x)+","+r.MathJax.xypic.measure.em2px(-u.y)+" C"+r.MathJax.xypic.measure.em2px(c.x)+","+r.MathJax.xypic.measure.em2px(-c.y)+" "+r.MathJax.xypic.measure.em2px(s.x)+","+r.MathJax.xypic.measure.em2px(-s.y)+" "+r.MathJax.xypic.measure.em2px(h.x)+","+r.MathJax.xypic.measure.em2px(-h.y)}e.createSVGElement("path",{d:a})}}],[{key:"interpolation",value:function(e,t,n){var r,a=qt.CubicBeziers.cubicSplineInterpolation(e,t),i=a[0],o=a[1],u=qt.CubicBeziers.cubicSplineInterpolation(e,n),c=u[0],s=u[1],h=e.length,p=new Array(h-1);for(r=0;r<h-1;r++)p[r]=new qt.CubicBezier(new at.Point(t[r],n[r]),new at.Point(i[r],c[r]),new at.Point(o[r],s[r]),new at.Point(t[r+1],n[r+1]));return new qt.CubicBeziers(p)}},{key:"cubicSplineInterpolation",value:function(e,t){var n,r=e.length-1,a=new Array(r);for(n=0;n<r;n++)a[n]=e[n+1]-e[n];var i=new Array(r);for(n=1;n<r;n++)i[n]=3*(t[n+1]-t[n])/a[n]-3*(t[n]-t[n-1])/a[n-1];var o=new Array(r+1),u=new Array(r+1),c=new Array(r+1);for(o[0]=1,u[0]=0,c[0]=0,n=1;n<r;n++)o[n]=2*(e[n+1]-e[n-1])-a[n-1]*u[n-1],u[n]=a[n]/o[n],c[n]=(i[n]-a[n-1]*c[n-1])/o[n];o[r]=1,c[r]=0;var s=new Array(r),h=new Array(r+1);for(h[r]=0,n=r-1;n>=0;n--){var p=a[n],l=h[n+1],x=p*p*c[n]-u[n]*l;h[n]=x,s[n]=t[n+1]-t[n]-(l+2*x)/3}var m=new Array(r),f=new Array(r);for(n=0;n<r;n++){var d=t[n],y=s[n],v=h[n];m[n]=d+y/3,f[n]=d+(2*y+v)/3}return[m,f]}}]),n}(qt),qt.CubicBSpline=function(){function e(t,n,r){if(Xt(this,e),n.length<1)throw new m.a("ExecutionError","the number of internal control points of cubic B-spline must be greater than or equal to 1");var a=[];a.push(t);for(var i=0,o=n.length;i<o;i++)a.push(n[i]);a.push(r),this.cps=a;var u=this.cps.length-1,c=function(e){return e<0?a[0]:e>u?a[u]:a[e]},s=function(e){var t=Math.abs(e);return t<=1?(3*t*t*t-6*t*t+4)/6:t<=2?-(t-2)*(t-2)*(t-2)/6:0};this.px=function(e){for(var t=(u+2)*e-1,n=Math.ceil(t-2),r=Math.floor(t+2),a=0,i=n;i<=r;i++)a+=s(t-i)*c(i).x;return a},this.py=function(e){for(var t=(u+2)*e-1,n=Math.ceil(t-2),r=Math.floor(t+2),a=0,i=n;i<=r;i++)a+=s(t-i)*c(i).y;return a};var h=function(e){var t=e>0?1:e<0?-1:0,n=Math.abs(e);return n<=1?t*(3*n*n-4*n)/2:n<=2?-t*(n-2)*(n-2)/2:0};this.dpx=function(e){for(var t=(u+2)*e-1,n=Math.ceil(t-2),r=Math.floor(t+2),a=0,i=n;i<=r;i++)a+=h(t-i)*c(i).x;return a},this.dpy=function(e){for(var t=(u+2)*e-1,n=Math.ceil(t-2),r=Math.floor(t+2),a=0,i=n;i<=r;i++)a+=h(t-i)*c(i).y;return a}}return Wt(e,[{key:"position",value:function(e){return new at.Point(this.px(e),this.py(e))}},{key:"angle",value:function(e){return Math.atan2(this.dpy(e),this.dpx(e))}},{key:"toCubicBeziers",value:function(){var e=[],t=this.cps,n=t[0],r=t[1],a=t[2],i=n.x,o=n.y,u=i+(r.x-i)/3,c=o+(r.y-o)/3,s=i+2*(r.x-i)/3,h=o+2*(r.y-o)/3,p=r.x+(a.x-r.x)/3,l=r.y+(a.y-r.y)/3,x=(s+p)/2,m=(h+l)/2,f=n,d=new at.Point(u,c),y=new at.Point(s,h),v=new at.Point(x,m),g=new qt.CubicBezier(f,d,y,v);e.push(g);for(var M=this.cps.length-1,w=2;w<M;w++)n=r,r=a,a=t[w+1],i=x,o=m,u=2*x-s,c=2*m-h,s=n.x+2*(r.x-n.x)/3,h=n.y+2*(r.y-n.y)/3,x=(s+(p=r.x+(a.x-r.x)/3))/2,m=(h+(l=r.y+(a.y-r.y)/3))/2,f=v,d=new at.Point(u,c),y=new at.Point(s,h),v=new at.Point(x,m),g=new qt.CubicBezier(f,d,y,v),e.push(g);return n=r,r=a,i=x,o=m,u=2*x-s,c=2*m-h,s=n.x+2*(r.x-n.x)/3,h=n.y+2*(r.y-n.y)/3,x=r.x,m=r.y,f=v,d=new at.Point(u,c),y=new at.Point(s,h),v=new at.Point(x,m),g=new qt.CubicBezier(f,d,y,v),e.push(g),e}},{key:"countOfSegments",value:function(){return this.cps.length-1}}]),e}(),qt.Line=function(){function e(t,n){Xt(this,e),this.s=t,this.e=n}return Wt(e,[{key:"position",value:function(e){return new at.Point(this.s.x+e*(this.e.x-this.s.x),this.s.y+e*(this.e.y-this.s.y))}},{key:"slice",value:function(e,t){if(!(e>=t)){if(e<0&&(e=0),t>1&&(t=1),0===e&&1===t)return this;var n=this.s,r=this.e,a=r.x-n.x,i=r.y-n.y,o=new at.Point(n.x+e*a,n.y+e*i),u=new at.Point(n.x+t*a,n.y+t*i);return new qt.Line(o,u)}}},{key:"tOfIntersections",value:function(e){if(e.isPoint())return[];var t=this.s,n=this.e;if(e.isRect()){var r,a=e.x+e.r,i=e.x-e.l,o=e.y+e.u,u=e.y-e.d,c=t.x,s=t.y,h=n.x-c,p=n.y-s,l=function(e){return c+e*h},x=function(e){return s+e*p},m=[];r=(r=qt.solutionsOfLinearEq(h,c-a)).concat(qt.solutionsOfLinearEq(h,c-i));for(var f=0;f<r.length;f++){var d=x(y=r[f]);d>=u&&d<=o&&m.push(y)}r=(r=qt.solutionsOfLinearEq(p,s-o)).concat(qt.solutionsOfLinearEq(p,s-u));for(f=0;f<r.length;f++){var y,v=l(y=r[f]);v>=i&&v<=a&&m.push(y)}return m}if(e.isCircle()){Math.PI;var g=e.l,M=e.r,w=e.u,S=e.d,b=e.x+(M-g)/2,C=e.y+(w-S)/2,k=(a=(g+M)/2,(w+S)/2),J=t.x,P=t.y,O=n.x-J,B=-O,E=(u=n.y-P)*a,A=B*k,L=E*E+A*A,j=(n=-(S=E*b+A*C+((O*P-u*J)*a+(a-k)*B*C))/L,L*a*a-S*S);if(j<0)return[];var D,T,R=Math.sqrt(j)/L,F=k/a,G=E*n+A*R+b,V=F*(A*n-E*R+C-C)+C,_=E*n-A*R+b,I=F*(A*n+E*R+C-C)+C;Math.abs(O)>Math.abs(u)?(D=(G-J)/O,T=(_-J)/O):(D=(V-P)/u,T=(I-P)/u);m=[];return D>=0&&D<=1&&m.push(D),T>=0&&T<=1&&m.push(T),m}}},{key:"toShape",value:function(e,t,n,a){var i=e.env,o=r.MathJax.xypic.measure.thickness,u=this.s,c=this.e;if(u.x!==c.x||u.y!==c.y){var s,h=c.x-u.x,p=c.y-u.y,l=Math.atan2(p,h),x=ft.none;switch(n){case"=":n="-",a="2";break;case"==":n="--",a="2";break;case":":case"::":n=".",a="2"}switch(n){case"":return i.angle=l,i.lastCurve=new Yt.Line(u,c,i.p,i.c,void 0),x;case"-":case".":case"..":switch(a){case"2":s=o/2;break;case"3":s=o;break;default:s=0}break;case"--":var m=3*o;if((y=Math.sqrt(h*h+p*p))>=m)switch(a){case"2":s=o/2;break;case"3":s=o;break;default:s=0}break;case"~":case"~~":switch(a){case"2":s=1.5*o;break;case"3":s=2*o;break;default:s=0}break;default:var f=t.boundingBox(e);if(null==f)return i.angle=0,i.lastCurve=Yt.none,ft.none;var d=f.l+f.r;0==d&&(d=r.MathJax.xypic.measure.strokeWidth);var y=Math.sqrt(h*h+p*p);if(0==Math.floor(y/d))return i.angle=0,i.lastCurve=Yt.none,ft.none;s=Math.max(f.u,f.d)}if(void 0!==s){var v=this.boundingBox(s);return x=new ft.LineShape(this,t,n,a,v),e.appendShapeToFront(x),i.angle=l,i.lastCurve=new Yt.Line(u,c,i.p,i.c,x),x}}return i.angle=0,i.lastCurve=Yt.none,ft.none}},{key:"boundingBox",value:function(e){var t=this.s,n=this.e,r=n.x-t.x,a=n.y-t.y,i=Math.atan2(a,r),o=e*Math.cos(i+Math.PI/2),u=e*Math.sin(i+Math.PI/2);return new at.Rect(t.x,t.y,{l:t.x-Math.min(t.x+o,t.x-o,n.x+o,n.x-o),r:Math.max(t.x+o,t.x-o,n.x+o,n.x-o)-t.x,u:Math.max(t.y+u,t.y-u,n.y+u,n.y-u)-t.y,d:t.y-Math.min(t.y+u,t.y-u,n.y+u,n.y-u)})}},{key:"drawLine",value:function(e,t,n,r,a){if(a.isEmpty)this._drawLine(e,t,n,r);else{var i=new Gt(0,1).differenceRanges(a),o=this;i.foreach((function(a){o.slice(a.start,a.end)._drawLine(e,t,n,r)}))}}},{key:"_drawLine",value:function(e,t,n,a){var i=r.MathJax.xypic.measure.thickness,o=this.s,u=this.e;if(o.x!==u.x||o.y!==u.y){var c=u.x-o.x,s=u.y-o.y,h=Math.atan2(s,c),p={x:0,y:0};switch(n){case"":break;case"-":this.drawStraightLine(e,o,u,p,h,i,a,"");break;case"=":this.drawStraightLine(e,o,u,p,h,i,"2","");break;case".":case"..":this.drawStraightLine(e,o,u,p,h,i,a,r.MathJax.xypic.measure.dottedDasharray);break;case":":case"::":this.drawStraightLine(e,o,u,p,h,i,"2",r.MathJax.xypic.measure.dottedDasharray);break;case"--":case"==":var l=3*i;if((P=Math.sqrt(c*c+s*s))>=l)p={x:(O=(P-l)/2-Math.floor((P-l)/2/l)*l)*Math.cos(h),y:O*Math.sin(h)},this.drawStraightLine(e,o,u,p,h,i,"=="===n?"2":a,r.MathJax.xypic.measure.em2px(l)+" "+r.MathJax.xypic.measure.em2px(l));break;case"~":if((P=Math.sqrt(c*c+s*s))>=(w=4*i)){p={x:(O=(P-(J=Math.floor(P/w))*w)/2)*Math.cos(h),y:O*Math.sin(h)};for(var x=i*Math.cos(h+Math.PI/2),m=i*Math.sin(h+Math.PI/2),f=i*Math.cos(h),d=i*Math.sin(h),y=o.x+p.x,v=-o.y-p.y,g="M"+r.MathJax.xypic.measure.em2px(y)+","+r.MathJax.xypic.measure.em2px(v)+" Q"+r.MathJax.xypic.measure.em2px(y+f+x)+","+r.MathJax.xypic.measure.em2px(v-d-m)+" "+r.MathJax.xypic.measure.em2px(y+2*f)+","+r.MathJax.xypic.measure.em2px(v-2*d)+" T"+r.MathJax.xypic.measure.em2px(y+4*f)+","+r.MathJax.xypic.measure.em2px(v-4*d),M=1;M<J;M++)g+=" T"+r.MathJax.xypic.measure.em2px(y+(4*M+2)*f)+","+r.MathJax.xypic.measure.em2px(v-(4*M+2)*d)+" T"+r.MathJax.xypic.measure.em2px(y+(4*M+4)*f)+","+r.MathJax.xypic.measure.em2px(v-(4*M+4)*d);this.drawSquigglyLineShape(e,g,o,u,x,m,a)}break;case"~~":var w;if((P=Math.sqrt(c*c+s*s))>=(w=4*i)){p={x:(O=(P-w)/2-(J=Math.floor((P-w)/2/w))*w)*Math.cos(h),y:O*Math.sin(h)};for(x=i*Math.cos(h+Math.PI/2),m=i*Math.sin(h+Math.PI/2),f=i*Math.cos(h),d=i*Math.sin(h),y=o.x+p.x,v=-o.y-p.y,g="",M=0;M<=J;M++)g+=" M"+r.MathJax.xypic.measure.em2px(y+8*M*f)+","+r.MathJax.xypic.measure.em2px(v-8*M*d)+" Q"+r.MathJax.xypic.measure.em2px(y+(8*M+1)*f+x)+","+r.MathJax.xypic.measure.em2px(v-(8*M+1)*d-m)+" "+r.MathJax.xypic.measure.em2px(y+(8*M+2)*f)+","+r.MathJax.xypic.measure.em2px(v-(8*M+2)*d)+" T"+r.MathJax.xypic.measure.em2px(y+(8*M+4)*f)+","+r.MathJax.xypic.measure.em2px(v-(8*M+4)*d);this.drawSquigglyLineShape(e,g,o,u,x,m,a)}break;default:var S=new Ht;S.c=Ht.originPosition;var b=new Rt(ft.none,S),C=t.boundingBox(b);if(null==C)return;var k=C.l+C.r;0==k&&(k=r.MathJax.xypic.measure.strokeWidth);var J,P=Math.sqrt(c*c+s*s);if(0==(J=Math.floor(P/k)))return;var O=(P-J*k)/2,B=Math.cos(h),E=Math.sin(h),A=k*B,L=k*E,j=o.x+(O+C.l)*B,D=o.y+(O+C.l)*E;for(b=new Rt(ft.none,S),M=0;M<J;M++)S.c=new at.Point(j+M*A,D+M*L),S.angle=h,t.toDropShape(b).draw(e)}}}},{key:"drawStraightLine",value:function(e,t,n,a,i,o,u,c){if("3"===u){var s=o*Math.cos(i+Math.PI/2),h=o*Math.sin(i+Math.PI/2);e.createSVGElement("line",{x1:r.MathJax.xypic.measure.em2px(t.x+a.x),y1:-r.MathJax.xypic.measure.em2px(t.y+a.y),x2:r.MathJax.xypic.measure.em2px(n.x),y2:-r.MathJax.xypic.measure.em2px(n.y),"stroke-dasharray":c}),e.createSVGElement("line",{x1:r.MathJax.xypic.measure.em2px(t.x+s+a.x),y1:-r.MathJax.xypic.measure.em2px(t.y+h+a.y),x2:r.MathJax.xypic.measure.em2px(n.x+s),y2:-r.MathJax.xypic.measure.em2px(n.y+h),"stroke-dasharray":c}),e.createSVGElement("line",{x1:r.MathJax.xypic.measure.em2px(t.x-s+a.x),y1:-r.MathJax.xypic.measure.em2px(t.y-h+a.y),x2:r.MathJax.xypic.measure.em2px(n.x-s),y2:-r.MathJax.xypic.measure.em2px(n.y-h),"stroke-dasharray":c})}else if("2"===u){s=o*Math.cos(i+Math.PI/2)/2,h=o*Math.sin(i+Math.PI/2)/2;e.createSVGElement("line",{x1:r.MathJax.xypic.measure.em2px(t.x+s+a.x),y1:-r.MathJax.xypic.measure.em2px(t.y+h+a.y),x2:r.MathJax.xypic.measure.em2px(n.x+s),y2:-r.MathJax.xypic.measure.em2px(n.y+h),"stroke-dasharray":c}),e.createSVGElement("line",{x1:r.MathJax.xypic.measure.em2px(t.x-s+a.x),y1:-r.MathJax.xypic.measure.em2px(t.y-h+a.y),x2:r.MathJax.xypic.measure.em2px(n.x-s),y2:-r.MathJax.xypic.measure.em2px(n.y-h),"stroke-dasharray":c})}else e.createSVGElement("line",{x1:r.MathJax.xypic.measure.em2px(t.x+a.x),y1:-r.MathJax.xypic.measure.em2px(t.y+a.y),x2:r.MathJax.xypic.measure.em2px(n.x),y2:-r.MathJax.xypic.measure.em2px(n.y),"stroke-dasharray":c})}},{key:"drawSquigglyLineShape",value:function(e,t,n,r,a,i,o){"3"===o?(e.createSVGElement("path",{d:t}),e.createGroup(e.transformBuilder().translate(a,i)).createSVGElement("path",{d:t}),e.createGroup(e.transformBuilder().translate(-a,-i)).createSVGElement("path",{d:t})):"2"===o?(e.createGroup(e.transformBuilder().translate(a/2,i/2)).createSVGElement("path",{d:t}),e.createGroup(e.transformBuilder().translate(-a/2,-i/2)).createSVGElement("path",{d:t})):e.createSVGElement("path",{d:t})}}]),e}();var Zt=function(){function e(){Xt(this,e)}return Wt(e,[{key:"bezierFatLine",value:function(e){var t,n,r,a,i=this.cps[0],o=this.cps[e];if(i.x!==o.x||i.y!==o.y)t=i.y-o.y,n=o.x-i.x,t/=a=Math.sqrt(t*t+n*n),n/=a,r=(i.x*o.y-i.y*o.x)/a;else{var u=this.bezier.angle(this.tmin);t=-Math.sin(u),n=Math.cos(u),r=-t*this.cp0.x-n*this.cp0.y}for(var c=r,s=r,h=1;h<e;h++){var p=-t*this.cps[h].x-n*this.cps[h].y;p>s?s=p:p<c&&(c=p)}return{min:[t,n,c],max:[t,n,s]}}},{key:"clippedLineRange",value:function(e,t,n){for(var r,a,i,o,u,c=e.length-1,s=new Array(c+1),h=Ne,p=0;p<=c;p++)s[p]=[p/c,-t[0]*e[p].x-t[1]*e[p].y-t[2],1];if(s[0][1]<0){var l=!0;for(p=1;p<=c;p++){(r=-(m=h(s[0],s[p]))[2]/m[0])>0&&r<1&&(void 0===a||r<a)&&(a=r),s[p][1]>=0&&(l=!1)}if(l)return}else a=0;if(s[c][1]<0)for(p=0;p<c;p++){(r=-(f=h(s[c],s[p]))[2]/f[0])>0&&r<1&&(void 0===i||r>i)&&(i=r)}else i=1;for(p=0;p<=c;p++)s[p]=[p/c,n[0]*e[p].x+n[1]*e[p].y+n[2],1];if(s[0][1]<0){var x=!0;for(p=1;p<=c;p++){var m;(r=-(m=h(s[0],s[p]))[2]/m[0])>0&&r<1&&(void 0===o||r<o)&&(o=r),s[p][1]>=0&&(x=!1)}if(x)return}else o=0;if(s[c][1]<0)for(p=0;p<c;p++){var f;(r=-(f=h(s[c],s[p]))[2]/f[0])>0&&r<1&&(void 0===u||r>u)&&(u=r)}else u=1;var d=Math.max(a,o),y=Math.min(i,u);return{min:this.tmin+d*(this.tmax-this.tmin),max:this.tmin+y*(this.tmax-this.tmin)}}}],[{key:"findIntersections",value:function(t,n){for(var r=e.maxIterations,a=e.goalAccuracy,i=[[t,n,!1]],o=0,u=[];o<r&&i.length>0;){o++;var c=i.shift(),s=(t=c[0],n=c[1],c[2]),h=t.fatLine(),p=n.clippedRange(h.min,h.max);if(null!=p){var l=p.min,x=p.max,m=x-l;if(m<a&&t.paramLength()<a)s?u.push([n.clip(l,x).paramRange(),t.paramRange()]):u.push([t.paramRange(),n.clip(l,x).paramRange()]);else if(m<=.8*n.paramLength())i.push([n.clip(l,x),t,!s]);else if(m>t.paramLength()){var f=(x+l)/2;i.push([n.clip(l,f),t,!s]),i.push([n.clip(f,x),t,!s])}else{var d=n.clip(l,x),y=t.paramRange(),v=(y.min+y.max)/2;i.push([d,t.clip(y.min,v),!s]),i.push([d,t.clip(v,y.max),!s])}}}return u}},{key:"maxIterations",get:function(){return 30}},{key:"goalAccuracy",get:function(){return 1e-4}}]),e}();Zt.Line=function(e){_t(n,e);var t=zt(n);function n(e,r,a,i){var o;return Xt(this,n),(o=t.call(this)).p0=e,o.p1=r,o.tmin=a,o.tmax=i,o}return Wt(n,[{key:"paramRange",value:function(){return{min:this.tmin,max:this.tmax}}},{key:"paramLength",value:function(){return this.tmax-this.tmin}},{key:"containsParam",value:function(e){return e>=this.tmin&&e<=this.tmax}},{key:"position",value:function(e){return{x:this.p0.x+e*(this.p1.x-this.p0.x),y:this.p0.y+e*(this.p1.y-this.p0.y)}}},{key:"fatLine",value:function(){var e=this.p1.y-this.p0.y,t=this.p0.x-this.p1.x,n=this.p1.x*this.p0.y-this.p0.x*this.p1.y,r=Math.sqrt(e*e+t*t);return 0===r?(e=1,t=0):(e/=r,t/=r,n/=r),{min:[e,t,n],max:[e,t,n]}}},{key:"clip",value:function(e,t){return new Zt.Line(this.p0,this.p1,e,t)}},{key:"clippedRange",value:function(e,t){var n=new Array(2);return n[0]=this.position(this.tmin),n[1]=this.position(this.tmax),this.clippedLineRange(n,e,t)}},{key:"drawFatLine",value:function(){this.fatLine().min;var e=function(e,t){return-(e*t[0]+t[2])/t[1]},t=this.p0.x,n=this.p1.x;r.MathJax.xypic.svgForDebug.createSVGElement("line",{x1:r.MathJax.xypic.measure.em2px(t),y1:-r.MathJax.xypic.measure.em2px(e(t,lmax)),x2:r.MathJax.xypic.measure.em2px(n),y2:-r.MathJax.xypic.measure.em2px(e(n,lmax)),"stroke-width":r.MathJax.xypic.measure.em2px(.02*r.MathJax.xypic.measure.oneem),stroke:"red"})}}]),n}(Zt),Zt.QuadBezier=function(e){_t(n,e);var t=zt(n);function n(e,r,a){var i;return Xt(this,n),(i=t.call(this)).bezier=e,i.tmin=r,i.tmax=a,i.cp0=e.position(r),i.cp1=new at.Point((1-a)*(1-r)*e.cp0.x+(r+a-2*r*a)*e.cp1.x+r*a*e.cp2.x,(1-a)*(1-r)*e.cp0.y+(r+a-2*r*a)*e.cp1.y+r*a*e.cp2.y),i.cp2=e.position(a),i.cps=[i.cp0,i.cp1,i.cp2],i}return Wt(n,[{key:"paramRange",value:function(){return{min:this.tmin,max:this.tmax}}},{key:"paramLength",value:function(){return this.tmax-this.tmin}},{key:"fatLine",value:function(){return this.bezierFatLine(2)}},{key:"clip",value:function(e,t){return new Zt.QuadBezier(this.bezier,e,t)}},{key:"clippedRange",value:function(e,t){return this.clippedLineRange(this.cps,e,t)}},{key:"drawFatLine",value:function(){var e=this.fatLine(),t=e.min,n=e.max,a=function(e,t){return-(e*t[0]+t[2])/t[1]},i=this.cp0.x,o=this.cp2.x;r.MathJax.xypic.svgForDebug.createSVGElement("line",{x1:r.MathJax.xypic.measure.em2px(i),y1:-r.MathJax.xypic.measure.em2px(a(i,t)),x2:r.MathJax.xypic.measure.em2px(o),y2:-r.MathJax.xypic.measure.em2px(a(o,t)),"stroke-width":r.MathJax.xypic.measure.em2px(.02*r.MathJax.xypic.measure.oneem),stroke:"blue"}),r.MathJax.xypic.svgForDebug.createSVGElement("line",{x1:r.MathJax.xypic.measure.em2px(i),y1:-r.MathJax.xypic.measure.em2px(a(i,n)),x2:r.MathJax.xypic.measure.em2px(o),y2:-r.MathJax.xypic.measure.em2px(a(o,n)),"stroke-width":r.MathJax.xypic.measure.em2px(.02*r.MathJax.xypic.measure.oneem),stroke:"red"})}}]),n}(Zt),Zt.CubicBezier=function(e){_t(n,e);var t=zt(n);function n(e,r,a){var i;return Xt(this,n),(i=t.call(this)).bezier=e,i.tmin=r,i.tmax=a,i.cp0=e.position(r),i.cp1=new at.Point((1-a)*(1-r)*(1-r)*e.cp0.x+(1-r)*(2*r+a-3*r*a)*e.cp1.x+r*(2*a+r-3*r*a)*e.cp2.x+r*r*a*e.cp3.x,(1-a)*(1-r)*(1-r)*e.cp0.y+(1-r)*(2*r+a-3*r*a)*e.cp1.y+r*(2*a+r-3*r*a)*e.cp2.y+r*r*a*e.cp3.y),i.cp2=new at.Point((1-r)*(1-a)*(1-a)*e.cp0.x+(1-a)*(2*a+r-3*r*a)*e.cp1.x+a*(2*r+a-3*r*a)*e.cp2.x+r*a*a*e.cp3.x,(1-r)*(1-a)*(1-a)*e.cp0.y+(1-a)*(2*a+r-3*r*a)*e.cp1.y+a*(2*r+a-3*r*a)*e.cp2.y+r*a*a*e.cp3.y),i.cp3=e.position(a),i.cps=[i.cp0,i.cp1,i.cp2,i.cp3],i}return Wt(n,[{key:"paramRange",value:function(){return{min:this.tmin,max:this.tmax}}},{key:"paramLength",value:function(){return this.tmax-this.tmin}},{key:"fatLine",value:function(){return this.bezierFatLine(3)}},{key:"clip",value:function(e,t){return new Zt.CubicBezier(this.bezier,e,t)}},{key:"clippedRange",value:function(e,t){return this.clippedLineRange(this.cps,e,t)}},{key:"drawFatLine",value:function(){var e=this.fatLine(),t=e.min,n=e.max,a=function(e,t){return-(e*t[0]+t[2])/t[1]},i=this.cp0.x,o=this.cp3.x;r.MathJax.xypic.svgForDebug.createSVGElement("line",{x1:r.MathJax.xypic.measure.em2px(i),y1:-r.MathJax.xypic.measure.em2px(a(i,t)),x2:r.MathJax.xypic.measure.em2px(o),y2:-r.MathJax.xypic.measure.em2px(a(o,t)),"stroke-width":r.MathJax.xypic.measure.em2px(.02*r.MathJax.xypic.measure.oneem),stroke:"blue"}),r.MathJax.xypic.svgForDebug.createSVGElement("line",{x1:r.MathJax.xypic.measure.em2px(i),y1:-r.MathJax.xypic.measure.em2px(a(i,n)),x2:r.MathJax.xypic.measure.em2px(o),y2:-r.MathJax.xypic.measure.em2px(a(o,n)),"stroke-width":r.MathJax.xypic.measure.em2px(.02*r.MathJax.xypic.measure.oneem),stroke:"red"})}}]),n}(Zt),Zt.Arc=function(e){_t(n,e);var t=zt(n);function n(e,r,a,i,o,u){var c;return Xt(this,n),(c=t.call(this)).x=e,c.y=r,c.rx=a,c.ry=i,c.angleMin=o,c.angleMax=u,c}return Wt(n,[{key:"paramRange",value:function(){return{min:this.angleMin,max:this.angleMax}}},{key:"paramLength",value:function(){return this.angleMax-this.angleMin}},{key:"normalizeAngle",value:function(e){return(e=e%2*Math.PI)>Math.PI?e-2*Math.PI:e<-Math.PI?e+2*Math.PI:e}},{key:"containsParam",value:function(e){return e>=this.angleMin&&e<=this.angleMax}},{key:"fatLine",value:function(){var e=this.rx,t=this.ry,n=(this.angleMax+this.angleMin)/2,r=(this.angleMax-this.angleMin)/2,a=Math.cos(n),i=Math.sin(n),o=Math.sqrt(e*e*i*i+t*t*a*a);if(o<f.machinePrecision)var u=[1,0,this.x*t*a+this.y*e*i+e*t*Math.cos(r)],c=[1,0,this.x*t*a+this.y*e*i+e*t];else{var s=e/o,h=t/o;u=[-h*a,-s*i,this.x*h*a+this.y*s*i+e*t/o*Math.cos(r)],c=[-h*a,-s*i,this.x*h*a+this.y*s*i+e*t/o]}return{min:u,max:c}}},{key:"clip",value:function(e,t){return new Zt.Arc(this.x,this.y,this.rx,this.ry,e,t)}},{key:"toCircleLine",value:function(e,t,n,r,a){var i=e[0],o=e[1],u=i*r,c=o*a,s=e[2]*r+(r-a)*o*n,h=Math.sqrt(u*u+c*c);return h<f.machinePrecision?(u=1,c=0):(u/=h,c/=h,s/=h),[u,c,s]}},{key:"clippedRange",value:function(e,t){var n=this.x,r=this.y,a=this.rx,i=this.ry,o=this.toCircleLine(e,n,r,a,i),u=this.toCircleLine(t,n,r,a,i),c=a,s=this.angleMin,h=this.angleMax,p=-(o[0]*n+o[1]*r+o[2]),l=[];if(c*c-p*p>=0){var x=o[0]*p-o[1]*Math.sqrt(c*c-p*p),m=o[1]*p+o[0]*Math.sqrt(c*c-p*p),f=o[0]*p+o[1]*Math.sqrt(c*c-p*p),d=o[1]*p-o[0]*Math.sqrt(c*c-p*p),y=Math.atan2(m,x),v=Math.atan2(d,f);this.containsParam(y)&&l.push(y),this.containsParam(v)&&l.push(v)}var g,M,w=-(o[0]*(n+c*Math.cos(s))+o[1]*(r+c*Math.sin(s))+o[2]),S=-(o[0]*(n+c*Math.cos(h))+o[1]*(r+c*Math.sin(h))+o[2]);if(w<0){if(0==l.length)return;g=Math.min.apply(Math,l)}else g=this.angleMin;if(S<0){if(0==l.length)return;M=Math.max.apply(Math,l)}else M=this.angleMax;l=[];if(c*c-(p=u[0]*n+u[1]*r+u[2])*p>=0){x=-o[0]*p+o[1]*Math.sqrt(c*c-p*p),m=-o[1]*p-o[0]*Math.sqrt(c*c-p*p),f=-o[0]*p-o[1]*Math.sqrt(c*c-p*p),d=-o[1]*p+o[0]*Math.sqrt(c*c-p*p),y=Math.atan2(m,x),v=Math.atan2(d,f);this.containsParam(y)&&l.push(y),this.containsParam(v)&&l.push(v)}var b,C;w=u[0]*(n+c*Math.cos(s))+u[1]*(r+c*Math.sin(s))+u[2],S=u[0]*(n+c*Math.cos(h))+u[1]*(r+c*Math.sin(h))+u[2];if(w<0){if(0==l.length)return;b=Math.min.apply(Math,l)}else b=this.angleMin;if(S<0){if(0==l.length)return;C=Math.max.apply(Math,l)}else C=this.angleMax;return{min:Math.max(g,b),max:Math.min(M,C)}}},{key:"drawFatLine",value:function(){var e=this.fatLine(),t=e.min,n=e.max,a=function(e,t){return-(e*t[0]+t[2])/t[1]},i=this.x+this.r*Math.cos(this.angleMin),o=this.x+this.r*Math.cos(this.angleMax);r.MathJax.xypic.svgForDebug.createSVGElement("line",{x1:r.MathJax.xypic.measure.em2px(i),y1:-r.MathJax.xypic.measure.em2px(a(i,t)),x2:r.MathJax.xypic.measure.em2px(o),y2:-r.MathJax.xypic.measure.em2px(a(o,t)),"stroke-width":r.MathJax.xypic.measure.em2px(.02*r.MathJax.xypic.measure.oneem),stroke:"blue"}),r.MathJax.xypic.svgForDebug.createSVGElement("line",{x1:r.MathJax.xypic.measure.em2px(i),y1:-r.MathJax.xypic.measure.em2px(a(i,n)),x2:r.MathJax.xypic.measure.em2px(o),y2:-r.MathJax.xypic.measure.em2px(a(o,n)),"stroke-width":r.MathJax.xypic.measure.em2px(.02*r.MathJax.xypic.measure.oneem),stroke:"red"})}}]),n}(Zt);var Yt=function e(){Xt(this,e)};function $t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Kt(e,t,n){return t&&$t(e.prototype,t),n&&$t(e,n),e}function en(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Yt.None=function(e){_t(n,e);var t=zt(n);function n(){return Xt(this,n),t.call(this)}return Wt(n,[{key:"segments",value:function(){return[]}},{key:"angle",value:function(){return 0}},{key:"isDefined",get:function(){return!1}}]),n}(Yt),Yt.none=new Yt.None,Yt.Line=function(e){_t(n,e);var t=zt(n);function n(e,r,a,i,o){var u;return Xt(this,n),(u=t.call(this)).start=e,u.end=r,u.p=a,u.c=i,u.lineShape=o,u}return Wt(n,[{key:"position",value:function(e){return new at.Point(this.p.x+e*(this.c.x-this.p.x),this.p.y+e*(this.c.y-this.p.y))}},{key:"derivative",value:function(e){return new at.Point(this.c.x-this.p.x,this.c.y-this.p.y)}},{key:"angle",value:function(e){var t=this.c.x-this.p.x,n=this.c.y-this.p.y;return 0===t&&0===n?0:Math.atan2(n,t)}},{key:"tOfPlace",value:function(e,t,n,r){var a=e?this.start:this.p,i=t?this.end:this.c;if(a.x===i.x&&a.y===i.y)return 0;var o,u,c=i.x-a.x,s=i.y-a.y,h=Math.sqrt(c*c+s*s);n>.5?(o=i.x-(1-n)*c+r*c/h,u=i.y-(1-n)*s+r*s/h):(o=a.x+n*c+r*c/h,u=a.y+n*s+r*s/h);var p=this.c.x-this.p.x,l=this.c.y-this.p.y;return 0===p&&0===l?0:Math.abs(p)>Math.abs(l)?(o-this.p.x)/p:(u-this.p.y)/l}},{key:"sliceHole",value:function(e,t){if(void 0!==this.lineShape&&!e.isPoint()){var n=this.lineShape,r=n.line,a=r.tOfIntersections(e);a.push(0),a.push(1),a.sort();for(var i=a[0],o=1;o<a.length;o++){var u=a[o],c=r.position((u+i)/2);if(e.contains(c)){var s=new Gt(i,u);n.sliceHole(s)}i=u}}}},{key:"segments",value:function(){return[new Zt.Line(this.p,this.c,0,1)]}},{key:"isDefined",get:function(){return!0}}]),n}(Yt),Yt.QuadBezier=function(e){_t(n,e);var t=zt(n);function n(e,r,a,i){var o;return Xt(this,n),(o=t.call(this)).origBezier=e,o.tOfShavedStart=r,o.tOfShavedEnd=a,i.isNone||(o.curveShape=i,r>0&&i.sliceHole(new Gt(0,r)),a<1&&i.sliceHole(new Gt(a,1))),o}return Wt(n,[{key:"position",value:function(e){return this.origBezier.position(e)}},{key:"derivative",value:function(e){return this.origBezier.derivative(e)}},{key:"angle",value:function(e){return this.origBezier.angle(e)}},{key:"tOfPlace",value:function(e,t,n,r){var a,i;e?(a=this.tOfShavedStart,i=t?this.tOfShavedEnd-this.tOfShavedStart:1-this.tOfShavedStart):(a=0,i=t?this.tOfShavedEnd:1);var o=this.origBezier,u=a+i*n;if(0!==r){var c=o.length(u);u=o.tOfLength(c+r)}return u}},{key:"sliceHole",value:function(e,t){var n=this.curveShape;if(void 0!==n&&!e.isPoint()){var r=n.curve,a=r.tOfIntersections(e);a.push(0),a.push(1),a.sort();for(var i=a[0],o=1;o<a.length;o++){var u=a[o];if(i<=t&&t<=u){var c=r.position((u+i)/2);if(e.contains(c)){var s=new Gt(i,u);n.sliceHole(s)}}i=u}}}},{key:"segments",value:function(){return[new Zt.QuadBezier(this.origBezier,0,1)]}},{key:"isDefined",get:function(){return!0}}]),n}(Yt),Yt.CubicBezier=function(e){_t(n,e);var t=zt(n);function n(e,r,a,i){var o;return Xt(this,n),(o=t.call(this)).origBezier=e,o.tOfShavedStart=r,o.tOfShavedEnd=a,i.isNone||(o.curveShape=i,r>0&&i.sliceHole(new Gt(0,r)),a<1&&i.sliceHole(new Gt(a,1))),o}return Wt(n,[{key:"originalLine",value:function(){return this.originalLine}},{key:"position",value:function(e){return this.origBezier.position(e)}},{key:"derivative",value:function(e){return this.origBezier.derivative(e)}},{key:"angle",value:function(e){return this.origBezier.angle(e)}},{key:"tOfPlace",value:function(e,t,n,r){var a,i;e?(a=this.tOfShavedStart,i=t?this.tOfShavedEnd-this.tOfShavedStart:1-this.tOfShavedStart):(a=0,i=t?this.tOfShavedEnd:1);var o=this.origBezier,u=a+i*n;if(0!==r){var c=o.length(u);u=o.tOfLength(c+r)}return u}},{key:"sliceHole",value:function(e,t){var n=this.curveShape;if(void 0!==n&&!e.isPoint()){var r=n.curve,a=r.tOfIntersections(e);a.push(0),a.push(1),a.sort();for(var i=a[0],o=1;o<a.length;o++){var u=a[o];if(i<=t&&t<=u){var c=r.position((u+i)/2);if(e.contains(c)){var s=new Gt(i,u);n.sliceHole(s)}}i=u}}}},{key:"segments",value:function(){return[new Zt.CubicBezier(this.origBezier,0,1)]}},{key:"isDefined",get:function(){return!0}}]),n}(Yt),Yt.CubicBSpline=function(e){_t(n,e);var t=zt(n);function n(e,r,a,i,o,u){var c;return Xt(this,n),(c=t.call(this)).s=e,c.e=r,c.origBeziers=a,c.tOfShavedStart=i,c.tOfShavedEnd=o,u.isNone||(c.curveShape=u,i>0&&u.sliceHole(new Gt(0,i)),o<1&&u.sliceHole(new Gt(o,1))),c}return Wt(n,[{key:"position",value:function(e){return this.origBeziers.position(e)}},{key:"derivative",value:function(e){return this.origBeziers.derivative(e)}},{key:"angle",value:function(e){return this.origBeziers.angle(e)}},{key:"tOfPlace",value:function(e,t,n,r){var a,i;e?(a=this.tOfShavedStart,i=t?this.tOfShavedEnd-this.tOfShavedStart:1-this.tOfShavedStart):(a=0,i=t?this.tOfShavedEnd:1);var o=this.origBeziers,u=a+i*n;if(0!==r){var c=o.length(u);u=o.tOfLength(c+r)}return u}},{key:"sliceHole",value:function(e,t){var n=this.curveShape;if(void 0!==n&&!e.isPoint()){var r=n.curve,a=r.tOfIntersections(e);a.push(0),a.push(1),a.sort();for(var i=a[0],o=1;o<a.length;o++){var u=a[o];if(i<=t&&t<=u){var c=r.position((u+i)/2);if(e.contains(c)){var s=new Gt(i,u);n.sliceHole(s)}}i=u}}}},{key:"segments",value:function(){for(var e=new Array(this.origBeziers.length),t=e.length,n=0;n<t;n++)e[n]=new Zt.CubicBezier(this.origBezier,n/t,(n+1)/t);return e}},{key:"isDefined",get:function(){return!0}}]),n}(Yt);var tn=function e(){en(this,e)};function nn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function an(e,t,n){return t&&rn(e.prototype,t),n&&rn(e,n),e}function on(e,t){for(var n in t)e.prototype.hasOwnProperty(n)?console.log("WARN","method "+n+" is already exists in class "+e.name):e.prototype[n]=t[n]}tn.Position=function(){function e(t){en(this,e),this.pos=t}return Kt(e,[{key:"position",value:function(e){return this.pos}},{key:"toString",value:function(){return this.pos.toString()}}]),e}(),tn.Macro=function(){function e(t){en(this,e),this.macro=t}return Kt(e,[{key:"position",value:function(e){return env.c=this.macro.position(e),env.c}},{key:"toString",value:function(){return this.macro.toString()}}]),e}(),tn.Base=function(){function e(t,n,r){en(this,e),this.origin=t,this.xBase=n,this.yBase=r}return Kt(e,[{key:"position",value:function(e){var t=e.env;return t.origin=this.origin,t.xBase=this.xBase,t.yBase=this.yBase,t.c}},{key:"toString",value:function(){return"origin:"+this.origin+", xBase:"+this.xBase+", yBase:"+this.yBase}}]),e}(),tn.Stack=function(){function e(t){en(this,e),this.stack=t}return Kt(e,[{key:"position",value:function(e){var t=e.env;return this.stack.isEmpty||(this.stack.tail.reverse().foreach((function(e){t.capturePosition(e)})),t.c=this.stack.head),t.c}},{key:"toString",value:function(){return this.stack.toString()}}]),e}(),on(Se.PosDecor,{toShape:function(e){this.pos.toShape(e),this.decor.toShape(e)}}),on(Se.Pos.Coord,{toShape:function(e){e.env.c=this.coord.position(e),this.pos2s.foreach((function(t){t.toShape(e)}))}}),on(Se.Pos.Plus,{toShape:function(e){var t=e.env,n=this.coord.position(e);t.c=n.move(t.c.x+n.x,t.c.y+n.y)}}),on(Se.Pos.Minus,{toShape:function(e){var t=e.env,n=this.coord.position(e);t.c=n.move(t.c.x-n.x,t.c.y-n.y)}}),on(Se.Pos.Skew,{toShape:function(e){var t=e.env,n=this.coord.position(e),r=new at.Point(n.x+t.c.x,n.y+t.c.y);t.c=r.combineRect(t.c)}}),on(Se.Pos.Cover,{toShape:function(e){var t=e.env,n=this.coord.position(e);t.c=t.c.combineRect(n)}}),on(Se.Pos.Then,{toShape:function(e){var t=e.env;t.capturePosition(t.c),t.c=this.coord.position(e)}}),on(Se.Pos.SwapPAndC,{toShape:function(e){var t=e.env;t.swapPAndC(),t.c=this.coord.position(e)}}),on(Se.Pos.SetBase,{toShape:function(e){var t=e.env,n=t.p,r=t.c.x-n.x,a=t.c.y-n.y;t.setOrigin(n.x,n.y),t.setXBase(r,a),t.setYBase(-a,r),t.c=this.coord.position(e)}}),on(Se.Pos.SetYBase,{toShape:function(e){var t=e.env;t.setYBase(t.c.x-t.origin.x,t.c.y-t.origin.y),t.c=this.coord.position(e)}}),on(Se.Pos.ConnectObject,{toShape:function(e){this.object.toConnectShape(e)}}),on(Se.Pos.DropObject,{toShape:function(e){this.object.toDropShape(e)}}),on(Se.Pos.Place,{toShape:function(e){var t=e.env;if(t.lastCurve.isDefined){var n,a=this.place,i=a.shaveP>0,o=a.shaveC>0,u=i?a.shaveP-1:0,c=o?a.shaveC-1:0;if(i&&(n=0),o&&(n=1),i==o&&(n=.5),void 0!==a.factor)if(a.factor.isIntercept){if(o=i=!1,void 0===(n=a.factor.value(e)))return}else n=a.factor.value(e);var s=r.MathJax.xypic.measure.length2em(a.slide.dimen.getOrElse("0"))+(u-c)*r.MathJax.xypic.measure.jot,h=t.lastCurve.tOfPlace(i,o,n,s),p=t.lastCurve.position(h),l=t.lastCurve.angle(h);return t.c=p,t.angle=l,h}}}),on(Se.Pos.PushCoord,{toShape:function(e){var t=e.env,n=this.coord.position(e);t.pushPos(n)}}),on(Se.Pos.EvalCoordThenPop,{toShape:function(e){var t=e.env;t.c=this.coord.position(e),t.popPos()}}),on(Se.Pos.LoadStack,{toShape:function(e){var t=e.env;t.startCapturePositions(),this.coord.position(e);var n=t.endCapturePositions();t.setStack(n),t.pushPos(t.c)}}),on(Se.Pos.DoCoord,{toShape:function(e){var t=e.env,n=this.coord;t.stack.reverse().foreach((function(r){t.c=r,n.position(e)}))}}),on(Se.Pos.InitStack,{toShape:function(e){e.env.initStack()}}),on(Se.Pos.EnterFrame,{toShape:function(e){e.env.enterStackFrame()}}),on(Se.Pos.LeaveFrame,{toShape:function(e){e.env.leaveStackFrame()}}),on(Se.Place.Factor,{value:function(e){return this.factor}}),on(Se.Place.Intercept,{value:function(e){var t=e.env;if(t.lastCurve.isDefined){var n=t.duplicate();n.angle=0,n.lastCurve=Yt.none,n.p=n.c=Ht.originPosition;var r=new Rt(ft.none,n);this.pos.toShape(r);e.appendShapeToFront(r.shape),n.lastCurve.isDefined||(n.lastCurve=new Yt.Line(n.p,n.c,n.p,n.c,void 0));for(var a=[],i=t.lastCurve.segments(),o=n.lastCurve.segments(),u=0;u<i.length;u++)for(var c=0;c<o.length;c++)a=a.concat(Zt.findIntersections(i[u],o[c]));if(0===a.length){console.log("perhaps no curve intersection.");for(var s=t.lastCurve,h=n.lastCurve,p=0,l=2,x=0,m=0,f=function(e){return 1/(1+Math.exp(-e))},d=function(e){var t=Math.exp(-e);return t/(1+t)/(1+t)},y=f(x),v=f(m),g=d(x),M=d(m),w=s.derivative(y),S=h.derivative(v),b=w.x*g,C=-S.x*M,k=w.y*g,J=-S.y*M,P=b*b+k*k,O=b*C+k*J,B=C*b+J*k,E=C*C+J*J,A=s.position(y),L=h.position(v),j=A.x-L.x,D=A.y-L.y,T=b*j+k*D,R=C*j+J*D,F=Math.sqrt(T*T+R*R)<1e-5,G=.001*Math.max(P,E);!F&&p<100;){p++;do{var V=E+G,_=(P+G)*V-O*B,I=(V*T-O*R)/_,z=(-B*T+P*R)/_;if(I*I+z*z<1e-5*1e-5*(x*x+m*m))F=!0;else{var Q=x-I,N=m-z,X=f(Q),U=f(N),W=s.position(X),H=h.position(U),q=W.x-H.x,Z=W.y-H.y,Y=(j*j+D*D-(q*q+Z*Z))/(I*(G*I+T)+z*(G*z+R));if(Y>0){m=N,y=X,v=U,g=d(x=Q),M=d(m),w=s.derivative(y),S=h.derivative(v),b=w.x*g,C=-S.x*M,P=b*b+(k=w.y*g)*k,O=b*C+k*(J=-S.y*M),B=C*b+J*k,E=C*C+J*J,T=b*(j=q)+k*(D=Z),R=C*j+J*D,F=Math.sqrt(T*T+R*R)<1e-5;var $=2*Y-1;G+=Math.max(1/3,1-$*$*$),l=2}else G*=l,l*=2}}while(!(F||void 0!==Y&&Y>0))}return f(x)}var K=(a[0][0].min+a[0][0].max)/2;for(u=1;u<a.length;u++){var ee=(a[u][0].min+a[u][0].max)/2;K>ee&&(K=ee)}return K}}}),on(Se.Pos.SavePos,{toShape:function(e){var t=e.env;t.savePos(this.id,new tn.Position(t.c))}}),on(Se.Pos.SaveMacro,{toShape:function(e){e.env.savePos(this.id,new tn.Macro(this.macro))}}),on(Se.Pos.SaveBase,{toShape:function(e){var t=e.env;t.savePos(this.id,new tn.Base(t.origin,t.xBase,t.yBase))}}),on(Se.Pos.SaveStack,{toShape:function(e){var t=e.env;t.savePos(this.id,new tn.Stack(t.stack))}}),on(Se.Object,{toDropShape:function(e){var t=e.env;if(void 0===t.c)return ft.none;var n=this.modifiers;if(n.isEmpty)return this.object.toDropShape(e);var r=t.duplicate(),a=new Rt(ft.none,r),i=F.empty;n.foreach((function(e){e.preprocess(a,i),i=i.prepend(e)}));var o=this.object.toDropShape(a),u=r.c;if(void 0===u)return ft.none;var c=r.originalReferencePoint;return(r=t.duplicate()).c=u,r.originalReferencePoint=c,a=new Rt(ft.none,r),o=n.head.modifyShape(a,o,n.tail),e.appendShapeToFront(o),t.c=r.c.move(t.c.x,t.c.y),o},toConnectShape:function(e){var t=e.env;if(void 0===t.c)return ft.none;var n=this.modifiers;if(n.isEmpty)return this.object.toConnectShape(e);var r=t.duplicate(),a=new Rt(ft.none,r),i=F.empty;n.foreach((function(e){e.preprocess(a,i),i=i.prepend(e)}));var o=this.object.toConnectShape(a);t.angle=r.angle,t.lastCurve=r.lastCurve;var u=r.c;if(void 0===u)return ft.none;var c=r.originalReferencePoint;return(r=t.duplicate()).c=u,r.originalReferencePoint=c,a=new Rt(ft.none,r),o=n.head.modifyShape(a,o,n.tail),e.appendShapeToFront(o),t.c=r.c.move(t.c.x,t.c.y),o},boundingBox:function(e){var t=e.duplicateEnv(),n=t.env;return n.angle=0,n.p=n.c=Ht.originPosition,t.shape=ft.none,this.toDropShape(t).getBoundingBox()}}),on(Se.ObjectBox,{toConnectShape:function(e){var t=(n=e.env).c,n=e.env,a=(r.MathJax.xypic.measure.thickness,n.p.edgePoint(n.c.x,n.c.y)),i=n.c.edgePoint(n.p.x,n.p.y);if(a.x!==i.x||a.y!==i.y){var o=new qt.Line(a,i).toShape(e,this,"196883","");return n.originalReferencePoint=t,o}return n.angle=0,n.lastCurve=Yt.none,n.originalReferencePoint=t,ft.none},boundingBox:function(e){var t=e.duplicateEnv(),n=t.env;return n.angle=0,n.p=n.c=Ht.originPosition,t.shape=ft.none,this.toDropShape(t).getBoundingBox()}}),on(Se.ObjectBox.WrapUpObject,{toDropShape:function(e){var t=e.env,n=this.object.toDropShape(e);return t.originalReferencePoint=t.c,n},toConnectShape:function(e){var t=e.env,n=this.object.toConnectShape(e);return t.originalReferencePoint=t.c,n}}),on(Se.ObjectBox.CompositeObject,{toDropShape:function(e){var t=e.env,n=t.c;if(void 0===n)return ft.none;var r=n,a=t.duplicate(),i=new Rt(ft.none,a);this.objects.foreach((function(e){a.c=n;var t=e.toDropShape(i);r=at.combineRect(r,a.c),r=at.combineRect(r,t.getBoundingBox().toPoint())})),t.c=r;var o=i.shape;return e.appendShapeToFront(o),t.originalReferencePoint=n,o}}),on(Se.ObjectBox.Xybox,{toDropShape:function(e){var t=e.env,n=t.c;if(void 0===n)return ft.none;var r=new Ht,a=new Rt(ft.none,r);this.posDecor.toShape(a);var i=a.shape,o=i.getBoundingBox();if(void 0===o)return ft.none;var u=Math.max(0,o.l-o.x),c=Math.max(0,o.r+o.x),s=Math.max(0,o.u+o.y),h=Math.max(0,o.d-o.y);t.c=new at.Rect(n.x,n.y,{l:u,r:c,u:s,d:h}),t.originalReferencePoint=n;var p=new ft.TranslateShape(n.x,n.y,i);return e.appendShapeToFront(p),p}}),on(Se.ObjectBox.Xymatrix,{toDropShape:function(e){var t=e.env,n=t.c,r=this.xymatrix.toShape(e);return t.originalReferencePoint=n,r}}),on(Se.ObjectBox.Text,{toDropShape:function(e){var t=e.env,n=new ft.TextShape(t.c,this.math);return e.appendShapeToFront(n),t.c=n.getBoundingBox(),t.originalReferencePoint=n.getOriginalReferencePoint(),n}}),on(Se.ObjectBox.Empty,{toDropShape:function(e){var t=e.env;return t.originalReferencePoint=t.c,t.c=new at.Point(t.c.x,t.c.y),ft.none}}),on(Se.ObjectBox.Txt,{toDropShape:function(e){var t=e.env;if(void 0===t.c)return ft.none;var n=this.textObject.toDropShape(e);return t.originalReferencePoint=t.c,n}}),on(Se.ObjectBox.Txt.Width.Vector,{width:function(e){return this.vector.xy().x}}),on(Se.ObjectBox.Txt.Width.Default,{width:function(e){var t=e.env.c;return t.r+t.l}}),on(Se.ObjectBox.Cir,{toDropShape:function(e){var t=e.env;if(void 0===t.c)return ft.none;t.originalReferencePoint=t.c;var n=this.radius.radius(e),r=t.c.x,a=t.c.y,i=this.cir.toDropShape(e,r,a,n);return t.c=new at.Ellipse(r,a,n,n,n,n),i},toConnectShape:function(e){var t=e.env;return t.originalReferencePoint=t.c,ft.none}}),on(Se.ObjectBox.Cir.Radius.Vector,{radius:function(e){return this.vector.xy(e).x}}),on(Se.ObjectBox.Cir.Radius.Default,{radius:function(e){return e.env.c.r}}),on(Se.ObjectBox.Cir.Cir.Segment,{toDropShape:function(e,t,n,r){e.env;var a,i,o=this.startPointDegree(e),u=this.endPointDegree(e,o),c=u-o;if(0===(c=c<0?c+360:c))return ft.none;"^"===this.orient?(a=c>180?"1":"0",i="0"):(a=c>180?"0":"1",i="1");var s=Math.PI/180,h=t+r*Math.cos(o*s),p=n+r*Math.sin(o*s),l=t+r*Math.cos(u*s),x=n+r*Math.sin(u*s),m=new ft.CircleSegmentShape(t,n,h,p,r,a,i,l,x);return e.appendShapeToFront(m),m},startPointDegree:function(e){var t=this.startDiag.toString();return"^"===this.orient?this.diagToAngleACW(t):this.diagToAngleCW(t)},endPointDegree:function(e,t){var n=this.endDiag.toString();return"^"===this.orient?this.diagToAngleACW(n,t):this.diagToAngleCW(n,t)},diagToAngleACW:function(e,t){switch(e){case"l":return 90;case"r":return-90;case"d":return 180;case"u":return 0;case"dl":case"ld":return 135;case"dr":case"rd":return-135;case"ul":case"lu":return 45;case"ur":case"ru":return-45;default:return void 0!==t?t+180:0}},diagToAngleCW:function(e,t){switch(e){case"l":return-90;case"r":return 90;case"d":return 0;case"u":return 180;case"dl":case"ld":return-45;case"dr":case"rd":return 45;case"ul":case"lu":return-135;case"ur":case"ru":return 135;default:return void 0!==t?t+180:0}}}),on(Se.ObjectBox.Cir.Cir.Full,{toDropShape:function(e,t,n,r){var a=new ft.FullCircleShape(t,n,r);return e.appendShapeToFront(a),a}}),on(Se.ObjectBox.Frame,{toDropShape:function(e){var t=e.env;return t.originalReferencePoint=t.c,this.toDropFilledShape(e,"currentColor",!1)},toDropFilledShape:function(e,t,n){var a=e.env.c;if(void 0===a)return ft.none;var i=r.MathJax.xypic.measure.thickness,o=a.x,u=a.y,c=a.l,s=a.r,h=a.u,p=a.d,l=ft.none;switch(this.main){case"--":var x=3*i;if(n){var m=this.radius.xy(e);l=new ft.EllipseShape(o+(s-c)/2,u+(h-p)/2,m.x,m.y,!1,t,r.MathJax.xypic.measure.em2px(x)+" "+r.MathJax.xypic.measure.em2px(x))}else{var f=this.radius.radius(e);l=new ft.RectangleShape(o,u,c,s,h,p,f,!1,t,r.MathJax.xypic.measure.em2px(x)+" "+r.MathJax.xypic.measure.em2px(x))}break;case"==":x=3*i;if(n){m=this.radius.xy(e);l=new ft.EllipseShape(o+(s-c)/2,u+(h-p)/2,m.x,m.y,!0,t,r.MathJax.xypic.measure.em2px(x)+" "+r.MathJax.xypic.measure.em2px(x))}else{f=this.radius.radius(e);l=new ft.RectangleShape(o,u,c,s,h,p,f,!0,t,r.MathJax.xypic.measure.em2px(x)+" "+r.MathJax.xypic.measure.em2px(x))}break;case"o-":x=3*i,f=r.MathJax.xypic.measure.lineElementLength;l=new ft.RectangleShape(o,u,c,s,h,p,f,!1,t,r.MathJax.xypic.measure.em2px(x)+" "+r.MathJax.xypic.measure.em2px(x));break;case"oo":var d=(m=this.radius.xy(e)).x;l=new ft.EllipseShape(o+(s-c)/2,u+(h-p)/2,d,d,!0,t,void 0);break;case"ee":m=this.radius.xy(e);l=new ft.EllipseShape(o+(s-c)/2,u+(h-p)/2,m.x,m.y,!0,t,void 0);break;case"-,":var y=this.radius.depth(e);f=this.radius.radius(e);l=new ft.CompositeShape(new ft.RectangleShape(o,u,c,s,h,p,f,!1,t,void 0),new ft.BoxShadeShape(o,u,c,s,h,p,y));break;case".o":d=(m=this.radius.xy(e)).x;l=new ft.EllipseShape(o+(s-c)/2,u+(h-p)/2,d,d,!1,t,r.MathJax.xypic.measure.dottedDasharray);break;case"-o":x=3*i,d=(m=this.radius.xy(e)).x;l=new ft.EllipseShape(o+(s-c)/2,u+(h-p)/2,d,d,!1,t,r.MathJax.xypic.measure.em2px(x)+" "+r.MathJax.xypic.measure.em2px(x));break;case".e":m=this.radius.xy(e);l=new ft.EllipseShape(o+(s-c)/2,u+(h-p)/2,m.x,m.y,!1,t,r.MathJax.xypic.measure.dottedDasharray);break;case"-e":x=3*i,m=this.radius.xy(e);l=new ft.EllipseShape(o+(s-c)/2,u+(h-p)/2,m.x,m.y,!1,t,r.MathJax.xypic.measure.em2px(x)+" "+r.MathJax.xypic.measure.em2px(x));break;case"-":if(n){m=this.radius.xy(e);l=new ft.EllipseShape(o+(s-c)/2,u+(h-p)/2,m.x,m.y,!1,t,void 0)}else{f=this.radius.radius(e);l=new ft.RectangleShape(o,u,c,s,h,p,f,!1,t,void 0)}break;case"=":if(n){m=this.radius.xy(e);l=new ft.EllipseShape(o+(s-c)/2,u+(h-p)/2,m.x,m.y,!0,t,void 0)}else{f=this.radius.radius(e);l=new ft.RectangleShape(o,u,c,s,h,p,f,!0,t,void 0)}break;case".":if(n){m=this.radius.xy(e);l=new ft.EllipseShape(o+(s-c)/2,u+(h-p)/2,m.x,m.y,!1,t,r.MathJax.xypic.measure.dottedDasharray)}else{f=this.radius.radius(e);l=new ft.RectangleShape(o,u,c,s,h,p,f,!1,t,r.MathJax.xypic.measure.dottedDasharray)}break;case",":y=this.radius.depth(e);l=new ft.BoxShadeShape(o,u,c,s,h,p,y,t);break;case"o":d=(m=this.radius.xy(e)).x;l=new ft.EllipseShape(o+(s-c)/2,u+(h-p)/2,d,d,!1,t,void 0);break;case"e":m=this.radius.xy(e);l=new ft.EllipseShape(o+(s-c)/2,u+(h-p)/2,m.x,m.y,!1,t,void 0);break;case"\\{":l=new ft.LeftBrace(o-c,u,h,p,0,t);break;case"\\}":l=new ft.LeftBrace(o+s,u,p,h,180,t);break;case"^\\}":case"^\\{":l=new ft.LeftBrace(o,u+h,s,c,270,t);break;case"_\\{":case"_\\}":l=new ft.LeftBrace(o,u-p,c,s,90,t);break;case"(":l=new ft.LeftParenthesis(o-c,u+(h-p)/2,h+p,0,t);break;case")":l=new ft.LeftParenthesis(o+s,u+(h-p)/2,h+p,180,t);break;case"^(":case"^)":l=new ft.LeftParenthesis(o+(s-c)/2,u+h,c+s,270,t);break;case"_(":case"_)":l=new ft.LeftParenthesis(o+(s-c)/2,u-p,c+s,90,t);break;case"*":if(a.isCircle()){m=this.radius.xy(e);l=new ft.EllipseShape(o+(s-c)/2,u+(h-p)/2,m.x,m.y,!1,"currentColor",void 0,t,!0)}else{f=this.radius.radius(e);l=new ft.RectangleShape(o,u,c,s,h,p,f,!1,"currentColor",void 0,t,!0)}break;case"**":if(a.isCircle()){m=this.radius.xy(e);l=new ft.EllipseShape(o+(s-c)/2,u+(h-p)/2,m.x,m.y,!1,"currentColor",void 0,t,!1)}else{f=this.radius.radius(e);l=new ft.RectangleShape(o,u,c,s,h,p,f,!1,"currentColor",void 0,t,!1)}break;default:return ft.none}return e.appendShapeToFront(l),l},toConnectShape:function(e){var t=e.env,n=t.c,r=t.p;void 0!==n&&void 0!==r||ft.none,t.originalReferencePoint=n;var a=t.duplicate();a.c=r.combineRect(n);var i=new Rt(ft.none,a),o=this.toDropShape(i);return e.appendShapeToFront(o),o}}),on(Se.ObjectBox.Frame.Radius.Vector,{radius:function(e){return this.vector.xy(e).x},depth:function(e){return this.vector.xy(e).x},xy:function(e){return this.vector.xy(e)}}),on(Se.ObjectBox.Frame.Radius.Default,{radius:function(e){return 0},depth:function(e){return r.MathJax.xypic.measure.thickness/2},xy:function(e){var t=e.env.c;return{x:(t.l+t.r)/2,y:(t.u+t.d)/2}}}),on(Se.ObjectBox.Dir,{toDropShape:function(e){var t=e.env,n=t.c;t.originalReferencePoint=n;var a=t.angle;if(void 0===n)return ft.none;t.c=new at.Point(n.x,n.y);r.MathJax.xypic.measure.thickness;var i=ft.none;switch(this.main){case"":return ft.none;case">":switch(this.variant){case"2":var o=(i=new ft.GT2ArrowheadShape(n,a)).getRadius();t.c=new at.Ellipse(n.x,n.y,o,o,o,o);break;case"3":o=(i=new ft.GT3ArrowheadShape(n,a)).getRadius();t.c=new at.Ellipse(n.x,n.y,o,o,o,o);break;default:i="^"===this.variant?new ft.UpperGTArrowheadShape(n,a):"_"===this.variant?new ft.LowerGTArrowheadShape(n,a):new ft.GTArrowheadShape(n,a)}break;case"<":switch(this.variant){case"2":o=(i=new ft.LT2ArrowheadShape(n,a)).getRadius();t.c=new at.Ellipse(n.x,n.y,o,o,o,o);break;case"3":o=(i=new ft.LT3ArrowheadShape(n,a)).getRadius();t.c=new at.Ellipse(n.x,n.y,o,o,o,o);break;default:i="^"===this.variant?new ft.UpperLTArrowheadShape(n,a):"_"===this.variant?new ft.LowerLTArrowheadShape(n,a):new ft.LTArrowheadShape(n,a)}break;case"|":switch(this.variant){case"^":i=new ft.UpperColumnArrowheadShape(n,a);break;case"_":i=new ft.LowerColumnArrowheadShape(n,a);break;case"2":i=new ft.Column2ArrowheadShape(n,a);break;case"3":i=new ft.Column3ArrowheadShape(n,a);break;default:i=new ft.ColumnArrowheadShape(n,a)}break;case"(":switch(this.variant){case"^":i=new ft.UpperLParenArrowheadShape(n,a);break;case"_":i=new ft.LowerLParenArrowheadShape(n,a);break;default:i=new ft.LParenArrowheadShape(n,a)}break;case")":switch(this.variant){case"^":i=new ft.UpperRParenArrowheadShape(n,a);break;case"_":i=new ft.LowerRParenArrowheadShape(n,a);break;default:i=new ft.RParenArrowheadShape(n,a)}break;case"`":switch(this.variant){case"_":i=new ft.LowerBackquoteArrowheadShape(n,a);break;case"^":default:i=new ft.UpperBackquoteArrowheadShape(n,a)}break;case"'":switch(this.variant){case"_":i=new ft.LowerQuoteArrowheadShape(n,a);break;case"^":default:i=new ft.UpperQuoteArrowheadShape(n,a)}break;case"*":i=new ft.AsteriskArrowheadShape(n,0);break;case"o":i=new ft.OArrowheadShape(n,0);break;case"+":i=new ft.PlusArrowheadShape(n,a);break;case"x":i=new ft.XArrowheadShape(n,a);break;case"/":i=new ft.SlashArrowheadShape(n,a);break;case"-":case"--":r.MathJax.xypic.measure.lineElementLength;i="3"===this.variant?new ft.Line3ArrowheadShape(n,a):"2"===this.variant?new ft.Line2ArrowheadShape(n,a):new ft.LineArrowheadShape(n,a);break;case"=":case"==":i=new ft.Line2ArrowheadShape(n,a);break;case".":case"..":i="3"===this.variant?new ft.Dot3ArrowheadShape(n,a):"2"===this.variant?new ft.Dot2ArrowheadShape(n,a):new ft.DotArrowheadShape(n,a);break;case":":case"::":i=new ft.Dot2ArrowheadShape(n,a);break;case"~":case"~~":i="3"===this.variant?new ft.Tilde3ArrowheadShape(n,a):"2"===this.variant?new ft.Tilde2ArrowheadShape(n,a):new ft.TildeArrowheadShape(n,a);break;case">>":switch(this.variant){case"^":i=new ft.UpperGTGTArrowheadShape(n,a);break;case"_":i=new ft.LowerGTGTArrowheadShape(n,a);break;case"2":o=(i=new ft.GTGT2ArrowheadShape(n,a)).getRadius();t.c=new at.Ellipse(n.x,n.y,o,o,o,o);break;case"3":o=(i=new ft.GTGT3ArrowheadShape(n,a)).getRadius();t.c=new at.Ellipse(n.x,n.y,o,o,o,o);break;default:i=new ft.GTGTArrowheadShape(n,a)}break;case"<<":switch(this.variant){case"^":i=new ft.UpperLTLTArrowheadShape(n,a);break;case"_":i=new ft.LowerLTLTArrowheadShape(n,a);break;case"2":o=(i=new ft.LTLT2ArrowheadShape(n,a)).getRadius();t.c=new at.Ellipse(n.x,n.y,o,o,o,o);break;case"3":o=(i=new ft.LTLT3ArrowheadShape(n,a)).getRadius();t.c=new at.Ellipse(n.x,n.y,o,o,o,o);break;default:i=new ft.LTLTArrowheadShape(n,a)}break;case"||":switch(this.variant){case"^":i=new ft.UpperColumnColumnArrowheadShape(n,a);break;case"_":i=new ft.LowerColumnColumnArrowheadShape(n,a);break;case"2":i=new ft.ColumnColumn2ArrowheadShape(n,a);break;case"3":i=new ft.ColumnColumn3ArrowheadShape(n,a);break;default:i=new ft.ColumnColumnArrowheadShape(n,a)}break;case"|-":switch(this.variant){case"^":i=new ft.UpperColumnLineArrowheadShape(n,a);break;case"_":i=new ft.LowerColumnLineArrowheadShape(n,a);break;case"2":i=new ft.ColumnLine2ArrowheadShape(n,a);break;case"3":i=new ft.ColumnLine3ArrowheadShape(n,a);break;default:i=new ft.ColumnLineArrowheadShape(n,a)}break;case">|":i=new ft.GTColumnArrowheadShape(n,a);break;case">>|":i=new ft.GTGTColumnArrowheadShape(n,a);break;case"|<":i=new ft.ColumnLTArrowheadShape(n,a);break;case"|<<":i=new ft.ColumnLTLTArrowheadShape(n,a);break;case"//":i=new ft.SlashSlashArrowheadShape(n,a);break;case"=>":i=new ft.LineGT2ArrowheadShape(n,a);break;default:var u=r.MathJax.xypic.repositories.dirRepository.get(this.main);if(void 0===u)throw new TeXError("ExecutionError","\\dir "+this.variant+"{"+this.main+"} not defined.");i=u.toDropShape(e)}return e.appendShapeToFront(i),i},toConnectShape:function(e){var t=e.env;t.originalReferencePoint=t.c;r.MathJax.xypic.measure.thickness;var n=t.p.edgePoint(t.c.x,t.c.y),a=t.c.edgePoint(t.p.x,t.p.y);return n.x!==a.x||n.y!==a.y?new qt.Line(n,a).toShape(e,this,this.main,this.variant):(t.angle=0,t.lastCurve=Yt.none,ft.none)}}),on(Se.ObjectBox.Curve,{toDropShape:function(e){var t=e.env;return t.originalReferencePoint=t.c,ft.none},toConnectShape:function(e){var t=e.env;t.originalReferencePoint=t.c;var n=void 0,a=void 0;this.objects.foreach((function(e){n=e.objectForDrop(n),a=e.objectForConnect(a)})),void 0===n&&void 0===a&&(a=new Se.Object(F.empty,new Se.ObjectBox.Dir("","-")));r.MathJax.xypic.measure.thickness;var i=t.c,o=t.p,u=[];this.poslist.foreach((function(t){t.addPositions(u,e)})),t.c=i,t.p=o;var c=ft.none,s=o,h=i;switch(u.length){case 0:return s.x===h.x&&s.y===h.y?(t.lastCurve=Yt.none,t.angle=0,ft.none):void 0!==a?a.toConnectShape(e):n.toConnectShape(e);case 1:var p=(x=new qt.QuadBezier(s,u[0],h)).tOfShavedStart(s),l=x.tOfShavedEnd(h);if(void 0===p||void 0===l||p>=l)return t.angle=0,t.lastCurve=Yt.none,ft.none;c=x.toShape(e,n,a),t.lastCurve=new Yt.QuadBezier(x,p,l,c),t.angle=Math.atan2(h.y-s.y,h.x-s.x);break;case 2:var x;p=(x=new qt.CubicBezier(s,u[0],u[1],h)).tOfShavedStart(s),l=x.tOfShavedEnd(h);if(void 0===p||void 0===l||p>=l)return t.angle=0,t.lastCurve=Yt.none,ft.none;c=x.toShape(e,n,a),t.lastCurve=new Yt.CubicBezier(x,p,l,c),t.angle=Math.atan2(h.y-s.y,h.x-s.x);break;default:var m=new qt.CubicBSpline(s,u,h),f=new qt.CubicBeziers(m.toCubicBeziers());p=f.tOfShavedStart(s),l=f.tOfShavedEnd(h);if(void 0===p||void 0===l||p>=l)return t.angle=0,t.lastCurve=Yt.none,ft.none;c=f.toShape(e,n,a),t.lastCurve=new Yt.CubicBSpline(s,h,f,p,l,c),t.angle=Math.atan2(h.y-s.y,h.x-s.x)}return c}}),on(Se.ObjectBox.Curve.Object.Drop,{objectForDrop:function(e){return this.object},objectForConnect:function(e){return e}}),on(Se.ObjectBox.Curve.Object.Connect,{objectForDrop:function(e){return e},objectForConnect:function(e){return this.object}}),on(Se.ObjectBox.Curve.PosList.CurPos,{addPositions:function(e,t){var n=t.env;e.push(n.c)}}),on(Se.ObjectBox.Curve.PosList.Pos,{addPositions:function(e,t){var n=t.env;this.pos.toShape(t),e.push(n.c)}}),on(Se.ObjectBox.Curve.PosList.AddStack,{addPositions:function(e,t){t.env.stack.reverse().foreach((function(t){e.push(t)}))}}),on(Se.Coord.C,{position:function(e){return e.env.c}}),on(Se.Coord.P,{position:function(e){return e.env.p}}),on(Se.Coord.X,{position:function(e){var t=e.env,n=t.p,r=t.c,a=t.origin,i=t.xBase,o=r.y-n.y,u=n.x-r.x,c=r.x*n.y-r.y*n.x,s=i.y,h=-i.x,p=i.x*a.y-i.y*a.x,l=o*h-s*u;if(Math.abs(l)<f.machinePrecision)return console.log("there is no intersection point."),Ht.originPosition;var x=-(h*c-u*p)/l,m=(s*c-o*p)/l;return new at.Point(x,m)}}),on(Se.Coord.Y,{position:function(e){var t=e.env,n=t.p,r=t.c,a=t.origin,i=t.yBase,o=r.y-n.y,u=n.x-r.x,c=r.x*n.y-r.y*n.x,s=i.y,h=-i.x,p=i.x*a.y-i.y*a.x,l=o*h-s*u;if(Math.abs(l)<f.machinePrecision)return console.log("there is no intersection point."),Ht.originPosition;var x=-(h*c-u*p)/l,m=(s*c-o*p)/l;return new at.Point(x,m)}}),on(Se.Coord.Vector,{position:function(e){var t=this.vector.xy(e);return new at.Point(t.x,t.y)}}),on(Se.Coord.Id,{position:function(e){return e.env.lookupPos(this.id).position(e)}}),on(Se.Coord.Group,{position:function(e){var t=e.env,n=t.origin,r=t.xBase,a=t.yBase,i=t.p;return this.posDecor.toShape(e),t.p=i,t.origin=n,t.xBase=r,t.yBase=a,t.c}}),on(Se.Coord.StackPosition,{position:function(e){return e.env.stackAt(this.number)}}),on(Se.Coord.DeltaRowColumn,{position:function(e){var t=e.env,n=t.xymatrixRow,r=t.xymatrixCol;if(void 0===n||void 0===r)throw new TeXError("ExecutionError","xymatrix rows and columns not found for "+this.toSring());var a=this.prefix+(n+this.dr)+","+(r+this.dc);return e.env.lookupPos(a,'in entry "'+t.xymatrixRow+","+t.xymatrixCol+'": No '+this+" (is "+a+") from here.").position(e)}}),on(Se.Coord.Hops,{position:function(e){var t=e.env,n=t.xymatrixRow,r=t.xymatrixCol;if(void 0===n||void 0===r)throw new TeXError("ExecutionError","xymatrix rows and columns not found for "+this.toSring());this.hops.foreach((function(e){switch(e){case"u":n-=1;break;case"d":n+=1;break;case"l":r-=1;break;case"r":r+=1}}));var a=this.prefix+n+","+r;return e.env.lookupPos(a,'in entry "'+t.xymatrixRow+","+t.xymatrixCol+'": No '+this+" (is "+a+") from here.").position(e)}}),on(Se.Coord.HopsWithPlace,{position:function(e){var t=e.env,n=t.xymatrixRow,r=t.xymatrixCol;if(void 0===n||void 0===r)throw new TeXError("ExecutionError","xymatrix rows and columns not found for "+this.toSring());this.hops.foreach((function(e){switch(e){case"u":n-=1;break;case"d":n+=1;break;case"l":r-=1;break;case"r":r+=1}}));var a=this.prefix+n+","+r,i=e.env.lookupPos(a,'in entry "'+t.xymatrixRow+","+t.xymatrixCol+'": No '+this+" (is "+a+") from here.").position(e),o=(t.c,t.duplicate());o.p=t.c,o.c=i;var u,c=o.c.x-o.p.x,s=o.c.y-o.p.y;u=0===c&&0===s?0:Math.atan2(s,c),o.angle=u;var h=o.p.edgePoint(o.c.x,o.c.y),p=o.c.edgePoint(o.p.x,o.p.y);o.lastCurve=new Yt.Line(h,p,o.p,o.c,void 0);var l=new Rt(ft.none,o),x=this.place.toShape(l);return o.lastCurve.position(x)}}),on(Se.Vector.InCurBase,{xy:function(e){return e.env.absVector(this.x,this.y)},angle:function(e){var t=e.env.absVector(this.x,this.y);return Math.atan2(t.y,t.x)}}),on(Se.Vector.Abs,{xy:function(e){return{x:r.MathJax.xypic.measure.length2em(this.x),y:r.MathJax.xypic.measure.length2em(this.y)}},angle:function(e){var t=this.xy(e);return Math.atan2(t.y,t.x)}}),on(Se.Vector.Angle,{xy:function(e){var t=Math.PI/180*this.degree,n=e.env.absVector(Math.cos(t),Math.sin(t));return n},angle:function(e){return Math.PI/180*this.degree}}),on(Se.Vector.Dir,{xy:function(e){var t=r.MathJax.xypic.measure.length2em(this.dimen),n=this.dir.angle(e);return{x:t*Math.cos(n),y:t*Math.sin(n)}},angle:function(e){return this.dir.angle(e)}}),on(Se.Vector.Corner,{xy:function(e){var t=this.corner.xy(e);return{x:t.x*this.factor,y:t.y*this.factor}},angle:function(e){return this.corner.angle(e)}}),on(Se.Corner.L,{xy:function(e){return{x:-e.env.c.l,y:0}},angle:function(e){return Math.PI}}),on(Se.Corner.R,{xy:function(e){return{x:e.env.c.r,y:0}},angle:function(e){return 0}}),on(Se.Corner.D,{xy:function(e){return{x:0,y:-e.env.c.d}},angle:function(e){return-Math.PI/2}}),on(Se.Corner.U,{xy:function(e){return{x:0,y:e.env.c.u}},angle:function(e){return Math.PI/2}}),on(Se.Corner.CL,{xy:function(e){var t=e.env.c;return{x:-t.l,y:(t.u-t.d)/2}},angle:function(e){var t=this.xy(e);return Math.atan2(t.y,t.x)}}),on(Se.Corner.CR,{xy:function(e){var t=e.env.c;return{x:t.r,y:(t.u-t.d)/2}},angle:function(e){var t=this.xy(e);return Math.atan2(t.y,t.x)}}),on(Se.Corner.CD,{xy:function(e){var t=e.env.c;return{x:(t.r-t.l)/2,y:-t.d}},angle:function(e){var t=this.xy(e);return Math.atan2(t.y,t.x)}}),on(Se.Corner.CU,{xy:function(e){var t=e.env.c;return{x:(t.r-t.l)/2,y:t.u}},angle:function(e){var t=this.xy(e);return Math.atan2(t.y,t.x)}}),on(Se.Corner.LU,{xy:function(e){var t=e.env.c;return{x:-t.l,y:t.u}},angle:function(e){var t=this.xy(e);return Math.atan2(t.y,t.x)}}),on(Se.Corner.LD,{xy:function(e){var t=e.env.c;return{x:-t.l,y:-t.d}},angle:function(e){var t=this.xy(e);return Math.atan2(t.y,t.x)}}),on(Se.Corner.RU,{xy:function(e){var t=e.env.c;return{x:t.r,y:t.u}},angle:function(e){var t=this.xy(e);return Math.atan2(t.y,t.x)}}),on(Se.Corner.RD,{xy:function(e){var t=e.env.c;return{x:t.r,y:-t.d}},angle:function(e){var t=this.xy(e);return Math.atan2(t.y,t.x)}}),on(Se.Corner.NearestEdgePoint,{xy:function(e){var t=e.env,n=t.c,r=n.edgePoint(t.p.x,t.p.y);return{x:r.x-n.x,y:r.y-n.y}},angle:function(e){var t=this.xy(e);return Math.atan2(t.y,t.x)}}),on(Se.Corner.PropEdgePoint,{xy:function(e){var t=e.env,n=t.c,r=n.proportionalEdgePoint(t.p.x,t.p.y);return{x:r.x-n.x,y:r.y-n.y}},angle:function(e){var t=this.xy(e);return Math.atan2(t.y,t.x)}}),on(Se.Corner.Axis,{xy:function(e){return{x:0,y:r.MathJax.xypic.measure.axisHeightLength}},angle:function(e){return Math.PI/2}}),on(Se.Modifier,{proceedModifyShape:function(e,t,n){return n.isEmpty?t:n.head.modifyShape(e,t,n.tail)}}),on(Se.Modifier.Vector,{preprocess:function(e,t){},modifyShape:function(e,t,n){var r=this.vector.xy(e),a=e.env;return a.c=a.c.shiftFrame(-r.x,-r.y),t=new ft.TranslateShape(-r.x,-r.y,t),this.proceedModifyShape(e,t,n)}}),on(Se.Modifier.RestoreOriginalRefPoint,{preprocess:function(e,t){},modifyShape:function(e,t,n){var r=e.env,a=r.originalReferencePoint;if(void 0!==a){var i=r.c.x-a.x,o=r.c.y-a.y;r.c=r.c.shiftFrame(i,o),t=new ft.TranslateShape(i,o,t)}return this.proceedModifyShape(e,t,n)}}),on(Se.Modifier.Shape.Point,{preprocess:function(e,t){},modifyShape:function(e,t,n){var r=e.env.c;return e.env.c=new at.Point(r.x,r.y),this.proceedModifyShape(e,t,n)}}),on(Se.Modifier.Shape.Rect,{preprocess:function(e,t){},modifyShape:function(e,t,n){var r=e.env.c;return e.env.c=new at.Rect(r.x,r.y,{l:r.l,r:r.r,u:r.u,d:r.d}),this.proceedModifyShape(e,t,n)}}),on(Se.Modifier.Shape.Circle,{preprocess:function(e,t){},modifyShape:function(e,t,n){var r=e.env.c;return e.env.c=new at.Ellipse(r.x,r.y,r.l,r.r,r.u,r.d),this.proceedModifyShape(e,t,n)}}),on(Se.Modifier.Shape.L,{preprocess:function(e,t){},modifyShape:function(e,t,n){var r=e.env,a=r.c;if(void 0!==a){var i,o,u=a.r+a.l,c=a.u+a.d;u<c?(i=(a.l-a.r)/2,o=(a.d-a.u)/2):(i=-a.r+c/2,o=(a.d-a.u)/2),r.c=r.c.shiftFrame(i,o),t=new ft.TranslateShape(i,o,t)}return this.proceedModifyShape(e,t,n)}}),on(Se.Modifier.Shape.R,{preprocess:function(e,t){},modifyShape:function(e,t,n){var r=e.env,a=r.c;if(void 0!==a){var i,o,u=a.r+a.l,c=a.u+a.d;u<c?(i=(a.l-a.r)/2,o=(a.d-a.u)/2):(i=a.l-c/2,o=(a.d-a.u)/2),r.c=r.c.shiftFrame(i,o),t=new ft.TranslateShape(i,o,t)}return this.proceedModifyShape(e,t,n)}}),on(Se.Modifier.Shape.U,{preprocess:function(e,t){},modifyShape:function(e,t,n){var r=e.env,a=r.c;if(void 0!==a){var i,o,u=a.r+a.l;u>a.u+a.d?(i=(a.l-a.r)/2,o=(a.d-a.u)/2):(i=(a.l-a.r)/2,o=a.d-u/2),r.c=r.c.shiftFrame(i,o),t=new ft.TranslateShape(i,o,t)}return this.proceedModifyShape(e,t,n)}}),on(Se.Modifier.Shape.D,{preprocess:function(e,t){},modifyShape:function(e,t,n){var r=e.env,a=r.c;if(void 0!==a){var i,o,u=a.r+a.l;u>a.u+a.d?(i=(a.l-a.r)/2,o=(a.d-a.u)/2):(i=(a.l-a.r)/2,o=-a.u+u/2),r.c=r.c.shiftFrame(i,o),t=new ft.TranslateShape(i,o,t)}return this.proceedModifyShape(e,t,n)}}),on(Se.Modifier.Shape.C,{preprocess:function(e,t){},modifyShape:function(e,t,n){var r,a,i=e.env,o=i.c;void 0!==o&&(r=(o.l-o.r)/2,a=(o.d-o.u)/2,i.c=i.c.shiftFrame(r,a),t=new ft.TranslateShape(r,a,t));return this.proceedModifyShape(e,t,n)}}),on(Se.Modifier.Shape.ChangeColor,{preprocess:function(e,t){},modifyShape:function(e,t,n){return t=this.proceedModifyShape(e,t,n),new ft.ChangeColorShape(this.colorName,t)}}),on(Se.Modifier.Shape.Alphabets,{preprocess:function(e,t){var n=r.MathJax.xypic.repositories.modifierRepository.get(this.alphabets);if(void 0!==n)return n.preprocess(e,t)},modifyShape:function(e,t,n){var a=r.MathJax.xypic.repositories.modifierRepository.get(this.alphabets);if(void 0!==a)return a.modifyShape(e,t,n)}}),on(Se.Modifier.Shape.DefineShape,{preprocess:function(e,t){var n=t.reverse();r.MathJax.xypic.repositories.modifierRepository.put(this.shape,new Se.Modifier.Shape.CompositeModifiers(n))},modifyShape:function(e,t,n){return this.proceedModifyShape(e,t,n)}}),on(Se.Modifier.Shape.CompositeModifiers,{preprocess:function(e,t){this.modifiers.foreach((function(n){n.preprocess(e,t),t=t.prepend(n)}))},modifyShape:function(e,t,n){return t=this.proceedModifyShape(e,t,this.modifiers),this.proceedModifyShape(e,t,n)}}),on(Se.Modifier.Invisible,{preprocess:function(e,t){},modifyShape:function(e,t,n){return t=this.proceedModifyShape(e,t,n),ft.none}}),on(Se.Modifier.Hidden,{preprocess:function(e,t){},modifyShape:function(e,t,n){return this.proceedModifyShape(e,t,n)}}),on(Se.Modifier.Direction,{preprocess:function(e,t){e.env.angle=this.direction.angle(e)},modifyShape:function(e,t,n){return e.env.angle=this.direction.angle(e),this.proceedModifyShape(e,t,n)}}),on(Se.Modifier.AddOp,{preprocess:function(e,t){},modifyShape:function(e,t,n){var r=e.env.c;return e.env.c=this.op.apply(this.size,r,e),e.appendShapeToFront(new ft.InvisibleBoxShape(e.env.c)),this.proceedModifyShape(e,t,n)}}),on(Se.Modifier.AddOp.Grow,{apply:function(e,t,n){var r=n.env,a=e.isDefault?{x:2*r.objectmargin,y:2*r.objectmargin}:e.vector.xy(n),i=Math.abs(a.x/2),o=Math.abs(a.y/2);return t.grow(i,o)},applyToDimen:function(e,t){return e+t}}),on(Se.Modifier.AddOp.Shrink,{apply:function(e,t,n){var r=n.env,a=e.isDefault?{x:2*r.objectmargin,y:2*r.objectmargin}:e.vector.xy(n),i=-Math.abs(a.x/2),o=-Math.abs(a.y/2);return t.grow(i,o)},applyToDimen:function(e,t){return e-t}}),on(Se.Modifier.AddOp.Set,{apply:function(e,t,n){var r=n.env,a=e.isDefault?{x:r.objectwidth,y:r.objectheight}:e.vector.xy(n),i=Math.abs(a.x),o=Math.abs(a.y);return t.toSize(i,o)},applyToDimen:function(e,t){return t}}),on(Se.Modifier.AddOp.GrowTo,{apply:function(e,t,n){var r=Math.max(t.l+t.r,t.u+t.d),a=e.isDefault?{x:r,y:r}:e.vector.xy(n),i=Math.abs(a.x),o=Math.abs(a.y);return t.growTo(i,o)},applyToDimen:function(e,t){return Math.max(Math.max(e,t),0)}}),on(Se.Modifier.AddOp.ShrinkTo,{apply:function(e,t,n){var r=Math.min(t.l+t.r,t.u+t.d),a=e.isDefault?{x:r,y:r}:e.vector.xy(n),i=Math.abs(a.x),o=Math.abs(a.y);return t.shrinkTo(i,o)},applyToDimen:function(e,t){return Math.max(Math.min(e,t),0)}}),on(Se.Modifier.Shape.Frame,{preprocess:function(e,t){},modifyShape:function(e,t,n){var r=e.env;if(void 0!==r.c){this.main;var a=new Se.ObjectBox.Frame.Radius.Default,i="currentColor";this.options.foreach((function(e){a=e.getRadius(a)})),this.options.foreach((function(e){i=e.getColorName(i)}));var o=r.duplicate(),u=new Rt(ft.none,o),c=new Se.ObjectBox.Frame(a,this.main).toDropFilledShape(u,i,r.c.isCircle());t=new ft.CompositeShape(t,c)}return this.proceedModifyShape(e,t,n)}}),on(Se.Modifier.Shape.Frame.Radius,{getRadius:function(e){return new Se.ObjectBox.Frame.Radius.Vector(this.vector)},getColorName:function(e){return e}}),on(Se.Modifier.Shape.Frame.Color,{getRadius:function(e){return e},getColorName:function(e){return this.colorName}}),on(Se.Direction.Compound,{angle:function(e){var t=this.dir.angle(e);return this.rots.foreach((function(n){t=n.rotate(t,e)})),t}}),on(Se.Direction.Diag,{angle:function(e){return this.diag.angle(e)}}),on(Se.Direction.Vector,{angle:function(e){return this.vector.angle(e)}}),on(Se.Direction.ConstructVector,{angle:function(e){var t=e.env,n=t.origin,r=t.xBase,a=t.yBase,i=t.p,o=t.c;this.posDecor.toShape(e);var u=Math.atan2(t.c.y-t.p.y,t.c.x-t.p.x);return t.c=o,t.p=i,t.origin=n,t.xBase=r,t.yBase=a,u}}),on(Se.Direction.RotVector,{rotate:function(e,t){return e+this.vector.angle(t)}}),on(Se.Direction.RotCW,{rotate:function(e,t){return e+Math.PI/2}}),on(Se.Direction.RotAntiCW,{rotate:function(e,t){return e-Math.PI/2}}),on(Se.Diag.Default,{isEmpty:!0,angle:function(e){return e.env.angle}}),on(Se.Diag.Angle,{isEmpty:!1,angle:function(e){return this.ang}}),on(Se.Decor,{toShape:function(e){this.commands.foreach((function(t){t.toShape(e)}))}}),on(Se.Command.Save,{toShape:function(e){e.env.saveState(),this.pos.toShape(e)}}),on(Se.Command.Restore,{toShape:function(e){e.env.restoreState()}}),on(Se.Command.Pos,{toShape:function(e){this.pos.toShape(e)}}),on(Se.Command.AfterPos,{toShape:function(e){this.pos.toShape(e),this.decor.toShape(e)}}),on(Se.Command.Drop,{toShape:function(e){this.object.toDropShape(e)}}),on(Se.Command.Connect,{toShape:function(e){this.object.toConnectShape(e)}}),on(Se.Command.Relax,{toShape:function(e){}}),on(Se.Command.Ignore,{toShape:function(e){}}),on(Se.Command.ShowAST,{toShape:function(e){console.log(this.pos.toString()+" "+this.decor)}}),on(Se.Command.Ar,{toShape:function(e){var t=e.env,n=t.origin,r=t.xBase,a=t.yBase,i=t.p,o=t.c;t.pathActionForBeforeSegment=k.empty,t.pathActionForAfterSegment=k.empty,t.labelsForNextSegmentOnly=k.empty,t.labelsForLastSegmentOnly=k.empty,t.labelsForEverySegment=k.empty,t.segmentSlideEm=k.empty,t.lastTurnDiag=k.empty,t.arrowVariant="",t.tailTip=new Se.Command.Ar.Form.Tip.Tipchars(""),t.headTip=new Se.Command.Ar.Form.Tip.Tipchars(">"),t.stemConn=new Se.Command.Ar.Form.Conn.Connchars("-"),t.reverseAboveAndBelow=!1,t.arrowObjectModifiers=F.empty,this.forms.foreach((function(t){t.toShape(e)})),t.pathActionForBeforeSegment.isDefined||(t.pathActionForBeforeSegment=new k.Some(new Se.PosDecor(new Se.Pos.Coord(new Se.Coord.C,F.empty.append(new Se.Pos.ConnectObject(new Se.Object(t.arrowObjectModifiers,t.stemConn.getObject(e))))),new Se.Decor(F.empty)))),t.labelsForNextSegmentOnly=new k.Some(new Se.Command.Path.Labels(F.empty.append(new Se.Command.Path.Label.At(new Se.Pos.Place(new Se.Place(1,1,new Se.Place.Factor(0),new Se.Slide(k.empty))),t.tailTip.getObject(e),k.empty)))),t.labelsForLastSegmentOnly=new k.Some(new Se.Command.Path.Labels(F.empty.append(new Se.Command.Path.Label.At(new Se.Pos.Place(new Se.Place(1,1,new Se.Place.Factor(1),new Se.Slide(k.empty))),t.headTip.getObject(e),k.empty)))),this.path.toShape(e),t.c=o,t.p=i,t.origin=n,t.xBase=r,t.yBase=a}}),on(Se.Command.Ar.Form.BuildArrow,{toShape:function(e){var t=e.env;t.arrowVariant=this.variant,t.tailTip=this.tailTip,t.stemConn=this.stemConn,t.headTip=this.headTip}}),on(Se.Command.Ar.Form.ChangeVariant,{toShape:function(e){e.env.arrowVariant=this.variant}}),on(Se.Command.Ar.Form.ChangeStem,{toShape:function(e){e.env.stemConn=new Se.Command.Ar.Form.Conn.Connchars(this.connchar)}}),on(Se.Command.Ar.Form.DashArrowStem,{toShape:function(e){}}),on(Se.Command.Ar.Form.CurveArrow,{toShape:function(e){var t=e.env,n=r.MathJax.xypic.measure.em2length(2*r.MathJax.xypic.measure.length2em(this.dist));t.pathActionForBeforeSegment=new k.Some(new Se.PosDecor(new Se.Pos.Coord(new Se.Coord.C,F.empty.append(new Se.Pos.ConnectObject(new Se.Object(t.arrowObjectModifiers,new Se.ObjectBox.Curve(F.empty,F.empty.append(new Se.ObjectBox.Curve.Object.Connect(t.stemConn.getObject(e))),F.empty.append(new Se.ObjectBox.Curve.PosList.Pos(new Se.Pos.Coord(new Se.Coord.Group(new Se.PosDecor(new Se.Pos.Coord(new Se.Coord.C,F.empty.append(new Se.Pos.ConnectObject(new Se.Object(F.empty,new Se.ObjectBox.Dir("","")))).append(new Se.Pos.Place(new Se.Place(0,0,void 0,new Se.Slide(k.empty)))).append(new Se.Pos.Plus(new Se.Coord.Vector(new Se.Vector.Dir(this.direction,n))))),new Se.Decor(F.empty))),F.empty)))))))),new Se.Decor(F.empty)))}}),on(Se.Command.Ar.Form.CurveFitToDirection,{toShape:function(e){var t=e.env;t.pathActionForBeforeSegment=new k.Some(new Se.PosDecor(new Se.Pos.Coord(new Se.Coord.C,F.empty.append(new Se.Pos.ConnectObject(new Se.Object(t.arrowObjectModifiers,new Se.ObjectBox.Curve(F.empty,F.empty.append(new Se.ObjectBox.Curve.Object.Connect(t.stemConn.getObject(e))),F.empty.append(new Se.ObjectBox.Curve.PosList.Pos(new Se.Pos.Coord(new Se.Coord.C,F.empty.append(new Se.Pos.SwapPAndC(new Se.Coord.C)).append(new Se.Pos.Plus(new Se.Coord.Vector(new Se.Vector.Dir(this.outDirection,"3pc"))))))).append(new Se.ObjectBox.Curve.PosList.Pos(new Se.Pos.Coord(new Se.Coord.C,F.empty.append(new Se.Pos.SwapPAndC(new Se.Coord.C)).append(new Se.Pos.Plus(new Se.Coord.Vector(new Se.Vector.Dir(this.inDirection,"3pc")))))))))))),new Se.Decor(F.empty)))}}),on(Se.Command.Ar.Form.CurveWithControlPoints,{toShape:function(e){var t=e.env,n=t.duplicate();n.startCapturePositions();var r=new Rt(ft.none,n);this.coord.position(r);var a=n.endCapturePositions();a=a.append(n.c);var i=F.empty;a.reverse().foreach((function(e){var n=t.inverseAbsVector(e.x,e.y);i=i.prepend(new Se.ObjectBox.Curve.PosList.Pos(new Se.Pos.Coord(new Se.Coord.Vector(new Se.Vector.InCurBase(n.x,n.y)),F.empty)))})),t.pathActionForBeforeSegment=new k.Some(new Se.PosDecor(new Se.Pos.Coord(new Se.Coord.C,F.empty.append(new Se.Pos.ConnectObject(new Se.Object(t.arrowObjectModifiers,new Se.ObjectBox.Curve(F.empty,F.empty.append(new Se.ObjectBox.Curve.Object.Connect(t.stemConn.getObject(e))),i))))),new Se.Decor(F.empty)))}}),on(Se.Command.Ar.Form.AddShape,{toShape:function(e){e.env.arrowObjectModifiers=F.empty.append(this.shape)}}),on(Se.Command.Ar.Form.AddModifiers,{toShape:function(e){e.env.arrowObjectModifiers=this.modifiers}}),on(Se.Command.Ar.Form.Slide,{toShape:function(e){e.env.segmentSlideEm=new k.Some(r.MathJax.xypic.measure.length2em(this.slideDimen))}}),on(Se.Command.Ar.Form.LabelAt,{toShape:function(e){e.env.labelsForEverySegment=new k.Some(new Se.Command.Path.Labels(F.empty.append(new Se.Command.Path.Label.At(new Se.Pos.Place(this.anchor),this.it,k.empty))))}}),on(Se.Command.Ar.Form.LabelAbove,{toShape:function(e){var t,n=e.env;t=n.reverseAboveAndBelow?new Se.Command.Path.Label.Below(new Se.Pos.Place(this.anchor),this.it,k.empty):new Se.Command.Path.Label.Above(new Se.Pos.Place(this.anchor),this.it,k.empty),n.labelsForEverySegment=new k.Some(new Se.Command.Path.Labels(F.empty.append(t)))}}),on(Se.Command.Ar.Form.LabelBelow,{toShape:function(e){var t,n=e.env;t=n.reverseAboveAndBelow?new Se.Command.Path.Label.Above(new Se.Pos.Place(this.anchor),this.it,k.empty):new Se.Command.Path.Label.Below(new Se.Pos.Place(this.anchor),this.it,k.empty),n.labelsForEverySegment=new k.Some(new Se.Command.Path.Labels(F.empty.append(t)))}}),on(Se.Command.Ar.Form.ReverseAboveAndBelow,{toShape:function(e){e.env.reverseAboveAndBelow=!0}}),on(Se.Command.Ar.Form.Conn.Connchars,{getObject:function(e){var t=e.env,n=new Se.ObjectBox.Dir(t.arrowVariant,this.connchars);return new Se.Object(t.arrowObjectModifiers,n)}}),on(Se.Command.Ar.Form.Conn.Object,{getObject:function(e){var t=e.env.arrowObjectModifiers.concat(this.object.modifiers);return new Se.Object(t,this.object.object)}}),on(Se.Command.Ar.Form.Conn.Dir,{getObject:function(e){var t=e.env,n=this.dir,r=n;return""===n.variant&&""!==t.arrowVariant&&(r=new Se.ObjectBox.Dir(t.arrowVariant,n.main)),new Se.Object(t.arrowObjectModifiers,r)}}),on(Se.Command.Ar.Form.Tip.Tipchars,{getObject:function(e){var t=e.env,n=new Se.ObjectBox.Dir(t.arrowVariant,this.tipchars);return new Se.Object(t.arrowObjectModifiers,n)}}),on(Se.Command.Ar.Form.Tip.Object,{getObject:function(e){var t=e.env.arrowObjectModifiers.concat(this.object.modifiers);return new Se.Object(t,this.object.object)}}),on(Se.Command.Ar.Form.Tip.Dir,{getObject:function(e){var t=e.env,n=this.dir,r=n;return""===n.variant&&""!==t.arrowVariant&&(r=new Se.ObjectBox.Dir(t.arrowVariant,n.main)),new Se.Object(t.arrowObjectModifiers,r)}}),on(Se.Command.Path,{toShape:function(e){var t=e.env,n=t.origin,r=t.xBase,a=t.yBase,i=t.p,o=t.c;t.pathActionForBeforeSegment=k.empty,t.pathActionForAfterSegment=k.empty,t.labelsForNextSegmentOnly=k.empty,t.labelsForLastSegmentOnly=k.empty,t.labelsForEverySegment=k.empty,t.segmentSlideEm=k.empty,t.lastTurnDiag=k.empty,this.path.toShape(e),t.c=o,t.p=i,t.origin=n,t.xBase=r,t.yBase=a}}),on(Se.Command.AfterPath,{toShape:function(e){this.path.toShape(e),this.decor.toShape(e)}}),on(Se.Command.Path.Path,{toShape:function(e){this.pathElements.foreach((function(t){t.toShape(e)}))}}),on(Se.Command.Path.SetBeforeAction,{toShape:function(e){e.env.pathActionForBeforeSegment=new k.Some(this.posDecor)}}),on(Se.Command.Path.SetAfterAction,{toShape:function(e){e.env.pathActionForAfterSegment=new k.Some(this.posDecor)}}),on(Se.Command.Path.AddLabelNextSegmentOnly,{toShape:function(e){e.env.labelsForNextSegmentOnly=new k.Some(this.labels)}}),on(Se.Command.Path.AddLabelLastSegmentOnly,{toShape:function(e){e.env.labelsForLastSegmentOnly=new k.Some(this.labels)}}),on(Se.Command.Path.AddLabelEverySegment,{toShape:function(e){e.env.labelsForEverySegment=new k.Some(this.labels)}}),on(Se.Command.Path.StraightSegment,{toShape:function(e){var t=e.env;this.segment.setupPositions(e);var n=t.c;t.pathActionForBeforeSegment.foreach((function(t){t.toShape(e)})),t.labelsForNextSegmentOnly.foreach((function(n){n.toShape(e),t.labelsForNextSegmentOnly=k.empty})),t.labelsForEverySegment.foreach((function(t){t.toShape(e)})),t.c=n,t.pathActionForAfterSegment.foreach((function(t){t.toShape(e)})),this.segment.toLabelsShape(e)}}),on(Se.Command.Path.LastSegment,{toShape:function(e){var t=e.env;this.segment.setupPositions(e);var n=t.c;t.pathActionForBeforeSegment.foreach((function(t){t.toShape(e)})),t.labelsForNextSegmentOnly.foreach((function(n){n.toShape(e),t.labelsForNextSegmentOnly=k.empty})),t.labelsForLastSegmentOnly.foreach((function(n){n.toShape(e),t.labelsForNextSegmentOnly=k.empty})),t.labelsForEverySegment.foreach((function(t){t.toShape(e)})),t.c=n,t.pathActionForAfterSegment.foreach((function(t){t.toShape(e)})),this.segment.toLabelsShape(e)}}),on(Se.Command.Path.TurningSegment,{toShape:function(e){var t=e.env,n=t.c;this.segment.pos.toShape(e),t.p=n;var a=this.turn.explicitizedCircle(e),i=this.turn.radius.radius(e);t.lastTurnDiag=new k.Some(a.endDiag);var o=a.startVector(e),u=a.endVector(e),c=t.segmentSlideEm.getOrElse(0);this.segment.slide.dimen.foreach((function(e){c=r.MathJax.xypic.measure.length2em(e),t.segmentSlideEm=new k.Some(c)})),0!==c&&(t.p=t.p.move(t.p.x-c*o.y,t.p.y+c*o.x),t.c=t.c.move(t.c.x-c*u.y,t.c.y+c*u.x),i="^"===a.orient?Math.max(0,i-c):Math.max(0,i+c));var s,h=t.p.edgePoint(t.p.x+o.x,t.p.y+o.y),p=t.c,l=a.relativeStartPoint(e,i),x=a.relativeEndPoint(e,i),m=a.relativeEndPoint(e,i+("^"===a.orient?c:-c)),d=o.x*u.y-o.y*u.x;if(Math.abs(d)<f.machinePrecision)s=0;else{var y=p.x-h.x+l.x-x.x,v=p.y-h.y+l.y-x.y;(s=(u.y*y-u.x*v)/d)<0&&(s=0)}var g=h.x-l.x+s*o.x,M=h.y-l.y+s*o.y,w=(a.toDropShape(e,g,M,i),new at.Point(g+m.x,M+m.y));t.c=new at.Point(g+l.x,M+l.y),t.pathActionForBeforeSegment.foreach((function(t){t.toShape(e)})),t.labelsForNextSegmentOnly.foreach((function(n){n.toShape(e),t.labelsForNextSegmentOnly=k.empty})),t.labelsForEverySegment.foreach((function(t){t.toShape(e)})),t.c=w,t.pathActionForAfterSegment.foreach((function(t){t.toShape(e)})),this.segment.toLabelsShape(e)}}),on(Se.Command.Path.Turn.Cir,{explicitizedCircle:function(e){var t,n,r,a=e.env;return t=this.cir.startDiag.isEmpty?a.lastTurnDiag.getOrElse(new Se.Diag.R):this.cir.startDiag,n=this.cir.orient,r=this.cir.endDiag.isEmpty?t.turn(n):this.cir.endDiag,new Se.ObjectBox.Cir.Cir.Segment(t,n,r)}}),on(Se.ObjectBox.Cir.Cir.Segment,{startVector:function(e){var t=this.startDiag.angle(e);return{x:Math.cos(t),y:Math.sin(t)}},endVector:function(e){var t=this.endDiag.angle(e);return{x:Math.cos(t),y:Math.sin(t)}},relativeStartPointAngle:function(e){return this.startPointDegree(e)/180*Math.PI},relativeStartPoint:function(e,t){var n=this.startPointDegree(e)/180*Math.PI;return{x:t*Math.cos(n),y:t*Math.sin(n)}},relativeEndPoint:function(e,t){var n;return n=this.endPointDegree(e,this.relativeStartPointAngle(e))/180*Math.PI,{x:t*Math.cos(n),y:t*Math.sin(n)}}}),on(Se.Command.Path.Turn.Diag,{explicitizedCircle:function(e){var t,n,r,a=e.env,i=(t=this.diag.isEmpty?a.lastTurnDiag.getOrElse(new Se.Diag.R):this.diag).angle(e);return n=(a.c.x-a.p.x)*Math.sin(i)-(a.c.y-a.p.y)*Math.cos(i)<0?"^":"_",r=t.turn(n),new Se.ObjectBox.Cir.Cir.Segment(t,n,r)}}),on(Se.Command.Path.TurnRadius.Default,{radius:function(e){return r.MathJax.xypic.measure.turnradius}}),on(Se.Command.Path.TurnRadius.Dimen,{radius:function(e){return r.MathJax.xypic.measure.length2em(this.dimen)}}),on(Se.Command.Path.Segment,{setupPositions:function(e){var t=e.env;t.p=t.c,this.pos.toShape(e);var n=t.p,a=t.c,i=a.x-n.x,o=a.y-n.y,u=Math.atan2(o,i)+Math.PI/2,c=t.segmentSlideEm.getOrElse(0);this.slide.dimen.foreach((function(e){c=r.MathJax.xypic.measure.length2em(e),t.segmentSlideEm=new k.Some(c)})),0!==c&&(n=n.move(n.x+c*Math.cos(u),n.y+c*Math.sin(u)),a=a.move(a.x+c*Math.cos(u),a.y+c*Math.sin(u))),t.p=n,t.c=a},toLabelsShape:function(e){var t=e.env,n=t.c,r=t.p;this.labels.toShape(e),t.c=n,t.p=r}}),on(Se.Command.Path.Labels,{toShape:function(e){this.labels.foreach((function(t){t.toShape(e)}))}}),on(Se.Command.Path.Label,{toShape:function(e){var t=e.env,n=t.p,r=t.c,a=this.anchor.toShape(e),i=this.getLabelMargin(e);if(0!==i){var o;o=(M=t.lastCurve).isNone?Math.atan2(r.y-n.y,r.x-n.x)+Math.PI/2:M.angle(a)+Math.PI/2+(i>0?0:Math.PI);r=t.c;var u=new Rt(ft.none,t);this.it.toDropShape(u);var c=u.shape,s=c.getBoundingBox();if(void 0!==s){var h=s.x-r.x,p=s.y-r.y,l=s.l,x=s.r,m=s.u,f=s.d,d=Math.cos(o),y=Math.sin(o),v=Math.min((h-l)*d+(p-f)*y,(h-l)*d+(p+m)*y,(h+x)*d+(p-f)*y,(h+x)*d+(p+m)*y),g=Math.abs(i)-v;t.c=t.c.move(r.x+g*d,r.y+g*y),e.appendShapeToFront(new ft.TranslateShape(g*d,g*y,c))}}else this.it.toDropShape(e);var M=t.lastCurve;this.shouldSliceHole&&M.isDefined&&void 0!==a&&M.sliceHole(t.c,a),this.aliasOption.foreach((function(e){t.savePos(e,new tn.Position(t.c))}))}}),on(Se.Command.Path.Label.Above,{getLabelMargin:function(e){return e.env.labelmargin},shouldSliceHole:!1}),on(Se.Command.Path.Label.Below,{getLabelMargin:function(e){return-e.env.labelmargin},shouldSliceHole:!1}),on(Se.Command.Path.Label.At,{getLabelMargin:function(e){return 0},shouldSliceHole:!0}),on(Se.Command.Xymatrix,{toShape:function(e){var t=e.env;if(void 0===t.c)return ft.none;var n=t.duplicate(),a=new Rt(ft.none,n);n.xymatrixPrefix="",n.xymatrixRowSepEm=r.MathJax.xypic.measure.length2em("2pc"),n.xymatrixColSepEm=r.MathJax.xypic.measure.length2em("2pc"),n.xymatrixPretendEntryHeight=k.empty,n.xymatrixPretendEntryWidth=k.empty,n.xymatrixFixedRow=!1,n.xymatrixFixedCol=!1,n.xymatrixOrientationAngle=0,n.xymatrixEntryModifiers=F.empty,this.setup.foreach((function(e){e.toShape(a)}));var i,o,u=n.xymatrixOrientationAngle,c=0,s=0,h=new un(this.rows.map((function(e){s+=1,o=0;var t=new un.Row(e.entries.map((function(e){o+=1;var t=n.duplicate();t.origin={x:0,y:0},t.p=t.c=Ht.originPosition,t.angle=0,t.lastCurve=Yt.none,t.xymatrixRow=s,t.xymatrixCol=o;var r,a,i,u,c=new Rt(ft.none,t),h=e.toShape(c),p=t.c;if(n.xymatrixPretendEntryHeight.isDefined){var l=n.xymatrixPretendEntryHeight.get;i=l/2,u=l/2}else i=p.u,u=p.d;if(n.xymatrixPretendEntryWidth.isDefined){var x=n.xymatrixPretendEntryWidth.get;r=x/2,a=x/2}else r=p.l,a=p.r;var m=new at.Rect(0,0,{l:r,r:a,u:i,d:u});return new un.Entry(t.c,h,e.decor,m)})),u);return c=Math.max(c,o),t})),u);if(0===(i=s))return ft.none;h.rows.foreach((function(e){o=0,e.entries.foreach((function(e){o+=1,h.getColumn(o).addEntry(e)}))}));var p,l,x=n.xymatrixColSepEm,m=[],f=t.c.x;if(m.push(f),n.xymatrixFixedCol){var d=0,y=0;h.columns.foreach((function(e){d=Math.max(d,e.getL()),y=Math.max(y,e.getR())})),h.columns.tail.foreach((function(e){f=f+y+x+d,m.push(f)})),p=d,l=m[m.length-1]+y}else{var v=h.columns.head;h.columns.tail.foreach((function(e){f=f+v.getR()+x+e.getL(),m.push(f),v=e})),p=h.columns.head.getL(),l=f+h.columns.at(c-1).getR()-m[0]}var g,M,w=n.xymatrixRowSepEm,S=[],b=t.c.y;if(S.push(b),n.xymatrixFixedRow){var C=0,J=0;h.rows.foreach((function(e){C=Math.max(C,e.getU()),J=Math.max(J,e.getD())})),h.rows.tail.foreach((function(e){b-=J+w+C,S.push(b)})),g=C,M=S[0]-S[S.length-1]+J}else{var P=h.rows.head;h.rows.tail.foreach((function(e){b-=P.getD()+w+e.getU(),S.push(b),P=e})),g=h.rows.head.getU(),M=S[0]-b+h.rows.at(i-1).getD()}t.c=new at.Rect(t.c.x,t.c.y,{l:p,r:l,u:g,d:M});var O=n.xymatrixPrefix,B=Math.cos(u),E=Math.sin(u),A=0;h.rows.foreach((function(e){var t=0;e.entries.foreach((function(e){var r=m[t],a=S[A],i=r*B-a*E,o=r*E+a*B,u=t+1,c=A+1,s=new tn.Position(e.c.move(i,o));n.savePos(c+","+u,s),n.savePos(O+c+","+u,s),t+=1})),A+=1})),a=new Rt(ft.none,n);A=0;h.rows.foreach((function(e){var t=0;e.entries.foreach((function(e){var r=m[t],i=S[A],o=r*B-i*E,u=r*E+i*B,c=t+1,s=A+1,h=new ft.TranslateShape(o,u,e.objectShape);a.appendShapeToFront(h),n.c=e.c.move(o,u),n.xymatrixRow=s,n.xymatrixCol=c,e.decor.toShape(a),t+=1})),A+=1}));var L=a.shape;return e.appendShapeToFront(L),t.savedPosition=n.savedPosition,L}});var un=function(){function e(t,n){nn(this,e),this.rows=t,this.columns=F.empty,this.orientation=n}return an(e,[{key:"getColumn",value:function(t){if(this.columns.length()>=t)return this.columns.at(t-1);var n=new e.Column(this.orientation);return this.columns=this.columns.append(n),n}},{key:"toString",value:function(){return"Xymatrix{\n"+this.rows.mkString("\\\\\n")+"\n}"}}]),e}();function cn(e){return(cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sn(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return hn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hn(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,u=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){u=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(u)throw i}}}}function hn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function pn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ln(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xn(e,t,n){return t&&ln(e.prototype,t),n&&ln(e,n),e}function mn(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fn(e,t)}function fn(e,t){return(fn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function dn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=vn(e);if(t){var a=vn(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return yn(this,n)}}function yn(e,t){return!t||"object"!==cn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vn(e){return(vn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}un.Row=function(){function e(t,n){nn(this,e),this.entries=t,this.orientation=n,We(this,"getU"),We(this,"getD")}return an(e,[{key:"getU",value:function(){var e=this.orientation,t=0;return this.entries.foreach((function(n){t=Math.max(t,n.getU(e))})),t}},{key:"getD",value:function(){var e=this.orientation,t=0;return this.entries.foreach((function(n){t=Math.max(t,n.getD(e))})),t}},{key:"toString",value:function(){return this.entries.mkString(" & ")}}]),e}(),un.Column=function(){function e(t){nn(this,e),this.entries=F.empty,this.orientation=t,We(this,"getL"),We(this,"getR")}return an(e,[{key:"addEntry",value:function(e){this.entries=this.entries.append(e),this.getL.reset,this.getR.reset}},{key:"getL",value:function(){var e=this.orientation,t=0;return this.entries.foreach((function(n){t=Math.max(t,n.getL(e))})),t}},{key:"getR",value:function(){var e=this.orientation,t=0;return this.entries.foreach((function(n){t=Math.max(t,n.getR(e))})),t}},{key:"toString",value:function(){return this.entries.mkString(" \\\\ ")}}]),e}(),un.Entry=function(){function e(t,n,r,a){nn(this,e),this.c=t,this.objectShape=n,this.decor=r,this.frame=a}return an(e,[{key:"getDistanceToEdgePoint",value:function(e,t){var n=e.edgePoint(e.x+Math.cos(t),e.y+Math.sin(t)),r=n.x-e.x,a=n.y-e.y;return Math.sqrt(r*r+a*a)}},{key:"getU",value:function(e){return 0===e?this.frame.u:this.getDistanceToEdgePoint(this.frame,e+Math.PI/2)}},{key:"getD",value:function(e){return 0===e?this.frame.d:this.getDistanceToEdgePoint(this.frame,e-Math.PI/2)}},{key:"getL",value:function(e){return 0===e?this.frame.l:this.getDistanceToEdgePoint(this.frame,e+Math.PI)}},{key:"getR",value:function(e){return 0===e?this.frame.r:this.getDistanceToEdgePoint(this.frame,e)}},{key:"toString",value:function(){return this.objectShape.toString()+" "+this.decor}}]),e}(),on(Se.Command.Xymatrix.Setup.Prefix,{toShape:function(e){e.env.xymatrixPrefix=this.prefix}}),on(Se.Command.Xymatrix.Setup.ChangeSpacing.Row,{toShape:function(e){var t=e.env;t.xymatrixRowSepEm=this.addop.applyToDimen(t.xymatrixRowSepEm,r.MathJax.xypic.measure.length2em(this.dimen))}}),on(Se.Command.Xymatrix.Setup.ChangeSpacing.Column,{toShape:function(e){var t=e.env;t.xymatrixColSepEm=this.addop.applyToDimen(t.xymatrixColSepEm,r.MathJax.xypic.measure.length2em(this.dimen))}}),on(Se.Command.Xymatrix.Setup.ChangeSpacing.RowAndColumn,{toShape:function(e){var t=e.env,n=this.addop.applyToDimen(t.xymatrixRowSepEm,r.MathJax.xypic.measure.length2em(this.dimen));t.xymatrixRowSepEm=n,t.xymatrixColSepEm=n}}),on(Se.Command.Xymatrix.Setup.PretendEntrySize.Height,{toShape:function(e){e.env.xymatrixPretendEntryHeight=new k.Some(r.MathJax.xypic.measure.length2em(this.dimen))}}),on(Se.Command.Xymatrix.Setup.PretendEntrySize.Width,{toShape:function(e){e.env.xymatrixPretendEntryWidth=new k.Some(r.MathJax.xypic.measure.length2em(this.dimen))}}),on(Se.Command.Xymatrix.Setup.PretendEntrySize.HeightAndWidth,{toShape:function(e){var t=new k.Some(r.MathJax.xypic.measure.length2em(this.dimen));e.env.xymatrixPretendEntryHeight=t,e.env.xymatrixPretendEntryWidth=t}}),on(Se.Command.Xymatrix.Setup.FixGrid.Row,{toShape:function(e){e.env.xymatrixFixedRow=!0}}),on(Se.Command.Xymatrix.Setup.FixGrid.Column,{toShape:function(e){e.env.xymatrixFixedCol=!0}}),on(Se.Command.Xymatrix.Setup.FixGrid.RowAndColumn,{toShape:function(e){e.env.xymatrixFixedRow=!0,e.env.xymatrixFixedCol=!0}}),on(Se.Command.Xymatrix.Setup.AdjustEntrySize.Margin,{toShape:function(e){var t=e.env;t.objectmargin=this.addop.applyToDimen(t.objectmargin,r.MathJax.xypic.measure.length2em(this.dimen))}}),on(Se.Command.Xymatrix.Setup.AdjustEntrySize.Width,{toShape:function(e){var t=e.env;t.objectwidth=this.addop.applyToDimen(t.objectwidth,r.MathJax.xypic.measure.length2em(this.dimen))}}),on(Se.Command.Xymatrix.Setup.AdjustEntrySize.Height,{toShape:function(e){var t=e.env;t.objectheight=this.addop.applyToDimen(t.objectheight,r.MathJax.xypic.measure.length2em(this.dimen))}}),on(Se.Command.Xymatrix.Setup.AdjustLabelSep,{toShape:function(e){var t=e.env;t.labelmargin=this.addop.applyToDimen(t.labelmargin,r.MathJax.xypic.measure.length2em(this.dimen))}}),on(Se.Command.Xymatrix.Setup.SetOrientation,{toShape:function(e){e.env.xymatrixOrientationAngle=this.direction.angle(e)}}),on(Se.Command.Xymatrix.Setup.AddModifier,{toShape:function(e){var t=e.env;t.xymatrixEntryModifiers=t.xymatrixEntryModifiers.prepend(this.modifier)}}),on(Se.Command.Xymatrix.Entry.SimpleEntry,{toShape:function(e){var t=e.env,n=r.MathJax.xypic.measure.em2length(t.objectmargin+t.objectwidth),a=r.MathJax.xypic.measure.em2length(t.objectmargin+t.objectheight),i=new Se.Modifier.AddOp(new Se.Modifier.AddOp.GrowTo,new Se.Modifier.AddOp.VactorSize(new Se.Vector.Abs(n,a))),o=r.MathJax.xypic.measure.em2length(t.objectmargin),u=new Se.Modifier.AddOp(new Se.Modifier.AddOp.Grow,new Se.Modifier.AddOp.VactorSize(new Se.Vector.Abs(o,o))),c=this.modifiers.concat(t.xymatrixEntryModifiers).prepend(i).prepend(u);return new Se.Object(c,this.objectbox).toDropShape(e)}}),on(Se.Command.Xymatrix.Entry.EmptyEntry,{toShape:function(e){var t=e.env,n=r.MathJax.xypic.measure.em2length(t.objectmargin+t.objectwidth),a=r.MathJax.xypic.measure.em2length(t.objectmargin+t.objectheight),i=new Se.Modifier.AddOp(new Se.Modifier.AddOp.GrowTo,new Se.Modifier.AddOp.VactorSize(new Se.Vector.Abs(n,a))),o=r.MathJax.xypic.measure.em2length(t.objectmargin),u=new Se.Modifier.AddOp(new Se.Modifier.AddOp.Grow,new Se.Modifier.AddOp.VactorSize(new Se.Vector.Abs(o,o))),c=t.xymatrixEntryModifiers.prepend(i).prepend(u);return new Se.Object(c,new Se.ObjectBox.Empty).toDropShape(e)}}),on(Se.Command.Xymatrix.Entry.ObjectEntry,{toShape:function(e){return this.object.toDropShape(e)}}),on(Se.Command.Twocell,{toShape:function(e){var t=e.env;if(void 0===t.c)return ft.none;var n=t.duplicate(),r=new Rt(ft.none,n);n.twocellmodmapobject=t.twocellmodmapobject||new Se.Object(F.empty,new Se.ObjectBox.Dir("","|")),n.twocellhead=t.twocellhead||new Se.Object(F.empty,new Se.ObjectBox.Dir("",">")),n.twocelltail=t.twocelltail||new Se.Object(F.empty,new Se.ObjectBox.Dir("","")),n.twocellarrowobject=t.twocellarrowobject||new Se.Object(F.empty,new Se.ObjectBox.Dir("","=>")),n.twocellUpperCurveObjectSpacer=t.twocellUpperCurveObjectSpacer,n.twocellUpperCurveObject=t.twocellUpperCurveObject,n.twocellLowerCurveObjectSpacer=t.twocellLowerCurveObjectSpacer,n.twocellLowerCurveObject=t.twocellLowerCurveObject,n.twocellUpperLabel=k.empty,n.twocellLowerLabel=k.empty,n.twocellCurvatureEm=k.empty,n.twocellShouldDrawCurve=!0,n.twocellShouldDrawModMap=!1,this.switches.foreach((function(e){e.setup(r)})),this.twocell.toShape(r,this.arrow),e.appendShapeToFront(r.shape)}}),on(Se.Command.Twocell.Hops2cell,{toShape:function(e,t){var n=e.env,r=n.c,a=n.angle,i=n.c,o=this.targetPosition(e);if(void 0!==i&&void 0!==o){var u=o.x-i.x,c=o.y-i.y;if(0!==u||0!==c){var s=new at.Point(i.x+.5*u,i.y+.5*c),h=Math.atan2(c,u),p=h+Math.PI/2,l=n.twocellCurvatureEm.getOrElse(this.getDefaultCurvature()),x=Math.cos(p),m=Math.sin(p),f=this.getUpperControlPoint(i,o,s,l,x,m),d=this.getLowerControlPoint(i,o,s,l,x,m);if(n.twocellShouldDrawCurve){var y,v;if(v=void 0===(y=n.twocellUpperCurveObjectSpacer)?new Se.Object(F.empty,new Se.ObjectBox.Dir("","-")):void 0!==n.twocellUpperCurveObject?n.twocellUpperCurveObject.getOrElse(void 0):void 0,this.toUpperCurveShape(e,i,f,o,y,v),n.lastCurve.isDefined){n.angle=h;var g=this.getUpperLabelPosition(i,o,s,l,x,m),M=this.getUpperLabelAngle(p,i,o,s,l,x,m);n.twocellUpperLabel.foreach((function(t){t.toShape(e,g,Math.cos(M),Math.sin(M),h)})),this.hasUpperTips&&t.toUpperTipsShape(e)}if(v=void 0===(y=n.twocellLowerCurveObjectSpacer)?new Se.Object(F.empty,new Se.ObjectBox.Dir("","-")):void 0!==n.twocellLowerCurveObject?n.twocellLowerCurveObject.getOrElse(void 0):void 0,this.toLowerCurveShape(e,i,d,o,y,v),n.lastCurve.isDefined){n.angle=h;var w=this.getLowerLabelPosition(i,o,s,l,x,m),S=this.getLowerLabelAngle(p,i,o,s,l,x,m);n.twocellLowerLabel.foreach((function(t){t.toShape(e,w,Math.cos(S),Math.sin(S),h)})),this.hasLowerTips&&t.toLowerTipsShape(e)}}n.c=this.getDefaultArrowPoint(i,o,s,l,x,m),n.angle=p+Math.PI;var b=s;t.toArrowShape(e,b),n.c=r,n.angle=a}}},_toCurveShape:function(e,t,n,r,a,i){var o=e.env,u=new qt.QuadBezier(t,n,r),c=u.tOfShavedStart(t),s=u.tOfShavedEnd(r);if(void 0===c||void 0===s||c>=s)o.lastCurve=Yt.none;else{var h=u.toShape(e,a,i);o.lastCurve=new Yt.QuadBezier(u,c,s,h)}},targetPosition:function(e){var t=e.env,n=t.xymatrixRow,r=t.xymatrixCol;if(void 0===n||void 0===r)throw new TeXError("ExecutionError","rows and columns not found for hops ["+this.hops+"]");for(var a=0;a<this.hops.length;a++)switch(this.hops[a]){case"u":n-=1;break;case"d":n+=1;break;case"l":r-=1;break;case"r":r+=1}var i=n+","+r;return e.env.lookupPos(i,'in entry "'+t.xymatrixRow+","+t.xymatrixCol+'": No '+this+" (is "+i+") from here.").position(e)}}),on(Se.Command.Twocell.Twocell,{getUpperControlPoint:function(e,t,n,r,a,i){return new at.Point(n.x+r*a,n.y+r*i)},getLowerControlPoint:function(e,t,n,r,a,i){return new at.Point(n.x-r*a,n.y-r*i)},getUpperLabelPosition:function(e,t,n,r,a,i){return new at.Point(n.x+.5*r*a,n.y+.5*r*i)},getLowerLabelPosition:function(e,t,n,r,a,i){return new at.Point(n.x-.5*r*a,n.y-.5*r*i)},getUpperLabelAngle:function(e,t,n,r,a,i,o){return e+(a<0?Math.PI:0)},getLowerLabelAngle:function(e,t,n,r,a,i,o){return e+(a<0?0:Math.PI)},getDefaultArrowPoint:function(e,t,n,r,a,i){return n},toUpperCurveShape:function(e,t,n,r,a,i){this._toCurveShape(e,t,n,r,a,i)},toLowerCurveShape:function(e,t,n,r,a,i){this._toCurveShape(e,t,n,r,a,i)},getDefaultCurvature:function(){return 3.5*r.MathJax.xypic.measure.lineElementLength},hasUpperTips:!0,hasLowerTips:!0}),on(Se.Command.Twocell.UpperTwocell,{getUpperControlPoint:function(e,t,n,r,a,i){return new at.Point(n.x+r*a,n.y+r*i)},getLowerControlPoint:function(e,t,n,r,a,i){return n},getUpperLabelPosition:function(e,t,n,r,a,i){return new at.Point(n.x+.5*r*a,n.y+.5*r*i)},getLowerLabelPosition:function(e,t,n,r,a,i){return n},getUpperLabelAngle:function(e,t,n,r,a,i,o){return e+(a<0?Math.PI:0)},getLowerLabelAngle:function(e,t,n,r,a,i,o){return e+(a<0?0:Math.PI)},getDefaultArrowPoint:function(e,t,n,r,a,i){return new at.Point(n.x+.25*r*a,n.y+.25*r*i)},toUpperCurveShape:function(e,t,n,r,a,i){this._toCurveShape(e,t,n,r,a,i)},toLowerCurveShape:function(e,t,n,r,a,i){var o=t.edgePoint(r.x,r.y),u=r.edgePoint(t.x,t.y);o.x!==u.x||o.y!==u.y?e.env.lastCurve=new Yt.Line(o,u,t,r,void 0):e.env.lastCurve=Yt.none},getDefaultCurvature:function(){return 7*r.MathJax.xypic.measure.lineElementLength},hasUpperTips:!0,hasLowerTips:!1}),on(Se.Command.Twocell.LowerTwocell,{getUpperControlPoint:function(e,t,n,r,a,i){return n},getLowerControlPoint:function(e,t,n,r,a,i){return new at.Point(n.x+r*a,n.y+r*i)},getUpperLabelPosition:function(e,t,n,r,a,i){return n},getLowerLabelPosition:function(e,t,n,r,a,i){return new at.Point(n.x+.5*r*a,n.y+.5*r*i)},getUpperLabelAngle:function(e,t,n,r,a,i,o){return e+(a<0?0:Math.PI)},getLowerLabelAngle:function(e,t,n,r,a,i,o){return e+(a<0?Math.PI:0)},getDefaultArrowPoint:function(e,t,n,r,a,i){return new at.Point(n.x+.25*r*a,n.y+.25*r*i)},toUpperCurveShape:function(e,t,n,r,a,i){var o=t.edgePoint(r.x,r.y),u=r.edgePoint(t.x,t.y);o.x!==u.x||o.y!==u.y?e.env.lastCurve=new Yt.Line(o,u,t,r,void 0):e.env.lastCurve=Yt.none},toLowerCurveShape:function(e,t,n,r,a,i){this._toCurveShape(e,t,n,r,a,i)},getDefaultCurvature:function(){return-7*r.MathJax.xypic.measure.lineElementLength},hasUpperTips:!1,hasLowerTips:!0}),on(Se.Command.Twocell.CompositeMap,{getUpperControlPoint:function(e,t,n,r,a,i){var o=this.getMidBoxSize();return new at.Ellipse(n.x+r*a,n.y+r*i,o,o,o,o)},getLowerControlPoint:function(e,t,n,r,a,i){var o=this.getMidBoxSize();return new at.Ellipse(n.x+r*a,n.y+r*i,o,o,o,o)},getUpperLabelPosition:function(e,t,n,r,a,i){var o=n.x+r*a-t.x,u=n.y+r*i-t.y;Math.sqrt(o*o+u*u);return new at.Point(t.x+.5*o,t.y+.5*u)},getLowerLabelPosition:function(e,t,n,r,a,i){var o=n.x+r*a-e.x,u=n.y+r*i-e.y;Math.sqrt(o*o+u*u);return new at.Point(e.x+.5*o,e.y+.5*u)},getUpperLabelAngle:function(e,t,n,r,a,i,o){var u=n.x-r.x+a*i,c=n.y-r.y+a*o,s=Math.atan2(c,u),h=a<0?Math.PI:0;return s+Math.PI/2+h},getLowerLabelAngle:function(e,t,n,r,a,i,o){var u=r.x+a*i-t.x,c=r.y+a*o-t.y,s=Math.atan2(c,u),h=a<0?Math.PI:0;return s+Math.PI/2+h},getDefaultArrowPoint:function(e,t,n,r,a,i){return n},toUpperCurveShape:function(e,t,n,r,a,i){var o=e.env,u=t,c=n,s=u.edgePoint(c.x,c.y),h=c.edgePoint(u.x,u.y),p=o.p,l=o.c;o.p=u,o.c=c,new qt.Line(s,h).toShape(e,void 0,"-",""),o.p=p,o.c=l},toLowerCurveShape:function(e,t,n,r,a,i){var o=e.env,u=n,c=r,s=u.edgePoint(c.x,c.y),h=c.edgePoint(u.x,u.y),p=o.p,l=o.c;o.p=u,o.c=c,new qt.Line(s,h).toShape(e,void 0,"-",""),o.p=p,o.c=l},getMidBoxSize:function(){return.5*r.MathJax.xypic.measure.lineElementLength},getDefaultCurvature:function(){return 3.5*r.MathJax.xypic.measure.lineElementLength},hasUpperTips:!0,hasLowerTips:!0}),on(Se.Command.Twocell.Switch.UpperLabel,{setup:function(e){e.env.twocellUpperLabel=new k.Some(this)},toShape:function(e,t,n,r,a){this.label.toShape(e,t,n,r,a)}}),on(Se.Command.Twocell.Switch.LowerLabel,{setup:function(e){e.env.twocellLowerLabel=new k.Some(this)},toShape:function(e,t,n,r,a){this.label.toShape(e,t,n,r,a)}}),on(Se.Command.Twocell.Switch.SetCurvature,{setup:function(e){var t=e.env;this.nudge.isOmit?t.twocellShouldDrawCurve=!1:t.twocellCurvatureEm=new k.Some(this.nudge.number*r.MathJax.xypic.measure.lineElementLength)}}),on(Se.Command.Twocell.Switch.DoNotSetCurvedArrows,{setup:function(e){e.env.twocellShouldDrawCurve=!1}}),on(Se.Command.Twocell.Switch.PlaceModMapObject,{setup:function(e){e.env.twocellShouldDrawModMap=!0}}),on(Se.Command.Twocell.Switch.ChangeHeadTailObject,{setup:function(e){var t=e.env;switch(this.what){case"`":t.twocelltail=this.object;break;case"'":t.twocellhead=this.object}}}),on(Se.Command.Twocell.Switch.ChangeCurveObject,{setup:function(e){var t=e.env;switch(this.what){case"":t.twocellUpperCurveObjectSpacer=this.spacer,t.twocellUpperCurveObject=this.maybeObject,t.twocellLowerCurveObjectSpacer=this.spacer,t.twocellLowerCurveObject=this.maybeObject;break;case"^":t.twocellUpperCurveObjectSpacer=this.spacer,t.twocellUpperCurveObject=this.maybeObject;break;case"_":t.twocellLowerCurveObjectSpacer=this.spacer,t.twocellLowerCurveObject=this.maybeObject}}}),on(Se.Command.Twocell.Label,{toShape:function(e,t,n,a,i){var o,u=this.maybeNudge;if(u.isDefined){var c=u.get;if(c.isOmit)return;o=c.number*r.MathJax.xypic.measure.lineElementLength}else o=this.getDefaultLabelOffset();var s=e.env,h=s.c;s.c=new at.Point(t.x+o*n,t.y+o*a),this.labelObject.toDropShape(e),s.c=h},getDefaultLabelOffset:function(){return r.MathJax.xypic.measure.lineElementLength}}),on(Se.Command.Twocell.Nudge.Number,{isOmit:!1}),on(Se.Command.Twocell.Nudge.Omit,{isOmit:!0}),on(Se.Command.Twocell.Arrow,{toTipsShape:function(e,t,n){var r=e.env,a=r.lastCurve,i=r.c,o=r.angle,u=t?Math.PI:0,c=a.tOfPlace(!0,!0,t?0:1,0);r.c=a.position(c),r.angle=a.angle(c)+u,r.twocellhead.toDropShape(e);c=a.tOfPlace(!0,!0,t?1:0,0);if(r.c=a.position(c),r.angle=a.angle(c)+u,n?r.twocellhead.toDropShape(e):r.twocelltail.toDropShape(e),r.twocellShouldDrawModMap){c=a.tOfPlace(!1,!1,.5,0);r.c=a.position(c),r.angle=a.angle(c)+u,r.twocellmodmapobject.toDropShape(e)}r.c=i,r.angle=o}}),on(Se.Command.Twocell.Arrow.WithOrientation,{toUpperTipsShape:function(e){switch(this.tok){case"":case"^":case"_":case"=":case"\\omit":case"'":this.toTipsShape(e,!1,!1);break;case"`":this.toTipsShape(e,!0,!1);break;case'"':this.toTipsShape(e,!1,!0)}},toLowerTipsShape:function(e){switch(this.tok){case"":case"^":case"_":case"=":case"\\omit":case"`":this.toTipsShape(e,!1,!1);break;case"'":this.toTipsShape(e,!0,!1);break;case'"':this.toTipsShape(e,!1,!0)}},toArrowShape:function(e,t){var n=e.env,a=n.c;switch(this.tok){case"^":var i=n.angle;n.angle=i+Math.PI,n.twocellarrowobject.toDropShape(e),n.c=new at.Point(a.x+r.MathJax.xypic.measure.lineElementLength*Math.cos(i-Math.PI/2),a.y+r.MathJax.xypic.measure.lineElementLength*Math.sin(i-Math.PI/2)),this.labelObject.toDropShape(e),n.angle=i;break;case"":case"_":i=n.angle;n.twocellarrowobject.toDropShape(e),n.c=new at.Point(a.x+r.MathJax.xypic.measure.lineElementLength*Math.cos(i+Math.PI/2),a.y+r.MathJax.xypic.measure.lineElementLength*Math.sin(i+Math.PI/2)),this.labelObject.toDropShape(e);break;case"=":i=n.angle;var o=new ft.TwocellEqualityArrowheadShape(n.c,n.angle);e.appendShapeToFront(o),n.c=new at.Point(a.x+r.MathJax.xypic.measure.lineElementLength*Math.cos(i+Math.PI/2),a.y+r.MathJax.xypic.measure.lineElementLength*Math.sin(i+Math.PI/2)),this.labelObject.toDropShape(e);break;default:this.labelObject.toDropShape(e)}n.c=a}}),on(Se.Command.Twocell.Arrow.WithPosition,{toUpperTipsShape:function(e){this.toTipsShape(e,!1,!1)},toLowerTipsShape:function(e){this.toTipsShape(e,!1,!1)},toArrowShape:function(e,t){var n,a=e.env,i=a.c,o=a.angle,u=this.nudge;if(u.isOmit)n=i;else{var c=u.number*r.MathJax.xypic.measure.lineElementLength;n=new at.Point(t.x+c*Math.cos(o),t.y+c*Math.sin(o))}a.c=n,a.twocellarrowobject.toDropShape(e),u.isOmit||(a.c=new at.Point(n.x+r.MathJax.xypic.measure.lineElementLength*Math.cos(o+Math.PI/2),n.y+r.MathJax.xypic.measure.lineElementLength*Math.sin(o+Math.PI/2)),this.labelObject.toDropShape(e)),a.c=i}}),on(Se.Pos.Xyimport.TeXCommand,{toShape:function(e){var t=e.env;if(void 0===t.c)return ft.none;var n=t.duplicate(),r=new Rt(ft.none,n),a=this.graphics.toDropShape(r),i=this.width,o=this.height;if(0===i||0===o)throw new TeXError("ExecutionError","the 'width' and 'height' attributes of the \\xyimport should be non-zero.");var u=n.c,c=u.l+u.r,s=u.u+u.d;if(0===c||0===s)throw new TeXError("ExecutionError","the width and height of the graphics to import should be non-zero.");var h=this.xOffset,p=this.yOffset;t.c=u.toRect({u:s/o*(o-p),d:s/o*p,l:c/i*h,r:c/i*(i-h)}),t.setXBase(c/i,0),t.setYBase(0,s/o);var l=u.l-t.c.l,x=u.d-t.c.d;a=new ft.TranslateShape(l,x,r.shape);e.appendShapeToFront(a)}}),on(Se.Pos.Xyimport.Graphics,{toShape:function(e){var t=e.env;if(void 0===t.c)return ft.none;var n=t.duplicate(),r=new Rt(ft.none,n),a=this.width,i=this.height;if(0===a||0===i)throw new TeXError("ExecutionError","the 'width' and 'height' attributes of the \\xyimport should be non-zero.");var o=this.graphics;if(o.setup(r),!n.includegraphicsWidth.isDefined||!n.includegraphicsHeight.isDefined)throw new TeXError("ExecutionError","the 'width' and 'height' attributes of the \\includegraphics are required.");var u=n.includegraphicsWidth.get,c=n.includegraphicsHeight.get;if(0===u||0===c)throw new TeXError("ExecutionError","the 'width' and 'height' attributes of the \\includegraphics should be non-zero.");var s=this.xOffset,h=this.yOffset;t.c=n.c.toRect({u:c/i*(i-h),d:c/i*h,l:u/a*s,r:u/a*(a-s)}),t.setXBase(u/a,0),t.setYBase(0,c/i);var p=new ft.ImageShape(t.c,o.filepath);e.appendShapeToFront(p)}}),on(Se.Command.Includegraphics,{setup:function(e){var t=e.env;t.includegraphicsWidth=k.empty,t.includegraphicsHeight=k.empty,this.attributeList.foreach((function(t){t.setup(e)}))}}),on(Se.Command.Includegraphics.Attr.Width,{setup:function(e){e.env.includegraphicsWidth=new k.Some(r.MathJax.xypic.measure.length2em(this.dimen))}}),on(Se.Command.Includegraphics.Attr.Height,{setup:function(e){e.env.includegraphicsHeight=new k.Some(r.MathJax.xypic.measure.length2em(this.dimen))}});var gn=He;on(ft.TextShape,{_draw:function(e,t){var n=r.MathJax.xypic.measure.length2em("0.2em"),a=e.xypicWrapper,i=a.getChildWrapper(this.math),o=i.adaptor,u=i.getBBox(),c=u.scale,s=(u.h+n)*c,h=(u.d+n)*c,p=(u.w+2*n)*c,l=(s+h)/2,x=p/2,m=this.c;if(this.originalBBox={H:s,D:h,W:p},!t){var f=i.html("mjx-xypic-object");o.append(a.getElement(),f),o.setStyle(f,"text-align","center"),o.setStyle(f,"position","absolute"),o.setStyle(f,"color",e.getCurrentColor()),i.toCHTML(f);var d=e.getOrigin();o.setAttribute(f,"data-x",m.x-x-d.x+n*c),o.setAttribute(f,"data-y",-m.y-l-d.y+n*c),o.setAttribute(f,"data-xypic-id",this.math.xypicTextObjectId),a.appendTextObject(f)}return m.toRect({u:l,d:l,l:x,r:x})}});var Mn=function(e){mn(n,e);var t=dn(n);function n(e,a){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;pn(this,n),i=t.call(this,e,a,o);for(var u=r.MathJax.xypic.wrapperOfTextObjectMap,c=a.textMmls,s=i.childNodes,h=c.length,p=0;p<h;p++){var l=c[p].xypicTextObjectId;u[l]=s[p]}return i._textObjects=[],i}return xn(n,[{key:"getElement",value:function(){return this.chtml}},{key:"appendTextObject",value:function(e){this._textObjects.push(e)}},{key:"getChildWrapper",value:function(e){var t=e.xypicTextObjectId;if(null==t)throw new m.a("IllegalStateError","BUG");var n=r.MathJax.xypic.wrapperOfTextObjectMap[t];if(null==n)throw new m.a("IllegalStateError","unknown textObjectId:"+t);return n}},{key:"toCHTML",value:function(e){var t=r.MathJax.xypic.svgForDebug,n=r.MathJax.xypic.svgForTestLayout;this._textObjects=[],this.setupMeasure(this),this._toCHTML(e),r.MathJax.xypic.svgForDebug=t,r.MathJax.xypic.svgForTestLayout=n}},{key:"setupMeasure",value:function(e){var t=He,n=e.length2em("1em"),a=parseFloat(e.px(100).replace("px",""))/100,i=e.font.params.axis_height,o=e.length2em("0.15em"),u=function(t){return Math.round(parseFloat(e.px(100*t).replace("px","")))/100};r.MathJax.xypic.measure={length2em:function(n){return t(e.length2em(n))},oneem:n,em2length:function(e){return t(e/n)+"em"},Em:function(t){return e.em(t)},em:a,em2px:u,axis_height:i,strokeWidth:e.length2em("0.04em"),thickness:o,jot:e.length2em("3pt"),objectmargin:e.length2em("3pt"),objectwidth:e.length2em("0pt"),objectheight:e.length2em("0pt"),labelmargin:e.length2em("2.5pt"),turnradius:e.length2em("10pt"),lineElementLength:e.length2em("5pt"),axisHeightLength:i*e.length2em("10pt"),dottedDasharray:n+" "+u(o)}}},{key:"append",value:function(e,t){this.adaptor.append(e,t)}},{key:"remove",value:function(e){this.adaptor.remove(e)}},{key:"svg",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return this.adaptor.node(e,t,n,"http://www.w3.org/2000/svg")}},{key:"setAttribute",value:function(e,t,n,r){return this.adaptor.setAttribute(e,t,n,r)}},{key:"setStyle",value:function(e,t,n){this.adaptor.setStyle(e,t,n)}}]),n}(ze.CHTMLWrapper),wn=function(e){mn(n,e);var t=dn(n);function n(e,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return pn(this,n),t.call(this,e,r,a)}return xn(n,[{key:"_toCHTML",value:function(e){var t=this.standardCHTMLnode(e);this.cthml=t;var n=this.adaptor;n.setStyle(t,"position","relative");var a=this.length2em("0.2em"),i=r.MathJax.xypic.measure.strokeWidth,o=1,u=0,c=1,s=r.MathJax.xypic.measure.em2px,h=Pt.createSVG(this,o,u,c,i,"black",{viewBox:[0,-s(o+u),s(c),s(o+u)].join(" "),role:"img",focusable:!1,overflow:"visible"});r.MathJax.xypic.svgForDebug=h,r.MathJax.xypic.svgForTestLayout=h,n.append(t,h.svg);var p=this.node.cmd;if(p){var l=new Ht,x=new Rt(ft.none,l);p.toShape(x);var m=x.shape;m.draw(h);var f=m.getBoundingBox();if(void 0!==f){var d=(f=new at.Rect(0,0,{l:Math.max(0,-(f.x-f.l)),r:Math.max(0,f.x+f.r),u:Math.max(0,f.y+f.u),d:Math.max(0,-(f.y-f.d))})).x-f.l-a,y=-f.y-f.u-a,v=f.l+f.r+2*a,g=f.u+f.d+2*a;h.setWidth(v),h.setHeight(g),h.setAttribute("viewBox",[s(d),s(y),s(v),s(g)].join(" ")),n.setStyle(t,"vertical-align",gn(-f.d-a+r.MathJax.xypic.measure.axis_height)+"em");var M,w=sn(this._textObjects);try{for(w.s();!(M=w.n()).done;){var S=M.value,b=parseFloat(n.getAttribute(S,"data-x")),C=parseFloat(n.getAttribute(S,"data-y"));n.setStyle(S,"left",gn(b-d)+"em"),n.setStyle(S,"top",gn(C-y)+"em")}}catch(e){w.e(e)}finally{w.f()}}else n.remove(h.svg)}else n.remove(h.svg)}}]),n}(Mn);wn.kind=Se.xypic.prototype.kind;var Sn=function(e){mn(n,e);var t=dn(n);function n(e,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return pn(this,n),t.call(this,e,r,a)}return xn(n,[{key:"_toCHTML",value:function(e){var t=this.node.cmd;r.MathJax.xypic.repositories.dirRepository.put(t.dirMain,t.compositeObject)}}]),n}(Mn);Sn.kind=Se.xypic.newdir.prototype.kind;var bn=function(e){mn(n,e);var t=dn(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return pn(this,n),(a=t.call(this,e,r,i))._setupGraphics(),a.computeBBox(a.bbox),a.bboxComputed=!0,a}return xn(n,[{key:"_setupGraphics",value:function(){this.setupMeasure(this);var e=new Ht,t=new Rt(ft.none,e),n=this.node.cmd;if(n.setup(t),!e.includegraphicsWidth.isDefined||!e.includegraphicsHeight.isDefined)throw new m.a("ExecutionError","the 'width' and 'height' attributes of the \\includegraphics are required.");var r=e.includegraphicsWidth.get,a=e.includegraphicsHeight.get;this.imageWidth=this.length2em(r),this.imageHeight=this.length2em(a),this.filepath=n.filepath}},{key:"computeBBox",value:function(e){e.empty(),e.updateFrom(new Qe.BBox({w:this.imageWidth,h:this.imageHeight,d:0}))}},{key:"_toCHTML",value:function(e){var t=this.standardCHTMLnode(e);this.cthml=t,this.adaptor.setStyle(t,"position","relative"),this.adaptor.setStyle(t,"vertical-align","0em");var n=this.html("img");n.setAttribute("src",this.filepath),this.adaptor.setStyle(n,"width",gn(this.imageWidth)+"em"),this.adaptor.setStyle(n,"height",gn(this.imageHeight)+"em"),this.adaptor.append(t,n)}}]),n}(Mn);function Cn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Jn(e,t,n){return t&&kn(e.prototype,t),n&&kn(e,n),e}bn.kind=Se.xypic.includegraphics.prototype.kind;var Pn=function(){function e(){Cn(this,e),this.userDirMap={}}return Jn(e,[{key:"get",value:function(e){return this.userDirMap[e]}},{key:"put",value:function(e,t){this.userDirMap[e]=t}}]),e}(),On=function(){function e(){Cn(this,e),this.userModifierMap={}}return Jn(e,[{key:"get",value:function(t){var n=e.embeddedModifierMap[t];return void 0!==n?n:this.userModifierMap[t]}},{key:"put",value:function(t,n){void 0===e.embeddedModifierMap[t]&&(this.userModifierMap[t]=n)}}]),e}();function Bn(e,t,n){var a=[],i={lastNoSuccess:void 0,whiteSpaceRegex:f.whiteSpaceRegex,createTextNode:function(t){var n=new l.a(t,e.stack.env,e.configuration).mml();return n.xypicTextObjectId=r.MathJax.xypic.textObjectIdCounter,r.MathJax.xypic.textObjectIdCounter++,a.push(n),n}},o=new re(e.string,e.i,i),u=ae.parse(t,o);if(e.i=u.next.offset,u.successful)return e.create(n,u.get(),a);var c=i.lastNoSuccess.next.pos().lineContents(),s=i.lastNoSuccess.msg+'. Parse error at or near "'+c+'".';throw new m.a("SyntaxError",s)}On.embeddedModifierMap={o:new Se.Modifier.Shape.Circle,l:new Se.Modifier.Shape.L,r:new Se.Modifier.Shape.R,u:new Se.Modifier.Shape.U,d:new Se.Modifier.Shape.D,c:new Se.Modifier.Shape.C,aliceblue:new Se.Modifier.Shape.ChangeColor("aliceblue"),antiquewhite:new Se.Modifier.Shape.ChangeColor("antiquewhite"),aqua:new Se.Modifier.Shape.ChangeColor("aqua"),aquamarine:new Se.Modifier.Shape.ChangeColor("aquamarine"),azure:new Se.Modifier.Shape.ChangeColor("azure"),beige:new Se.Modifier.Shape.ChangeColor("beige"),bisque:new Se.Modifier.Shape.ChangeColor("bisque"),black:new Se.Modifier.Shape.ChangeColor("black"),blanchedalmond:new Se.Modifier.Shape.ChangeColor("blanchedalmond"),blue:new Se.Modifier.Shape.ChangeColor("blue"),blueviolet:new Se.Modifier.Shape.ChangeColor("blueviolet"),brown:new Se.Modifier.Shape.ChangeColor("brown"),burlywood:new Se.Modifier.Shape.ChangeColor("burlywood"),cadetblue:new Se.Modifier.Shape.ChangeColor("cadetblue"),chartreuse:new Se.Modifier.Shape.ChangeColor("chartreuse"),chocolate:new Se.Modifier.Shape.ChangeColor("chocolate"),coral:new Se.Modifier.Shape.ChangeColor("coral"),cornflowerblue:new Se.Modifier.Shape.ChangeColor("cornflowerblue"),cornsilk:new Se.Modifier.Shape.ChangeColor("cornsilk"),crimson:new Se.Modifier.Shape.ChangeColor("crimson"),cyan:new Se.Modifier.Shape.ChangeColor("cyan"),darkblue:new Se.Modifier.Shape.ChangeColor("darkblue"),darkcyan:new Se.Modifier.Shape.ChangeColor("darkcyan"),darkgoldenrod:new Se.Modifier.Shape.ChangeColor("darkgoldenrod"),darkgray:new Se.Modifier.Shape.ChangeColor("darkgray"),darkgreen:new Se.Modifier.Shape.ChangeColor("darkgreen"),darkgrey:new Se.Modifier.Shape.ChangeColor("darkgrey"),darkkhaki:new Se.Modifier.Shape.ChangeColor("darkkhaki"),darkmagenta:new Se.Modifier.Shape.ChangeColor("darkmagenta"),darkolivegreen:new Se.Modifier.Shape.ChangeColor("darkolivegreen"),darkorange:new Se.Modifier.Shape.ChangeColor("darkorange"),darkorchid:new Se.Modifier.Shape.ChangeColor("darkorchid"),darkred:new Se.Modifier.Shape.ChangeColor("darkred"),darksalmon:new Se.Modifier.Shape.ChangeColor("darksalmon"),darkseagreen:new Se.Modifier.Shape.ChangeColor("darkseagreen"),darkslateblue:new Se.Modifier.Shape.ChangeColor("darkslateblue"),darkslategray:new Se.Modifier.Shape.ChangeColor("darkslategray"),darkslategrey:new Se.Modifier.Shape.ChangeColor("darkslategrey"),darkturquoise:new Se.Modifier.Shape.ChangeColor("darkturquoise"),darkviolet:new Se.Modifier.Shape.ChangeColor("darkviolet"),deeppink:new Se.Modifier.Shape.ChangeColor("deeppink"),deepskyblue:new Se.Modifier.Shape.ChangeColor("deepskyblue"),dimgray:new Se.Modifier.Shape.ChangeColor("dimgray"),dimgrey:new Se.Modifier.Shape.ChangeColor("dimgrey"),dodgerblue:new Se.Modifier.Shape.ChangeColor("dodgerblue"),firebrick:new Se.Modifier.Shape.ChangeColor("firebrick"),floralwhite:new Se.Modifier.Shape.ChangeColor("floralwhite"),forestgreen:new Se.Modifier.Shape.ChangeColor("forestgreen"),fuchsia:new Se.Modifier.Shape.ChangeColor("fuchsia"),gainsboro:new Se.Modifier.Shape.ChangeColor("gainsboro"),ghostwhite:new Se.Modifier.Shape.ChangeColor("ghostwhite"),gold:new Se.Modifier.Shape.ChangeColor("gold"),goldenrod:new Se.Modifier.Shape.ChangeColor("goldenrod"),gray:new Se.Modifier.Shape.ChangeColor("gray"),grey:new Se.Modifier.Shape.ChangeColor("grey"),green:new Se.Modifier.Shape.ChangeColor("green"),greenyellow:new Se.Modifier.Shape.ChangeColor("greenyellow"),honeydew:new Se.Modifier.Shape.ChangeColor("honeydew"),hotpink:new Se.Modifier.Shape.ChangeColor("hotpink"),indianred:new Se.Modifier.Shape.ChangeColor("indianred"),indigo:new Se.Modifier.Shape.ChangeColor("indigo"),ivory:new Se.Modifier.Shape.ChangeColor("ivory"),khaki:new Se.Modifier.Shape.ChangeColor("khaki"),lavender:new Se.Modifier.Shape.ChangeColor("lavender"),lavenderblush:new Se.Modifier.Shape.ChangeColor("lavenderblush"),lawngreen:new Se.Modifier.Shape.ChangeColor("lawngreen"),lemonchiffon:new Se.Modifier.Shape.ChangeColor("lemonchiffon"),lightblue:new Se.Modifier.Shape.ChangeColor("lightblue"),lightcoral:new Se.Modifier.Shape.ChangeColor("lightcoral"),lightcyan:new Se.Modifier.Shape.ChangeColor("lightcyan"),lightgoldenrodyellow:new Se.Modifier.Shape.ChangeColor("lightgoldenrodyellow"),lightgray:new Se.Modifier.Shape.ChangeColor("lightgray"),lightgreen:new Se.Modifier.Shape.ChangeColor("lightgreen"),lightgrey:new Se.Modifier.Shape.ChangeColor("lightgrey"),lightpink:new Se.Modifier.Shape.ChangeColor("lightpink"),lightsalmon:new Se.Modifier.Shape.ChangeColor("lightsalmon"),lightseagreen:new Se.Modifier.Shape.ChangeColor("lightseagreen"),lightskyblue:new Se.Modifier.Shape.ChangeColor("lightskyblue"),lightslategray:new Se.Modifier.Shape.ChangeColor("lightslategray"),lightslategrey:new Se.Modifier.Shape.ChangeColor("lightslategrey"),lightsteelblue:new Se.Modifier.Shape.ChangeColor("lightsteelblue"),lightyellow:new Se.Modifier.Shape.ChangeColor("lightyellow"),lime:new Se.Modifier.Shape.ChangeColor("lime"),limegreen:new Se.Modifier.Shape.ChangeColor("limegreen"),linen:new Se.Modifier.Shape.ChangeColor("linen"),magenta:new Se.Modifier.Shape.ChangeColor("magenta"),maroon:new Se.Modifier.Shape.ChangeColor("maroon"),mediumaquamarine:new Se.Modifier.Shape.ChangeColor("mediumaquamarine"),mediumblue:new Se.Modifier.Shape.ChangeColor("mediumblue"),mediumorchid:new Se.Modifier.Shape.ChangeColor("mediumorchid"),mediumpurple:new Se.Modifier.Shape.ChangeColor("mediumpurple"),mediumseagreen:new Se.Modifier.Shape.ChangeColor("mediumseagreen"),mediumslateblue:new Se.Modifier.Shape.ChangeColor("mediumslateblue"),mediumspringgreen:new Se.Modifier.Shape.ChangeColor("mediumspringgreen"),mediumturquoise:new Se.Modifier.Shape.ChangeColor("mediumturquoise"),mediumvioletred:new Se.Modifier.Shape.ChangeColor("mediumvioletred"),midnightblue:new Se.Modifier.Shape.ChangeColor("midnightblue"),mintcream:new Se.Modifier.Shape.ChangeColor("mintcream"),mistyrose:new Se.Modifier.Shape.ChangeColor("mistyrose"),moccasin:new Se.Modifier.Shape.ChangeColor("moccasin"),navajowhite:new Se.Modifier.Shape.ChangeColor("navajowhite"),navy:new Se.Modifier.Shape.ChangeColor("navy"),oldlace:new Se.Modifier.Shape.ChangeColor("oldlace"),olive:new Se.Modifier.Shape.ChangeColor("olive"),olivedrab:new Se.Modifier.Shape.ChangeColor("olivedrab"),orange:new Se.Modifier.Shape.ChangeColor("orange"),orangered:new Se.Modifier.Shape.ChangeColor("orangered"),orchid:new Se.Modifier.Shape.ChangeColor("orchid"),palegoldenrod:new Se.Modifier.Shape.ChangeColor("palegoldenrod"),palegreen:new Se.Modifier.Shape.ChangeColor("palegreen"),paleturquoise:new Se.Modifier.Shape.ChangeColor("paleturquoise"),palevioletred:new Se.Modifier.Shape.ChangeColor("palevioletred"),papayawhip:new Se.Modifier.Shape.ChangeColor("papayawhip"),peachpuff:new Se.Modifier.Shape.ChangeColor("peachpuff"),peru:new Se.Modifier.Shape.ChangeColor("peru"),pink:new Se.Modifier.Shape.ChangeColor("pink"),plum:new Se.Modifier.Shape.ChangeColor("plum"),powderblue:new Se.Modifier.Shape.ChangeColor("powderblue"),purple:new Se.Modifier.Shape.ChangeColor("purple"),red:new Se.Modifier.Shape.ChangeColor("red"),rosybrown:new Se.Modifier.Shape.ChangeColor("rosybrown"),royalblue:new Se.Modifier.Shape.ChangeColor("royalblue"),saddlebrown:new Se.Modifier.Shape.ChangeColor("saddlebrown"),salmon:new Se.Modifier.Shape.ChangeColor("salmon"),sandybrown:new Se.Modifier.Shape.ChangeColor("sandybrown"),seagreen:new Se.Modifier.Shape.ChangeColor("seagreen"),seashell:new Se.Modifier.Shape.ChangeColor("seashell"),sienna:new Se.Modifier.Shape.ChangeColor("sienna"),silver:new Se.Modifier.Shape.ChangeColor("silver"),skyblue:new Se.Modifier.Shape.ChangeColor("skyblue"),slateblue:new Se.Modifier.Shape.ChangeColor("slateblue"),slategray:new Se.Modifier.Shape.ChangeColor("slategray"),slategrey:new Se.Modifier.Shape.ChangeColor("slategrey"),snow:new Se.Modifier.Shape.ChangeColor("snow"),springgreen:new Se.Modifier.Shape.ChangeColor("springgreen"),steelblue:new Se.Modifier.Shape.ChangeColor("steelblue"),tan:new Se.Modifier.Shape.ChangeColor("tan"),teal:new Se.Modifier.Shape.ChangeColor("teal"),thistle:new Se.Modifier.Shape.ChangeColor("thistle"),tomato:new Se.Modifier.Shape.ChangeColor("tomato"),turquoise:new Se.Modifier.Shape.ChangeColor("turquoise"),violet:new Se.Modifier.Shape.ChangeColor("violet"),wheat:new Se.Modifier.Shape.ChangeColor("wheat"),white:new Se.Modifier.Shape.ChangeColor("white"),whitesmoke:new Se.Modifier.Shape.ChangeColor("whitesmoke"),yellow:new Se.Modifier.Shape.ChangeColor("yellow"),yellowgreen:new Se.Modifier.Shape.ChangeColor("yellowgreen")};var En={};En.Macro=c.a.Macro,En.xybox=function(e,t,n){var r=Bn(e,Ie.xybox(),wn.kind);e.Push(r)},En.xymatrixbox=function(e,t,n){var r=Bn(e,Ie.xymatrixbox(),wn.kind);e.Push(r)},En.newdir=function(e,t,n){var r=Bn(e,Ie.newdir(),Sn.kind);e.Push(r)},En.xyincludegraphics=function(e,t,n){var r=Bn(e,Ie.includegraphics(),bn.kind);e.Push(r)},En.xyEnvironment=function(e,t){var n=Bn(e,Ie.xy(),wn.kind);return e.Push(t),n};new o.CommandMap("xypic-command",{hole:["Macro","{\\style{visibility:hidden}{x}}"],objectstyle:["Macro","\\textstyle"],labelstyle:["Macro","\\scriptstyle"],twocellstyle:["Macro","\\scriptstyle"],xybox:["xybox","xybox"],xymatrix:["xymatrixbox","xymatrix"],newdir:["newdir","newdir"],includegraphics:["xyincludegraphics","includegraphics"]},En),new o.EnvironmentMap("xypic-environment",h.a.environment,{xy:["xyEnvironment",null,!1]},En);function An(e,t,n,a){void 0===a.getNodeClass(e)&&a.setNodeClass(e,t);var i=r.MathJax.startup.output.factory;if(void 0===i.getNodeClass(e))switch(r.MathJax.startup.output.name){case"CHTML":i.setNodeClass(e,n)}}i.Configuration.create("xypic",{handler:{macro:["xypic-command"],environment:["xypic-environment"]},nodes:{xypic:function(e,t,n){var r=e.mmlFactory;return An(wn.kind,Se.xypic,wn,r),new Se.xypic(r,t,n)},"xypic-newdir":function(e,t,n){var r=e.mmlFactory;return An(Sn.kind,Se.xypic.newdir,Sn,r),new Se.xypic.newdir(r,t,n)},"xypic-includegraphics":function(e,t,n){var r=e.mmlFactory;return An(bn.kind,Se.xypic.includegraphics,bn,r),new Se.xypic.includegraphics(r,t,n)}}});if(void 0===r.MathJax.xypic){var Ln=function(){r.MathJax.xypic.repositories.modifierRepository=new On,r.MathJax.xypic.repositories.dirRepository=new Pn,r.MathJax.xypic.textObjectIdCounter=0,r.MathJax.xypic.wrapperOfTextObjectMap={}};Object(r.combineWithMathJax)({xypic:{repositories:{modifierRepository:new On,dirRepository:new Pn},textObjectIdCounter:0,wrapperOfTextObjectMap:{}}}),Object(r.combineConfig)(r.MathJax.config,{options:{renderActions:{initialize_xypic_context:[a.STATE.FINDMATH-1,function(e){Ln()},function(e,t){Ln()},!0]}}})}}]);